C MEMBER GTDRRC
C  (from old member PPGTDRRC)
C
      SUBROUTINE GTDRRC
C
C.....THIS SUBROUTINE IS CALLED TO COMPUTE VALUES OF THE RAINFALL
C.....DURATION CONSTANT, AND THE API RECESSION CONSTANT, IF
C.....NO VALUE HAS BEEN PROVIDED.  THESE CONSTANTS ARE NEEDED FOR
C.....COMPUTATION OF MARO AND OF API RECESSION.
C
C.....ORIGINALLY WRITTEN BY:
C
C.....JERRY M. NUNN       WGRFC FT. WORTH, TEXAS       DECEMBER 1986
C
      INCLUDE 'gcommon/gdate'
      INCLUDE 'common/fctime'
      INCLUDE 'gcommon/gopt'
      INCLUDE 'common/pudbug'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_maro/RCS/gtdrrc.f,v $
     . $',                                                             '
     .$Id: gtdrrc.f,v 1.1 1995/09/17 19:02:43 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA GDRC /4hGDRC/
C
  901 FORMAT(1X, 'NO USER-SPECIFIED VALUE WAS INPUT -- THE DEFAULT VALUE
     * IS BEING USED.')
  902 FORMAT(1X, 'A USER-SPECIFIED VALUE WAS INPUT AND IS BEING USED.')
  903 FORMAT(1X, 'THE API RECESSION CONSTANT IS ', F4.2, '.')
  904 FORMAT(1X, 'THE PRECIPITATION DURATION FACTOR IS ', F5.2,' HRS.')
  905 FORMAT(1H0, '*** ENTER GTDRRC ***')
  906 FORMAT(1X, '*** EXIT GTDRRC ***')
C
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,905)
      MMBUG = IPBUG(GDRC)
C
C.....IF THE DURATION AND RECESSION CONSTANTS WERE NOT SPECIFIED...SET
C.....THEM ACCORDING TO THE DATES.
C
      W      = NW
      NDRSET =  0
      NRCSET =  0
C
C.....CHECK THE DURATION. DO NOT LET IT BE NEAR ZERO OR EXCEED 12 HRS.
C
      IF((DUR .LT. 0.1) .OR. (DUR .GT. 12.0)) GOTO 50
      NDRSET = 1
      GOTO 65
C
C.....COMPUTE A DEFAULT VALUE OF THE DURATION.
C
   50 IF(NW .GT. 30) GOTO 55
      Y = COS((W/30.0)*3.1415926535)
      GOTO 60
C
   55 Y = COS((W/52.0)*3.1415926535)
C
   60 DUR = 2.5*Y + 3.5
C
C.....NOW CHECK OUT THE RECESSION CONSTANT.
C
   65 IF((REC .LT. RECMIN) .OR. (REC .GT. RECMAX)) GOTO 70
      NRCSET = 1
      GOTO 85
C
C.....COMPUTE A DEFAULT VALUE OF THE RECESSION CONSTANT.
C
   70 NWDIF = NW - NWLAG
      IF(NWDIF .LE. 0) NWDIF = 52 + NWDIF
      PHI = NWDIF
      IF(NWDIF .GT. 26) GOTO 75
      Y = FACTOR*COS((PHI/26.0)*3.1415926535)
      GOTO 80
C
   75 Y = FACTOR*COS((PHI/52.0)*6.2831853070)
C
   80 REC = RECDEF + Y*RECOFF
C
C.....NOW PRINT OUT THE DURATION AND RECESSION CONSTANTS...IF DEBUG
C.....OUTPUT FOR THESE IS DESIRED.
C
   85 IF(MMBUG .EQ. 0) GOTO 999
C
      WRITE(IOPDBG,904) DUR
      IF(NDRSET .EQ. 1) GOTO 86
      WRITE(IOPDBG,901)
      GOTO 87
C
   86 WRITE(IOPDBG,902)
C
   87 WRITE(IOPDBG,903) REC
      IF(NRCSET .EQ. 1) GOTO 88
      WRITE(IOPDBG,901)
      GOTO 999
C
   88 WRITE(IOPDBG,902)
C
  999 IF(IPTRCE .GE. 3) WRITE(IOPDBG,906)
      RETURN
      END
