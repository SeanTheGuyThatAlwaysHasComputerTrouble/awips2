C MODULE GPXERR
C
      SUBROUTINE GPXERR(IERROR, IPCODE, NPGRID, HEAD, NFLAG6, NFLD)
C
C.....THIS IS AN ERROR PROCESSING SUBROUTINE FOR THE GRID POINT PRECIP
C.....PROCESSING RUNTIME MOD FOR THE MARO FUNCTION.
C
C.....ARGUMENT LIST
C
C.....IERROR - THE ERROR CODE RETURNED FROM THE OTHER PROCESSING
C.....         ROUTINES.
C.....IPCODE - A 'CONTINUE PROCESSING' CODE FOR THIS LINE.
C.....           =1  CONTINUE PROCESSING THIS LINE.
C.....           =0  DO NOT CONTINUE PROCESSING THIS LINE.
C.....NPGRID - NORMALLY THE GRID POINT ADDRESS ON A DATA LINE. HOWEVER,
C.....         WHEN THE LINE IS IN ERROR NPGRID = -1.
C.....HEAD   - A 'HEADING LINE PROCESSED' FLAG.
C.....           =1  THE HEADING LINE HAS BEEN SUCCESSFULLY PROCESSED.
C.....           =0  THE HEADING LINE HAS NOT BEEN SUCCESSFULLY PROCESSE
C.....               PROCESSED.
C.....NFLAG6 - SIX HOUR DATA FLAG.
C.....           = 1   SIX HOUR DATA IS PRESENT
C.....           = 0   SIX HOUR DATA IS NOT PRESENT.
C.....NFLD   - FIELD NUMBER BEING PROCESSED (FROM UFIEL2).
C
C.....ORIGINALLY WRITTEN BY
C
C.....JERRY M. NUNN       WGRFC FT. WORTH, TEXAS       SEPTEMBER 1986
C
      INCLUDE 'gcommon/explicit'
      INTEGER HEAD
C
      INCLUDE 'gcommon/gsize'
      INCLUDE 'ufreex'
      INCLUDE 'common/ionum'
      INCLUDE 'common/errdat'
      INCLUDE 'common/pudbug'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_maro/RCS/gpxerr.f,v $
     . $',                                                             '
     .$Id: gpxerr.f,v 1.2 1998/07/02 20:34:21 page Exp $
     . $' /
C    ===================================================================
C
C
C
  901 FORMAT(1H0, '***** ERROR *****   IMPROPER RUNTIME MOD HEADING IN L
     *INE LISTED ABOVE', /, 7X, 'THIS ENTIRE LINE WILL BE DISCARDED -- W
     *ILL SEARCH FOR NEXT RUNTIME MOD HEADER LINE.')
  902 FORMAT(1H0, '***** ERROR *****   INVALID DATE FIELD IN RUNTIME MOD
     * HEADER LINE LISTED ABOVE', /, 7X, 'THIS ENTIRE LINE WILL BE DISCA
     *RDED -- WILL SEARCH FOR NEXT RUNTIME MOD HEADER LINE.')
  904 FORMAT(1H0, '***** ERROR *****   INVALID GRID POINT ADDRESS IN LIN
     *E NO. ', I4, ' LISTED ABOVE.', /, 7X, 'GRID POINT ADDRESS MUST CON
     *SIST OF ALL NUMERIC CHARACTERS AND BE IN THE RANGE 100-9899.', /,
     * 7X, 'THE CONTENTS OF THIS LINE WILL BE IGNORED.')
  905 FORMAT(1H0, '***** ERROR *****   INVALID 24 HR PRECIPITATION AMOUN
     *T IN LINE NO. ', I4, ' LISTED ABOVE.')
  906 FORMAT(7X, 'PRECIPITATION AMOUNTS MUST CONSIST OF ALL NUMERIC CHAR
     *ACTERS AND BE POSITIVE OR ZERO.')
  907 FORMAT(7X, 'THE CONTENTS OF THIS LINE WILL BE IGNORED.')
  908 FORMAT(1H0, '***** ERROR *****   INVALID SIX HOUR PRECIPITATION AM
     *OUNT GIVEN IN LINE NO. ', I4, ' LISTED ABOVE.')
  909 FORMAT(7X, 'THE SIX HOUR PRECIPITATION DATA WILL BE IGNORED.')
  910 FORMAT(1H0, '***** ERROR *****   INVALID SIX HOUR PRECIPITATION ST
     *RING IN LINE NO. ', I4, ' LISTED ABOVE.', /, 7X, 'SIX HOUR PRECIPI
     *TATION STRINGS MUST BE IN THE FORM F*NN,', /, 7X, 'WHERE F AND NN
     *ARE POSITIVE INTEGERS OR REAL NUMBERS, AND NN MAY BE ZERO.')
  911 FORMAT(1H0, '***** WARNING *****   PRECIPITATION ENTERED EXCEEDS '
     *, F5.2, ' INCHES. VERIFY THAT THIS AMOUNT IS WHAT YOU WANT TO USE.
     *', /, 7X, 'PROCESSING CONTINUES WITH THE ENTERED AMOUNT.')
  912 FORMAT(1H0, '***** WARNING *****   THERE IS MORE THAN SIX FIELDS O
     *N THE LINE LISTED ABOVE.', /, 7X, 'ALL FIELDS AFTER THE SIXTH WILL
     * NOT BE PROCESSED.')
  913 FORMAT(1H0, '*** GPXERR ENTERED WITH ERROR CODE ', I2, ' ***')
  914 FORMAT(1H0, '*** EXIT GPXERR -- PROCESS CODE IS ', I2, ' ***')
C
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,913) IERROR
C
C.....TEST ERROR CODE AND BRANCH TO THE APPROPRIATE SECTION OF ROUTINE.
C
      IF(IERROR .EQ. 1) GOTO 110
      IF(IERROR .EQ. 2) GOTO 120
      IF(IERROR .EQ. 3) GOTO 130
      IF(IERROR .EQ. 4) GOTO 140
      IF(IERROR .EQ. 5) GOTO 150
      IF(IERROR .EQ. 6) GOTO 160
      IF(IERROR .EQ. 7) GOTO 170
      IF(IERROR .EQ. 8) GOTO 180
      IF(IERROR .EQ. 9) GOTO 190
      GOTO 830
C
  110 CALL SUPCRD
      WRITE(IPR,901)
      NFLD = NFIELD
      CALL ERROR
      GOTO 800
C
  120 CALL SUPCRD
      WRITE(IPR,902)
      NFLD = NFIELD
      CALL ERROR
      GOTO 800
C
  130 CALL SUPCRD
      GOTO 800
C
  140 CALL SUPCRD
      WRITE(IPR,904) NRDCRD
      NFLD = NFIELD
      CALL ERROR
      GOTO 810
C
  150 CALL SUPCRD
      WRITE(IPR,905) NRDCRD
      WRITE(IPR,906)
      WRITE(IPR,907)
      NFLD = NFIELD
      CALL ERROR
      GOTO 810
C
  160 CALL SUPCRD
      WRITE(IPR,908) NRDCRD
      WRITE(IPR,906)
      WRITE(IPR,909)
      NFLD = NFIELD
      CALL ERROR
      GOTO 820
C
  170 CALL SUPCRD
      WRITE(IPR,910) NRDCRD
      WRITE(IPR,909)
      NFLD = NFIELD
      CALL ERROR
      GOTO 820
C
  180 CALL SUPCRD
      PMAX = MAXPCP/100.
      WRITE(IPR,911) PMAX
      WRITE(IPR,907)
      CALL WARN
      GOTO 820
C
  190 CALL SUPCRD
      WRITE(IPR,912)
      CALL WARN
      GOTO 830
C
  800 HEAD   =  0
  810 NPGRID = -1
  820 IPCODE =  0
C
      NFLAG6 =  0
  830 IERROR =  0
C
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,914) IPCODE
      RETURN
      END
