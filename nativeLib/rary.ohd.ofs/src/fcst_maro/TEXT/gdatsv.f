C MEMBER GDATSV
C  (from old member PPGDATSV)
C
      SUBROUTINE GDATSV(NFGRID, NFMBOX, NGPADR, MDRLOC, GP6, NUMST)
C
C.....THIS IS DATA SAVE ROUTINE FOR GRID POINT AND MDR BOXDATA.
C.....DATA IS BEING MOVED TO OTHER LOCATIONS TO COMPRESS WORKING
C.....STORAGE.
C
C.....HERE ARE THE ARGUMENTS:
C
C.....NFGRID - THE FINAL ARRAY OF GRID POINT ADDRESSES.
C.....NFMBOX - THE FINAL ARRAY OF MDR BOX NUMBERS.
C.....NGPADR - THE INITIAL ARRAY OF GRID POINT ADDRESSES.
C.....MDRLOC - THE INITIAL ARRAY OF MDR BOX NUMBERS.
C.....GP6    - THE ARRAY OF 6-HOURLY DATA AVAILABILITY FLAGS FOR
C.....         EACH GRID POINT.
C.....NUMST  - THE MAXIMUM NUMBER OF STATIONS ALLOWED.
C
C.....N6HR IS COMPUTED IN THIS SUBROUTINE AND IS THE ACTUAL NUMBER
C.....OF SIX HOURLY STATIONS BEING USED.
C
C
C.....JERRY M. NUNN       WGRFC, FT. WORTH       AUGUST 1986
C
      INTEGER*2 NFGRID(1), NFMBOX(1), NGPADR(1), MDRLOC(1), GP6(1)
      DIMENSION SNAME(2)
C
      INCLUDE 'gcommon/gsize'
      INCLUDE 'common/where'
      INCLUDE 'common/pudbug'
C
C    ================================= RCS keyword statements ==========
C      CHARACTER*68     RCSKW1,RCSKW2
C      DATA             RCSKW1,RCSKW2 /                                 '
C     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_maro/RCS/gdatsv.f,v $
C     . $4h,
C     .$Id: gdatsv.f,v 1.1 1995/09/17 19:01:21 dws Exp $
C     . $' /
C    ===================================================================
C
C
      DATA SNAME, GSIX, GGP6 /4hGDAT, 4hSV  , 4hGSIX, 4hGP6 /
C
  900 FORMAT(1H0, '*** GDATSV ENTERED ***')
  901 FORMAT(1H0, '*** EXIT GDATSV ***')
  902 FORMAT(1H0, 'NUMBER OF SIX HOURLY REPORTS FOUND = ', I4)
  903 FORMAT(6X, 'CHECKING THRU ', I5, ' PRECIPITATION STATIONS')
  904 FORMAT(6X, 'FOR STATION NO. ', I5, ' ... SLOT NO. ', I5,
     * ' IN THE GP24 ARRAY CONTAINS GRID ADDRESS ', I5, ' ... SHARED GRI
     *D CODE = ', I5)
  905 FORMAT(10X, 'GP6(', I4, ') = ', I5, ' ... MDR BOX NO. = ', I5)
C
C.....SET THE WHERE COMMON BLOCK.
C
      IOPNUM = -1
      OPNAME(1) = SNAME(1)
      OPNAME(2) = SNAME(2)
C
      N6HR = 0
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,900)
      IBUG = IPBUG(GSIX)
      JBUG = IPBUG(GGP6)
      IF(JBUG .EQ. 1) CALL GDGP6(GP6)
C
C.....LOOP THRU THE NUMBER OF ENTRIES IN THE MDR BOX AND GRID POINT
C.....DATA ARRAYS.
C
      IF(IBUG .EQ. 1) WRITE(IOPDBG,903) NUMST
      DO 100 NP = 1, NUMST
C
C.....GET THE GRID POINT ADDRESS OF THE FIRST STATION ON THE PP24 DATA
C.....FILE FOR THIS DAY. THE GRID POINT INFORMATION, RECALL, IS IN THE
C.....FIRST SLOT OF THE ENTRY. THE SECOND SLOT CONTAINS INFORMATION
C.....ABOUT OTHER GRID POINTS THAT MAY SHARE THE SAME ADDRESS...BUT WE
C.....DO NOT NEED THAT INFORMATION.
C
      NSLOT = NP*2 - 1
      IGRID = NGPADR(NSLOT)
      NSSHR = NP*2
      NPSHR = NGPADR(NSSHR)
      IF(IGRID .LE. 0) GOTO 100
      IF(NPSHR .LE. 0) GOTO 100
C
C.....LOOK AT THE DISTRIBUTION POINTER GP6. THERE IS A NON ZERO ENTRY IN
C.....GP6 ONLY IF THE GRID POINT HAS SIX HOURLY INFORMATION.
C
      IF(GP6(IGRID) .LE. 0) GOTO 100
      IF(IBUG .EQ. 1) WRITE(IOPDBG,904) NP, NSLOT, IGRID, NPSHR
      IF(IBUG .EQ. 1) WRITE(IOPDBG,905) IGRID, GP6(IGRID), MDRLOC(NP)
C
C.....STORE THE GRID POINT ADDRESS IN NFGRID. STORE THE MDR BOX NUMBER
C.....IN NFMBOX.
C
      N6HR = N6HR + 1
      NFGRID(N6HR) = IGRID
      NFMBOX(N6HR) = MDRLOC(NP)
C
  100 CONTINUE
C
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,902) N6HR
      IF(IPTRCE .GE. 3) WRITE(IOPDBG,901)
C
C
      RETURN
      END
