C MODULE PRP26
C***********************************************************************
C
      SUBROUTINE PRP26(PO)
C
C      SUBROUTINE PRINTS THE INFORMATION STORED IN THE P ARRAY FOR THE
C     RESERVOIR OPERATION.
C
C***********************************************************************
C     PROGRAMMED BY KAY KROUSE   MARCH 1983
C***********************************************************************
      REAL NORMP,NORMQ
CC      DIMENSION PO(*),PR26(2),SCHEME(26),X(365),Y(365),
      DIMENSION PO(*),PR26(2),X(365),Y(365),
     1 IDAY(365),ANAME(5),UNIT(10),DIM(4)
      DIMENSION QHTYPE(3)
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/CNVP26/CONV1,CONV2,CONV3,CONV4,CONV5,UNT1,UNT2,UNT3,UNT4,
     .            UNT5
      COMMON/FENGMT/IMETRC
      COMMON/FATLGK/IATL,C1,C2
      COMMON/ADJ26/NTS17
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624
C      REAL*8 GTSKW(6)
      REAL*8 GTSKW(6),TSKW05(3)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_prpc/RCS/prp26.f,v $
     . $',                                                             '
     .$Id: prp26.f,v 1.9 2004/04/19 13:36:17 hsu Exp $
     . $' /
C    ===================================================================
C
C  END OF CHANGE OF 12/14/90(3)
C
      DATA PR26,BLANK/4HPRP2,4H6   ,4H    /
      DATA DIM/4HL   ,4HL3/T,4HL3  ,4HL/T /
      DATA UNIT/4HM   ,4HFT  ,4HCMS ,4HCFS ,4HCMSD,4HCFSD,4HM/S ,4HFT/S,
     1 4HMM  ,4HIN  /
C
cc      DATA SCHEME/4HPASS,4HFLOW ,4HSETQ,4H    ,4HSETH,4H    ,4HRULE,
cc     1 4HCRVE,4HFILL,4HSPIL,4HSPIL,4HLWAY,4HPOOL,4HQ   ,4HSTPO,4HOLQ ,
cc     2 4HMINQ,4H    ,4HMINH,4H    ,4HINDS,4HCHGE,4HFLAS,4HHBDS,4HPOWE,
cc     3 4HRGEN,4HSETD,4HQ   ,4HSETD,4HH   /
      DATA GTSKW/8HINSTQIN ,8HMEANQIN ,8HMEANQOUT,8HINSTQOUT,
     1 8HPOOL    ,8HSTORAGE /
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624
      DATA TSKW05/8HQLIM    ,8HQGEN    ,8HQSLUICE /
C  END OF CHANGE OF 12/14/90(3)
      DATA QHTYPE/4HINST,4HMEAN,4HPOOL/
C
C***********************************************************************
C***********************************************************************
C     CHECK TRACE LEVEL
      CALL FPRBUG(PR26,1,26,IBUG)
C
C     COMPUTE METRIC/ENGLISH CONVERSION FACTORS
C
      NTS17=6
      UNT1=UNIT(1)
      UNT2=UNIT(3)
      UNT3=UNIT(5)
      UNT4=UNIT(7)
      UNT5=UNIT(9)
      IMETEN=PO(8)
      KUNITS=IMETEN
      CONV1=1.0
      CONV2=1.0
      CONV3=1.0
      CONV4=1.0
      CONV5=1.0
      IF(IMETRC .EQ. 0)KUNITS=0
      IF(IMETRC .EQ. 1)KUNITS=1
      IF(KUNITS .EQ. 1)GO TO 2
C     DETERMINE UNITS AND CONVERSION FACTORS FROM METRIC TO
C     ENGLISH FOR ALL QUANTITIES EXCEPT STORAGES
C
      CALL CNVT26(UNIT(1),DIM(1),UNT1,CONV1,CONST1,0,IERR1)
      CALL CNVT26(UNIT(3),DIM(2),UNT2,CONV2,CONST2,0,IERR2)
      CALL CNVT26(UNIT(7),DIM(4),UNT4,CONV4,CONST4,0,IERR4)
      UNT5=UNIT(10)
      CONV5=.03937
C
C     CONVERT STORAGES IF NECESSARY
  2   MINODT=PO(7)
      DELTAT=MINODT
      IM=IMETEN+1
      IF(KUNITS.NE.1)
     1CALL CNVT26(UNIT(5),DIM(3),UNT3,CONV3,CONST3,IM,IERR3)
      IF(IMETEN.EQ.-1 .AND. IMETRC.NE.1)GO TO 4
      CONV3=CONV3*DELTAT/24.
  4   CONTINUE
C     PRINT HEADING
      WRITE(IPR,700) (PO(I),I=2,6)
 700  FORMAT(1H0,10X,24HRESERVOIR OPERATION FOR ,5A4)
      ITIM = PO(7)
      WRITE(IPR,705) ITIM
 705  FORMAT(1H0,10X,47HCOMPUTATIONAL TIME INTERVAL FOR THE OPERATION =,
     1 I3,7H HOURS./)
C
C***********************************************************************
C     PRINT GENERAL INFORMATION
      WRITE(IPR,710)
 710  FORMAT(1H0,40X,29H*****GENERAL INFORMATION*****/)
      LO=PO(10)
      NVAL=PO(LO)
      IY=LO+NVAL
      DO 5 I=1,NVAL
 5    X(I)=PO(LO+I )*CONV1
      DO 7 I=1,NVAL
 7    Y(I)=PO(IY+I)*CONV3
C
      WRITE(IPR,730)
      IB=1
      IE=NVAL
      IF(IE .GT. 8)IE=8
 10   WRITE(IPR,725)UNT1,(X(I),I=IB,IE)
      IF (Y(NVAL).LT.100000.0) THEN
        WRITE(IPR,735)UNT3,(Y(I),I=IB,IE)
      ELSE
        WRITE(IPR,736)UNT3,(Y(I),I=IB,IE)
      ENDIF
c      IF (IE.LE.8) THEN
c        WRITE(IPR,735)UNT3,(Y(I),I=IB,IE)
c      ELSE
c        WRITE(IPR,736)UNT3,(Y(I),I=IB,IE)
c      ENDIF
      IF(IE .GE. NVAL)GO TO 20
      IB=IE+1
      IE=IE+8
      IF(IE .GT. NVAL)IE=NVAL
      GO TO 10
C
 725  FORMAT(1H0,20X,5HELEV(,A4,1H),8F10.2)
 730  FORMAT(1H0,10X,27HSTORAGE VS. ELEVATION CURVE)
 735  FORMAT(1H ,20X,5HSTOR(,A4,1H),8F10.2)
 736  FORMAT(1H ,20X,5HSTOR(,A4,1H),8F10.0)
C
 20   CONTINUE
C
      LO=LO+2*NVAL+1
      INTP=PO(LO)
      IF(INTP .EQ. 0)WRITE(IPR,740)
      IF(INTP .GT. 0)WRITE(IPR,742)
 740  FORMAT(1H0,10X,37HLINEAR INTERPOLATION IS USED IN CURVE)
 742  FORMAT(1H0,10X,42HLOGARITHMIC INTERPOLATION IS USED IN CURVE)
C***********************************************************************
C     GENERAL TIME SERIES INFORMATION
      WRITE(IPR,745)
 745  FORMAT(1H0,10X,71HGENERAL TIME SERIES:         ID              TYP
     1E              TIME(HR)/)
      LO=PO(11)+1
      DO 25 I=1,6
      IF(PO(LO).EQ.BLANK)GO TO 22
      IT=PO(LO+3)
      WRITE(IPR,750) GTSKW(I),PO(LO),PO(LO+1),PO(LO+2),IT
 750  FORMAT(1H ,21X,A8,10X,2A4,8X,A4,16X,I2)
      LO=LO+5
      GO TO 25
 22   LO=LO+2
 25   CONTINUE
C
C     END OF GENERAL INFORMATION
C***********************************************************************
C***********************************************************************
C
C     PRINT SPECIFIC REGULATION SCHEME/UTILITY INFORMATION
C
      LOC=PO(9)
      NCOMPS=PO(LOC)
      LOC=LOC+1
      IF(NCOMPS.EQ.0)GO TO 501
      WRITE(IPR,699)
 699  FORMAT(1H )
      WRITE(IPR,755)
 755  FORMAT(1H0,40X,45H*****SPECIFIC SCHEME/UTILITY INFORMATION*****/)
C
      DO 500 I=1,NCOMPS
      SUNUM=PO(LOC)
      NDUM=SUNUM/10.
      IF(NDUM.NE.154) GO TO 40
      NSU17=(SUNUM-IFIX(SUNUM)+.01)*10
      IF(NSU17.EQ.1) NTS17=7
   40 NUM=PO(LOC)
      LP=PO(LOC+1)
      LT=PO(LOC+2)
      LOC=LOC+4
C
      IBASE=NUM/10
      LEVEL=NUM-IBASE*10
      IF(NUM .GT. 1500)GO TO 1500
C     SELECTION IS A COMPUTATIONAL SCHEME
      NUM=NUM/10 -100
      IGOTO=IBASE-100
      GO TO (100,1020,1030,1040,1050,1060,1070,1080,1090,1100,
     .   1110,1120,1130,1140,1150) IGOTO
cc      GO TO (100,110,120,130,140,150,160,170,180,190,200,210,220),NUM
C***********************************************************************
C***********************************************************************
C
 100  GO TO 500
C***********************************************************************
C
C     PRESCRIBED DISCHARGE COMPUTATIONAL SCHEME
C
 1020 WRITE(IPR,699)
      WRITE(IPR,770) LEVEL
 770  FORMAT(1H0,10X,4HSETQ,1H(,I1,1H),
     & ' -PRESCRIBED DISCHARGE COMPUTATIONAL SCHEME')
      IOPT=PO(LP)
      IF(IOPT .GT. 0)GO TO 112
C     SPECIFIED DISCHARGE
      SQVAL=PO(LP+1)*CONV2
      ITYPE=PO(LP+2)
      LP=LP+3
      IF(ITYPE.EQ.0)WRITE(IPR,775)SQVAL,UNT2
      IF(ITYPE.EQ.1)WRITE(IPR,777)SQVAL,UNT2
 775  FORMAT(1H0,20X,50HMEAN DISCHARGE VALUE
     1 =,F11.2,1X,A4)
 777  FORMAT(1H0,20X,50HINSTANTANEOUS DISCHARGE VALUE
     1 =,F11.2,1X,A4)
      GO TO 500
C     DISCHARGE SPECIFIED BY A TIME SERIES
 112  WRITE(IPR,780)
 780  FORMAT(1H0,20X,41HDISCHARGE IS PRESCRIBED BY A TIME SERIES.)
      ITYPE=PO(LP+1)
      LP=LP+2
      IF(ITYPE .EQ. 0)WRITE(IPR,785)
 785  FORMAT(1H ,20X,47HIF MISSING VALUES ARE ENCOUNTERED, PASS INFLOW.)
      IF(ITYPE .GT. 0)WRITE(IPR,790) ITYPE
 790  FORMAT(1H ,20X,50HIF MISSING VALUES ARE ENCOUNTERED, REPEAT THE LA
     1ST,I4,8H VALUES.)
C
      IT=PO(LT+3)
      WRITE(IPR,795)
 795  FORMAT(1H0,20X,64HADDITIONAL TIME SERIES:         ID         TYPE
     1        TIME(HR)/)
      WRITE(IPR,798) PO(LT),PO(LT+1),PO(LT+2),IT
  798 FORMAT(1H ,52X,2A4,3X,A4,11X,I2)
      GO TO 500
C***********************************************************************
C
C     PRESCRIBED ELEVATION COMPUTATIONAL SCHEME
C
 1030 WRITE(IPR,699)
      WRITE(IPR,800) LEVEL
 800  FORMAT(1H0,10X,4HSETH,1H(,I1,1H),
     & ' -PRESCRIBED ELEVATION COMPUTATIONAL SCHEME')
      IOPT=PO(LP)
      IF(IOPT .GT. 0)GO TO 122
C     SPECIFIED ELEVATION
      SHVAL=PO(LP+1)*CONV1
      WRITE(IPR,805) SHVAL,UNT1
 805  FORMAT(1H0,20X,50HTHE PRESCRIBED ELEVATION VALUE
     1 =,F11.2,1X,A4)
      GO TO 500
C     ELEVATION SPECIFIED BY A TIME SERIES
 122  WRITE(IPR,810)
 810  FORMAT(1H0,20X,41HELEVATION IS PRESCRIBED BY A TIME SERIES.)
      ITYPE=PO(LP+1)
      IF(ITYPE .EQ. 0)WRITE(IPR,785)
      IF(ITYPE .GT. 0)WRITE(IPR,790) ITYPE
      IT=PO(LT+3)
      WRITE(IPR,795)
      WRITE(IPR,798)PO(LT),PO(LT+1),PO(LT+2),IT
      GO TO 500
C***********************************************************************
C
C     RULE CURVE COMPUTATIONAL SCHEME
C
 1040 WRITE(IPR,699)
      WRITE(IPR,815) LEVEL
 815  FORMAT(1H0,10X,9HRULECURVE,1H(,I1,1H),
     &' -RULE CURVE COMPUTATIONAL SCHEME')
      NVAL=PO(LP)
      LO=LP
      NLOC=LO
      MOVE=0
      IF(NVAL.GE.0)GO TO 131
      MOVE=1
      LO=NVAL*(-1)+PO(10)-1
      NVAL=PO(LO)
 131  DO 132 J=1,NVAL
 132  IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 134 J=1,NVAL
 134  X(J)=PO(LO+J)*CONV1
      WRITE(IPR,820)
 820  FORMAT(1H0,20X,16HRULECURVE VALUES)
      JB=1
      JE=NVAL
      IF(JE .GT. 8)JE=8
 136  WRITE(IPR,825) (IDAY(J),J=JB,JE)
 825  FORMAT(1H0,25X,10HJULIAN DAY,8I11)
      WRITE(IPR,830)UNT1,(X(J),J=JB,JE)
 830  FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
      IF(JE .GE. NVAL)GO TO 138
      JB=JE+1
      JE=JE+8
      IF(JE .GT. NVAL) JE=NVAL
      GO TO 136
 138  LO =LO+NVAL+1
      ITIME=PO(LO)
      IF(ITIME.LT.0) ITIME=0
      LO=LO+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(ITIME.GE.0) WRITE(IPR,832)ITIME
 832  FORMAT(1H0,20X,50HTIME OF HYDROLOGIC DAY RULECURVE IS SET 
     1 =,I8)
      NUMBLD=PO(LO)
      WRITE(IPR,835)NUMBLD
 835  FORMAT(1H0,20X,50HNUMBER OF TIME PERIODS FOR BLENDING
     1 =,I8)
      QMAX=PO(LO+1)*CONV2
      IF (PO(LO+1).LE.-999.0) THEN
      WRITE(IPR,836)
 836  FORMAT(1H0,20X,50HMAXIMUM ALLOWABLE OUTFLOW
     1 =,' NO LIMIT')
      ELSE
      WRITE(IPR,837)QMAX,UNT2
 837  FORMAT(1H0,20X,50HMAXIMUM ALLOWABLE OUTFLOW
     1 =,F11.2,1X,A4)
      ENDIF
      GO TO 500
C***********************************************************************
C
C     FILL AND SPILL COMPUTATIONAL SCHEME
C
 1050 WRITE(IPR,699)
      WRITE(IPR,840)
 840  FORMAT(1H0,10X,8HFILLSPIL,
     & 37H -FILL AND SPILL COMPUTATIONAL SCHEME)
      QLIM=PO(LP)*CONV2
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624
C      NTS=3
      ISTS=1
C  END OF CHANGE OF 12/14/90
      LO=LP+1
 141  ITYPE=PO(LO)
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624
      NTS=3
C  END OF CHANGE OF 12/14/90
      IF(ITYPE .GE. 0)GO TO 142
      LO=-1*ITYPE+PO(10)-1
      ITYPE=PO(LO)
 142  IF(ITYPE .EQ. 0)WRITE(IPR,845)
      IF(ITYPE .GT. 0)WRITE(IPR,850)
 845  FORMAT(1H0,20X,24HSPILLWAY IS UNCONTROLLED)
 850  FORMAT(1H0,20X,17HSPILLWAY IS GATED)
      IF(ISTS.EQ.1)WRITE(IPR,852)QLIM,UNT2
 852  FORMAT(1H0,20X,50HLIMITING RELEASE BEFORE SPILLWAY CREST REACHED
     1 =,F11.2,1X,A4)
      REPLQ=PO(LO+1)*CONV2
      CREST=PO(LO+2)*CONV1
      NVAL=PO(LO+3)
      LO=LO+3
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 143
      MOVE=1
      LO=NVAL*(-1)+PO(10)-1
      NVAL=PO(LO)
 143  DO 144 J=1,NVAL
 144  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 146 J=1,NVAL
 146  Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      WRITE(IPR,855)REPLQ,UNT2
 855  FORMAT(1H0,20X,41HOUTFLOW VALUE FOR REPLACING PERIOD ENDING,/
     1 23X,48HDISCHARGE WITH PEAK DISCHARGE                  =,G14.6,1X,
     2 A4)
      WRITE(IPR,860)CREST,UNT1
 860  FORMAT(1H0,20X,50HSPILLWAY CREST ELEVATION
     1 =,F11.2,1X,A4)
      WRITE(IPR,862)
 862  FORMAT(1H0,20X,21HSPILLWAY RATING CURVE)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 148  WRITE(IPR,864)UNT1,(X(J),J=JB,JE)
 864  FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
      WRITE(IPR,866)UNT2,(Y(J),J=JB,JE)
 866  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
      IF(JE.GE.NVAL)GO TO 147
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 148
 147  INTP=PO(LO)
      IF(INTP.EQ.0)WRITE(IPR,853)
      IF(INTP.GT.0)WRITE(IPR,854)
 853  FORMAT(1H0,20X,44HLINEAR INTERPOLATION IS USED IN RATING CURVE)
 854  FORMAT(1H0,20X,49HLOGARITHMIC INTERPOLATION IS USED IN RATING CURV
     1E)
      IF(ITYPE .EQ. 0)GO TO 152
      LO=LO+1
      PASS=PO(LO)*CONV1
 152  NVAL=PO(LO+1)
      LO=LO+1
      MOVE=0
      NHVAL=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 151
      LO=NVAL*(-1)+PO(10)-1
      NVAL=PO(LO)
      MOVE=1
      GO TO 156
 151  IF(NVAL.NE.0)GO TO 156
      NHVAL=1
      GO TO 157
 156  DO 1562 J=1,NVAL
 1562 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1564 J=1,NVAL
 1564 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONV=PO(LO+2)
      LO=LO+2
      GO TO 158
 157  RMXNSQ=PO(LO+1)*CONV2
      LO=LO+1
 158  CONSTQ=PO(LO+1)*CONV2
C
      IF(ITYPE.GT.0)WRITE(IPR,868)PASS,UNT1
 868  FORMAT(1H0,20X,50HELEVATION WHERE INFLOW IS PASSED
     1 =,F11.2,1X,A4)
      IF(NHVAL.EQ.1)GO TO 159
      WRITE(IPR,874)
 874  FORMAT(1H0,20X,23HHEAD VS DISCHARGE CURVE)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1577 WRITE(IPR,876)UNT1,(X(J),J=JB,JE)
 876  FORMAT(1H0,25X,5HHEAD(,A4,1H),1X,8F11.2)
      WRITE(IPR,877)UNT2,(Y(J),J=JB,JE)
 877  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
      IF(JE.GE.NVAL)GO TO 1599
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1577
 1599 WRITE(IPR,872)ANAME(1),ANAME(2)
 872  FORMAT(1H0,20X,30HTAILWATER RATING CURVE NAME - ,2A4)
      WRITE(IPR,878)CONV
 878  FORMAT(1H0,20X,50HCONVERGENCE CRITERION
     1 =,F10.3)
      GO TO 1600
 159  WRITE(IPR,870)RMXNSQ,UNT2
 870  FORMAT(1H0,20X,50HMAXIMUM GENERATION DISCHARGE
     1 =,F11.2,1X,A4)
 1600 WRITE(IPR,879)CONSTQ,UNT2
 879  FORMAT(1H0,20X,50HCONSTANT SLUICEWAY DISCHARGE
     1 =,F11.2,1X,A4)
C     PRINT TIME SERIES INFORMATION
C
      ITS=0
      LO=LT
C  THE FOLLOWING CHANGE MADE 12/14/90 -- M624
C      DO 1679 J=1,NTS
      DO 1679 J=ISTS,NTS
C  END OF CHANGE OF 12/14/90-5
      IF(PO(LO).EQ.BLANK)GO TO 1680
      IF(ITS.EQ.0)WRITE(IPR,795)
      ITS=1
      IT=PO(LO+3)
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624
C      WRITE(IPR,798) PO(LO),PO(LO+1),PO(LO+2),IT
      WRITE(IPR,751) TSKW05(J),PO(LO),PO(LO+1),PO(LO+2),IT
  751 FORMAT(1H ,34X,A8,10X,2A4,3X,A4,11X,I2)
C  END OF CHANGE OF 12/14/90
      LO=LO+5
      GO TO 1679
 1680 LO=LO+2
 1679 CONTINUE
      GO TO 500
C***********************************************************************
C
C     SPILLWAY ROUTING COMPUTATIONAL SCHEME
C
 1060 WRITE(IPR,699)
      WRITE(IPR,897) LEVEL
 897  FORMAT(1H0,10X,8HSPILLWAY,1H(,I1,1H),
     & ' -SPILLWAY ROUTING COMPUTATIONAL SCHEME')
C  THE FOLLOWING CHANGE MADE ON 12/14/90 -- M624X
      LO=LP
C      NTS=2
      ISTS=2
C  END OF CHANGE OF 12/14/90
      GO TO 141
C     USE SAME STATEMENTS AS FILL AND SPILL COMPUTATIONAL SCHEME
C***********************************************************************
C
C     POOL ELEVATION CONTROLLED DISCHARGE COMPUTATIONAL SCHEME (POOLQ)
C
 1070 WRITE(IPR,699)
      WRITE(IPR,880) LEVEL
 880  FORMAT(1H0,10X,5HPOOLQ,1H(,I1,1H),
     & ' -POOL ELEVATION CONTROLLED DISCHARGE COMPUTATIONAL SCHEME')
      INPQ=PO(LP)
      NVAL=INPQ
      IF (INPQ .LT. 0) NVAL=-INPQ
      DO 162 J=1,NVAL
      X(J)=PO(LP+J)
 162  IF(X(J).GE.0)X(J)=X(J)*CONV1
      LO=LP+NVAL
      DO 164 J=1,NVAL
 164  Y(J)=PO(LO+J)*CONV2
      WRITE(IPR,882)
 882  FORMAT(1H0,20X,31HPOOL ELEVATION VS OUTFLOW TABLE)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 165  WRITE(IPR,884)UNT1,(X(J),J=JB,JE)
 884  FORMAT(1H0,25X,5HELEV(,A4,1H),8F11.2)
      WRITE(IPR,886)UNT2,(Y(J),J=JB,JE)
 886  FORMAT(1H ,25X,5HOUTF(,A4,1H),8F11.2)
      IF(JE.GE.NVAL)GO TO 166
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 165
  166 CONTINUE
      IF (INPQ .GT. 0) WRITE(IPR,887)
  887 FORMAT(1H0,25X,'CURVE INTERPOLATION SCHEME: CONSTANT Q')
      IF (INPQ .LT. 0) WRITE(IPR,888)
  888 FORMAT(1H0,25X,'CURVE INTERPOLATION SCHEME: LINEAR')
      LO=LO+NVAL+1
      ITYPE=PO(LO)
      IF(ITYPE.EQ.0)GO TO 500
      IF(ITYPE.GT.0)GO TO 161
      LO=-1*ITYPE+PO(10)-1
 161  NVAL=PO(LO)
      DO 167 J=1,NVAL
 167  IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 168 J=1,NVAL
 168  X(J)=PO(LO+J)*CONV1
C
      WRITE(IPR,820)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 169  WRITE(IPR,825)(IDAY(J),J=JB,JE)
      WRITE(IPR,830)UNT1,(X(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1699
      JB=JE+1
 1    JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 169
 1699 LO=LO+NVAL+1
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPR,832) ITIME
      GO TO 500
C***********************************************************************
C
C     D/S STAGE AND POOL ELEVATION CONTROLLED OUTFLOW SCHEME (STPOOLQ)
C
 1080 WRITE(IPR,699)
      WRITE(IPR,1700)LEVEL
 1700 FORMAT(1H0,10X,7HSTPOOLQ,1H(,I1,1H),' -STAGE AND POOL ELEVATION ',
     & 'CONTROLLED OUTFLOW COMPUTATIONAL SCHEME')
      CALL PRPB26(PO,LP,LT)
      GO TO 500
C***********************************************************************
C     DISCHARGE MINIMIZATION COMPUTATIONAL SCHEME (MINQ)
C
 1090 WRITE(IPR,699)
      WRITE(IPR,900)LEVEL
 900  FORMAT(1H0,10X,4HMINQ,1H(,I1,1H),
     & ' -DISCHARGE MINIMIZATION COMPUTATIONAL SCHEME')
      CALL PRPC26(PO,LP,LT)
      GO TO 500
C***********************************************************************
C
C     UPSTREAM STAGE MINIMIZATION COMPUTATIONAL SCHEME (MINH)
C
 1100 WRITE(IPR,699)
      WRITE(IPR,930) LEVEL
 930  FORMAT(1H0,10X,4HMINH,1H(,I1,1H),
     &' -UPSTREAM STAGE MINIMIZATION COMPUTATIONALSCHEME'/)
      CALL PRPD26(PO,LP,LT)
      GO TO 500
C***********************************************************************
C
C     INDUCED SURCHARGE COMPUTATIONAL SCHEME
C
 1110 WRITE(IPR,699)
      WRITE(IPR,5050) LEVEL
 5050 FORMAT(1H0,10X,9HINDSRCHGE,1H(,I1,1H),
     &' -INDUCED SURCHARGE COMPUTATIONAL SCHEME')
      CALL PRPE26(PO,LP,LT)
      GO TO 500
C
C***********************************************************************
C
C     FLASHBOARDS COMPUTATIONAL SCHEME
C
 1120 WRITE(IPR,699)
      WRITE(IPR,6020) LEVEL
 6020 FORMAT(1H0,10X,8HFLASHBDS,1H(,I1,1H),
     & ' -FLASHBOARDS COMPUTATIONAL SCHEME')
      CALL PRPF26(PO,LP,LT)
      GO TO 500
C
C***********************************************************************
C
C     POWER GENERATION COMPUTATIONAL SCHEME (POWERGEN)
C
 1130 WRITE(IPR,699)
      WRITE(IPR,6060) LEVEL
 6060 FORMAT(1H0,10X,8HPOWERGEN,1H(,I1,1H),
     & ' -POWER GENERATION COMPUTATIONAL SCHEME')
      CALL PRPG26(PO,LP,LT)
      GO TO 500
C***********************************************************************
C
C     PRESCRIBED DISCHARGE  CHANGE RATE SCHEME (SETDQ)
C
 1140 WRITE(IPR,699)
      WRITE(IPR,1141) LEVEL
 1141 FORMAT(1H0,10X,5HSETDQ,1H(,I1,1H),
     & ' -PRESCRIBED DISCHARGE CHANGE RATE SCHEME')
      ITBL=PO(LP)
      ITBTYP=PO(LP+1)
      IQO=PO(LP+2)
      IF(ITBL .LE. 0) THEN
C     DISCHARGE CHANGE RATE 
        QVAL=PO(LP+1)*CONV2
        LP=LP+3
        WRITE(IPR,1142) QHTYPE(IQO),QVAL,UNT2
 1142   FORMAT(1H0,20X,A4,' DISCHARGE CHANGE RATE = '
     &  ,F11.2,1X,A4,4H/DAY)
        GO TO 500
      ENDIF
C     DISCHARGE CHANGE RATE  TO BE DETERMINED FROM TABLE
      CONVX=CONV2
      IF(ITBTYP.EQ.3) CONVX=CONV1
      LP=LP+3
C
      NVAL=PO(LP)
      DO J=1,NVAL
        X(J)=PO(LP+J)
        IF(X(J).GE.0)X(J)=X(J)*CONVX
      ENDDO
C
      LO=LP+NVAL
      DO J=1,NVAL
        Y(J)=PO(LO+J)*CONV2
      ENDDO
C
      IF(ITBTYP.LE.2) WRITE(IPR,1143) 
     &  QHTYPE(ITBTYP),UNT2,QHTYPE(IQO),UNT2
 1143 FORMAT(1H0,20X,A4,' DISCHARGE (',A3,
     & ') VS 'A4,' DISCHARGE CHANGE RATE (',A3,'/DAY) TABLE:')
      IF(ITBTYP.EQ.3) WRITE(IPR,1144) 
     &  QHTYPE(ITBTYP),UNT1,QHTYPE(IQO),UNT2
 1144 FORMAT(1H0,20X,A4,' ELEVATION (',A2,
     & ') VS 'A4,' DISCHARGE CHANGE RATE (',A3,'/DAY) TABLE:')
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1145 WRITE(IPR,1147) (X(J),J=JB,JE)
 1147 FORMAT(1H0,25X,5HX(J)=,8F11.2)
      WRITE(IPR,1148) (Y(J),J=JB,JE)
 1148 FORMAT(1H0,25X,5HY(J)=,8F11.2)
      IF(JE.GE.NVAL)GO TO 1146
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1145
 1146 CONTINUE
      GO TO 500
C***********************************************************************
C
C     PRESCRIBED POOL ELEVATION CHANGE RATE SCHEME (SETDH)
C
 1150 WRITE(IPR,699)
      WRITE(IPR,1151) LEVEL
 1151 FORMAT(1H0,10X,5HSETDH,1H(,I1,1H),
     & ' -PRESCRIBED POOL ELEVATION CHANGE RATE SCHEME')
      ITBL=PO(LP)
      ITBTYP=PO(LP+1)
      IF(ITBL .LE. 0) THEN
C     POOL ELEVATION CHANGE RATE 
        HVAL=PO(LP+1)*CONV1
        LP=LP+2
        WRITE(IPR,1152) HVAL,UNT1
 1152   FORMAT(1H0,24X,' POOL ELEVATION CHANGE RATE = '
     &  ,F11.2,1X,A4,4H/DAY)
        GO TO 500
      ENDIF
C     POOL ELEVATION CHANGE RATE  TO BE DETERMINED FROM TABLE
      CONVX=CONV2
      IF(ITBTYP.EQ.3) CONVX=CONV1
      LP=LP+2
C
      NVAL=PO(LP)
      DO J=1,NVAL
        X(J)=PO(LP+J)
        IF(X(J).GE.0)X(J)=X(J)*CONVX
      ENDDO
C
      LO=LP+NVAL
      DO J=1,NVAL
        Y(J)=PO(LO+J)*CONV1
      ENDDO
C
      IF(ITBTYP.LE.2) WRITE(IPR,1153) QHTYPE(ITBTYP),UNT2,UNT1
 1153 FORMAT(1H0,20X,A4,' DISCHARGE (',A3,
     & ') VS  POOL ELEVATION CHANGE RATE (',A2,'/DAY) TABLE:')
      IF(ITBTYP.EQ.3) WRITE(IPR,1154) QHTYPE(ITBTYP),UNT1,UNT1
 1154 FORMAT(1H0,20X,A4,' ELEVATION (',A2,
     & ') VS  POOL ELEVATION CHANGE RATE (',A2,'/DAY) TABLE:')
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1155 WRITE(IPR,1157) (X(J),J=JB,JE)
 1157 FORMAT(1H0,25X,5HX(J)=,8F11.2)
      WRITE(IPR,1158) (Y(J),J=JB,JE)
 1158 FORMAT(1H0,25X,5HY(J)=,8F11.2)
      IF(JE.GE.NVAL)GO TO 1156
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1155
 1156 CONTINUE
      GO TO 500
C
C***********************************************************************
C***********************************************************************
C
C     SELECTION IS A UTILITY
C
cc 1500 NUM=NUM/10-150
 1500 CALL PRPU26(PO,IBASE,LP,LT)
      GO TO 500
C
C***********************************************************************
C
 500  CONTINUE
 501  CONTINUE
C***********************************************************************
C***********************************************************************
C     DECODE AND PRINT THE RESERVOIR COMMAND LANGUAGE
C
      WRITE(IPR,699)
      WRITE(IPR,505)
 505  FORMAT(1H0,40X,36H*****RESERVOIR COMMAND LANGUAGE*****/)
      INUM=IPR
      CALL FPR26(PO,INUM)
C**********************************************************************
      RETURN
      END
