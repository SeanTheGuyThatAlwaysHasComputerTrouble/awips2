C MEMBER PRP18
C  (from old member FCPRP18)
C
      SUBROUTINE PRP18(PO)
C
C   THIS SUBROUTINE IS THE PRINT PARAMETER SUBROUTINE FOR
C   THE PLOT-TS OPERATION.
C
C   THIS SUBROUTINE WAS INITIALLY PROGRAMMED BY
C   GERALD N. DAY  -  HRL  MAY 1980
C
      DIMENSION PO(1),PTYPE(6)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      INCLUDE 'common/fengmt'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_prpc/RCS/prp18.f,v $
     . $',                                                             '
     .$Id: prp18.f,v 1.1 1995/09/17 18:50:03 dws Exp $
     . $' /
C    ===================================================================
C
      DATA PTYPE/4HARIT,4HHMET,4HIC  ,4HLOGA,4HRITH,4HMIC /
      DATA RMINI/4HMINI/,RMAXI/4HMAXI/
      IF(ITRACE.GE.1) WRITE(IODBUG,900)
C
C   WRITE HEADER INFORMATION
C
      WRITE(IPR,905) (PO(I),I=2,6)
      NOPT=PO(7)
      NPLOTS=PO(8)
      NTTS=PO(9)
      NPER=PO(10)
      INT=PO(11)
      IF(NOPT.EQ.1) GO TO 10
      WRITE(IPR,910) INT
      GO TO 20
   10 WRITE(IPR,915)
   20 NTSKNT=0
      DO 40 I=1,NPLOTS
      IPO=11+(I-1)*9
      NPTS=PO(IPO+2)
      NTS=PO(IPO+5)
C
C   WRITE PLOT INFORMATION
C
      WRITE(IPR,920) I
      L=4
      IF(PO(IPO+1).EQ.PTYPE(1)) L=1
      K=L+2
      WRITE(IPR,925) (PTYPE(J),J=L,K),NPTS
C
      IF(METRIC.EQ.0) GO TO 25
C
C   METRIC UNITS
C
      XMIN=PO(IPO+3)
      XMAX=PO(IPO+4)
      UNITS=PO(IPO+6)
      GO TO 28
   25 CONTINUE
C
C   ENGLISH UNITS
C
      UNITS=PO(IPO+7)
      XMIN=PO(IPO+3)*PO(IPO+8)+PO(IPO+9)
      XMAX=PO(IPO+4)*PO(IPO+8)+PO(IPO+9)
   28 CONTINUE
      WRITE(IPR,930) XMIN,UNITS,XMAX,UNITS
      WRITE(IPR,935)
      DO 30 J=1,NTS
      IPO=11+9*NPLOTS+12*(NTSKNT+J-1)
      IDT=PO(IPO+4)
      IPO3 = IPO+3
C
C   WRITE TS INFORMATION
C
      WRITE(IPR,940) J,(PO(IPO+K),K=1,2),PO(IPO3),IDT,
     1 (PO(IPO+K),K=8,10)
   30 CONTINUE
      NTSKNT=NTSKNT+NTS
   40 CONTINUE
      IF(NOPT.NE.2) GO TO 60
C
C   WRITE INFO FOR PLOT OPTION 2
C
      WRITE(IPR,945)
      DO 50 I=1,NPER
      IPO=11+9*NPLOTS+12*NTTS+2*(I-1)
      IJDAP=PO(IPO+1)
      LJDAP=PO(IPO+2)
      CALL MDYH1(IJDAP,1,IMOP,IDAP,IYRP,IHRP,100,0,TZONE)
      CALL MDYH1(LJDAP,1,LMOP,LDAP,LYRP,LHRP,100,0,TZONE)
      WRITE(IPR,950) I,IMOP,IDAP,IYRP,LMOP,LDAP,LYRP
   50 CONTINUE
      GO TO 100
   60 IF(NOPT.NE.4) GO TO 100
C
C   WRITE INFO PLOT OPTION 4
C
      IPO=11+9*NPLOTS+12*NTTS
      ITS=PO(IPO+1)
      CRIT=PO(IPO+2)
      KODE=PO(IPO+3)
C
      KNTS=0
      DO 80 I=1,NPLOTS
      IPO=11+(I-1)*9
      NTS=PO(IPO+5)
      KNTS=KNTS+NTS
      IF(ITS.GT.KNTS) GO TO 80
      IF(METRIC.EQ.0) GO TO 70
C
C   METRIC UNITS
C
      UNITS=PO(IPO+6)
      GO TO 90
   70 CONTINUE
C
C   ENGLISH UNITS
C
      UNITS=PO(IPO+7)
      CRIT=CRIT*PO(IPO+8)+PO(IPO+9)
      GO TO 90
   80 CONTINUE
   90 CONTINUE
      TYPE=RMINI
      IF(KODE.EQ.1) TYPE=RMAXI
      IPO=11+9*NPLOTS+12*(ITS-1)
      IDT=PO(IPO+4)
      WRITE(IPR,955) (PO(IPO+K),K=1,2),PO(IPO+3),IDT,PO(IPO+9),
     1 PO(IPO+10),TYPE,CRIT,UNITS
  100 CONTINUE
      IF(ITRACE.GE.1) WRITE(IODBUG,960)
      RETURN
  900 FORMAT(1H0,16H** PRP18 ENTERED)
  905 FORMAT(1H0,10X,26HPLOT TIME SERIES OPERATION,14X,5A4)
  910 FORMAT(1H0,20X,21HPLOT TIME INTERVAL = ,I2,7H  HOURS)
  915 FORMAT(1H0,20X,23HWATER YEAR PLOT (DAILY))
  920 FORMAT(1H0,40X,9H*** PLOT ,I2,4H ***)
  925 FORMAT(16X,14HPLOT SCALE IS ,3A4,2X,5HUSING,2X,I3,
     1 2X,7HCOLUMNS)
  930 FORMAT(16X,15HMIN ORDINATE = ,G12.5,1X,A4,10X,
     1 15HMAX ORDINATE = ,G12.5,1X,A4)
  935 FORMAT(1H0,15X,11HTIME SERIES,9X,4HI.D.,7X,4HTYPE,5X,
     1 13HTIME INTERVAL,5X,11HPLOT SYMBOL)
  940 FORMAT(18X,I4,12X,2A4,5X,A4,10X,I2,15X,A1,10X,2A4)
  945 FORMAT(1H0,40X,21HPERIODS TO BE PLOTTED,/,
     1 34X,6HPERIOD,8X,5HSTART,11X,3HEND)
  950 FORMAT(34X,I3,7X,I2,1H/,I2,1H/,I4,5X,I2,1H/,I2,1H/,I4)
  955 FORMAT(1H0,20X,11HTIME SERIES,4X,2A4,2X,A4,2X,I2,2X,
     1 44HIS USED AS THE PLOTTING CRITERIA TIME SERIES,5X,2A4,/,74X,
     2 7HWITH A ,A4,16HMUM CRITERIA OF ,G12.5,1X,A4)
  960 FORMAT(1H0,15H** PRP18 EXITED)
      END
