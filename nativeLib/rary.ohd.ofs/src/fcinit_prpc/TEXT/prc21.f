C MEMBER PRC21
C  (from old member FCPRC21)
C
C DESC -- THIS SUBROUTINE PRINTS OUT THE CARRYOVER ARRAY FOR THE DWOPER
C DESC    OPERATON.
C                             LAST UPDATE: 02/14/94.14:38:12 BY $WC30JL
C
C
C @PROCESS LVL(77)
      SUBROUTINE PRC21(PO,CO,NB,NQL,NDIV,NUMLAD,IWTI,LAD)
C
C           THIS SUBROUTINE WAS WRITTEN BY:
C           JANICE LEWIS      HRL   NOVEMBER,1982     VERSION NO. 1
C
      COMMON/IONUM/IN,IPR,IPU
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDBUG(20)
C
      DIMENSION PO(*),CO(*),NB(*),NQL(*),NDIV(*),NUMLAD(*),IWTI(*)
      DIMENSION SNAME(2),LAD(*)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_prpc/RCS/prc21.f,v $
     . $',                                                             '
     .$Id: prc21.f,v 1.3 1998/07/02 20:14:04 page Exp $
     . $' /
C    ===================================================================
C
C
      DATA SNAME/4HPRC2,4H1   /
C
C
      CALL FPRBUG(SNAME,1,21,IBUG)
C
      IVER=PO(1)
      JN=PO(25)
      NTQL=PO(12)
      NTDV=PO(113)
      NTLD=PO(6)
C
C        WRITE THE INITIAL WATER SURFACE ELEVATIONS
C
      KUSE=1
      DO 300 J=1,JN
      WRITE(IPR,100) J
      N=NB(J)
      LUSE=KUSE+N-1
      WRITE(IPR,200) (CO(K),K=KUSE,LUSE)
      KUSE=LUSE+1
  300 CONTINUE
C
C        WRITE THE INITIAL DISCHARGES
C
      KUSE=PO(121)
      DO 400 J=1,JN
      WRITE(IPR,500) J
      N=NB(J)
      LUSE=KUSE+N-1
      WRITE(IPR,200) (CO(K),K=KUSE,LUSE)
      KUSE=LUSE+1
  400 CONTINUE
C
C
C        WRITE THE INITIAL LATERAL INFLOWS
C
      IF(NTQL.EQ.0) GO TO 650
      KUSE=PO(122)
      DO 600 J=1,JN
      IF(NQL(J).EQ.0) GO TO 600
      WRITE(IPR,700) J
      N=NQL(J)
      LUSE=KUSE+N-1
      WRITE(IPR,200) (CO(K),K=KUSE,LUSE)
      KUSE=LUSE+1
  600 CONTINUE
C
C        WRITE THE PERCENT OF FLOW INITIALLY DIVERTED
C
  650 IF(NTDV.EQ.0) GO TO 850
      KUSE=PO(123)
      DO 800 J=1,JN
      IF(NDIV(J).EQ.0) GO TO 800
      WRITE(IPR,900) J
      N=NDIV(J)
      LUSE=KUSE+N-1
      WRITE(IPR,200) (CO(K),K=KUSE,LUSE)
      KUSE=LUSE+1
  800 CONTINUE
C
C        WRITE THE INITIAL TARGET POOL ELEVATIONS
C
  850 IF(NTLD.EQ.0) GO TO 1500
      KUSE=PO(124)
      LCTW=PO(70)-1
      DO 1000 J=1,JN
      IF(NUMLAD(J).EQ.0) GO TO 1000
      N=NUMLAD(J)
      I1=LCAT21(1,J,NUMLAD)-1
      LOCK=0
      DO 860 L=1,N
      IF(LAD(I1+L).GT.0.AND.PO(LCTW+L).GT.0) LOCK=LOCK+1
  860 CONTINUE
      IF(LOCK.EQ.0) GO TO 1000
      LUSE=KUSE+LOCK-1
      WRITE(IPR,1100) J
      WRITE(IPR,200) (CO(K),K=KUSE,LUSE)
      KUSE=LUSE+1
      LCTW=LCTW+N
 1000 CONTINUE
C
C        WRITE THE INITIAL GATE CONTROL SWITCHES
C
      LLAD=PO(73)
      LIWT=PO(125)-1
      LCTW=PO(70)-1
      DO 1200 J=1,JN
      IF(NUMLAD(J).EQ.0) GO TO 1200
      N=NUMLAD(J)
      IF(IVER.LT.3) I1=LCAT21(1,J,NUMLAD)-1
      LOCK=0
      DO 1150 L=1,N
      IF(IVER.LT.3) LLAD=I1+L
      IF(LAD(LLAD).GT.0.AND.PO(LCTW+L).GT.0.) LOCK=LOCK+1       
      IF(IVER.GE.3) LLAD=LLAD+2
 1150 CONTINUE
      IF(LOCK.EQ.0) GO TO 1200
      WRITE(IPR,1300) J
      WRITE(IPR,1400) (IWTI(LIWT+I),I=1,LOCK)
      LIWT=LIWT+LOCK
      LCTW=LCTW+N
 1200 CONTINUE
C
  100 FORMAT(1H0,10X,46HINITIAL WATER SURFACE ELEVATIONS FOR RIVER NO.,
     1 I2)
  200 FORMAT(1H ,10X,10F12.2)
  500 FORMAT(1H0,10X,32HINITIAL DISCHARGES FOR RIVER NO.,I2)
  700 FORMAT(1H0,10X,37HINITIAL LATERAL INFLOWS FOR RIVER NO.,I2)
  900 FORMAT(1H0,10X,49HPERCENT OF FLOW INITIALLY DIVERTED FROM RIVER NO
     1.,I2)
 1100 FORMAT(1H0,10X,44HINITIAL TARGET POOL ELEVATIONS FOR RIVER NO.,I2)
 1300 FORMAT(1H0,10X,43HINITIAL GATE CONTROL SWITCHES FOR RIVER NO.,I2)
 1400 FORMAT(1H0,10X,20I5)
C
      IF(ITRACE.EQ.1) WRITE(IODBUG,9000) SNAME
 9000 FORMAT(1H0,2H**,1X,2A4,8H EXITED.)
 1500 RETURN
      END
