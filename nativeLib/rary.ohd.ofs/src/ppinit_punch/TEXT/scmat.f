C MEMBER SCMAT
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 09/13/95.14:16:46 BY $WC21DT
C
C @PROCESS LVL(77)
C
C DESC PUNCH AREA MAT PARAMETER RECORD
C
      SUBROUTINE SCMAT (IVMAT,XMATID,DESCRP,CENTRD,BASNID,ISTWT,POWER,
     *   NTEMP,TEMPID,WTMMT,ISTAT)
C
      DIMENSION XMATID(2),DESCRP(1),CENTRD(*)
      DIMENSION BASNID(2),TEMPID(2,1),WTMMT(1)
      DIMENSION CARD(20),CHAR(2),ARRAY(100)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'scommon/sugnlx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_punch/RCS/scmat.f,v $
     . $',                                                             '
     .$Id: scmat.f,v 1.2 1996/01/17 22:43:29 page Exp $
     . $' /
C    ===================================================================
C
C
      DATA BLANK4/4H    /,LARRAY/100/
      DATA MAXCHR/8/,CARD/20*4H    /
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,110)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG(4HMAT )
C
      ISTAT=0
      NUMWRN=0
C
C  PRINT PARAMETER ARRAY VERSION NUMBER
      IF (LDEBUG.EQ.0) GO TO 10
         WRITE (IOSDBG,140) IVMAT
         CALL SULINE (IOSDBG,2)
C
C  PUNCH 'MAT' STARTING IN COLUMN 1
10    NPOS=1
      CALL UTOCRD (ICDPUN,NPOS,3HMAT,3,2,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
C
C  PUNCH IDENTIFIER
      CALL UTOCRD (ICDPUN,NPOS,XMATID(1),8,1,CARD,3,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
C
C  PUNCH DESCRIPTION
      CALL UTOCRD (ICDPUN,NPOS,DESCRP(1),20,1,CARD,3,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
C
      IF (BASNID(1).EQ.BLANK4.AND.BASNID(2).EQ.BLANK4) GO TO 20
C
C  PUNCH BASIN BOUNDARY IDENTIFIER OR CENTROID COORDINATES
C  BASIN BOUNDARY IDENTIFIER
      CALL UTOCRD (ICDPUN,NPOS,BASNID(1),8,1,CARD,3,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      GO TO 30
C
C  CENTROID COORDINATES (LAT/LON)
20    IF (IUGFIL.EQ.0) CALL SUGTUG (LARRAY,ARRAY,ICHECK)
      CALL UMEMOV(CENTRD(1),XLAT,1)
      CALL UMEMOV(CENTRD(2),XLONG,1)
      IF (XLAT.LE.ULLMTS(1).AND.XLAT.GE.ULLMTS(2)) THEN
         ELSE
            WRITE (LP,15) 'LATITUDE',XLAT,XMATID,
     *                     ULLMTS(2),ULLMTS(1)
            CALL SUWRNS(LP,2,NUMWRN)
         ENDIF
      IF (XLONG.LE.ULLMTS(4).AND.XLONG.GE.ULLMTS(3)) THEN
         ELSE
            WRITE (LP,15) 'LONGTITUDE',XLONG,XMATID,
     *                     ULLMTS(3),ULLMTS(4)
            CALL SUWRNS(LP,2,NUMWRN)
         ENDIF
      CALL URELCH (CENTRD(1),MAXCHR,CHAR,2,NFILL,IERR)
      CALL UTOCRD (ICDPUN,NPOS,1H(,1,0,CARD,0,0,LNUM,IERR)
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
C
      CALL URELCH (CENTRD(2),MAXCHR,CHAR,2,NFILL,IERR)
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,0,CARD,0,0,LNUM,IERR)
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
30    CONTINUE
C
C  PUNCH TYPE OF STATION WEIGHTS
      GO TO (40,60,70),ISTWT
C
40    CALL UTOCRD (ICDPUN,NPOS,4HPRE(,4,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      NSPACE=1
C
      DO 50 I=1,NTEMP
         IF (I.EQ.NTEMP) NSPACE=0
         CALL UTOCRD (ICDPUN,NPOS,TEMPID(1,I),8,0,CARD,3,0,LNUM,IERR)
         IF (IERR.GT.0) GO TO 90
         CALL UTOCRD (ICDPUN,NPOS,1H,,1,0,CARD,0,0,LNUM,IERR)
         IF (IERR.GT.0) GO TO 90
         CALL URELCH (WTMMT(I),MAXCHR,CHAR,2,NFILL,IERR)
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,NSPACE,CARD,0,0,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 90
50    CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      GO TO 80
C
60    CALL UTOCRD (ICDPUN,NPOS,4HGRID,4,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      GO TO 80
C
70    CALL UTOCRD (ICDPUN,NPOS,3HDP(,3,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      CALL URELCH (POWER,MAXCHR,CHAR,1,NFILL,IERR)
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 90
80    CALL UPNCRD (ICDPUN,CARD)
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,120) XMATID(1),XMATID(2)
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
      GO TO 100
C
90    ISTAT=1
100   IF (ISTRCE.GT.0) WRITE (IOSDBG,130)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - --
C
15    FORMAT ('0*** WARNING - ',A,' ',F11.1,' FOR AREA MAT ',A8,' IS ',
     *        'NOT IN THE RANGE OF ',F11.1,' THROUGH ',F11.1,'.')
110   FORMAT (' *** ENTER SCMAT')
120   FORMAT (' *** NOTE - MAT  PARAMETERS SUCCESSFULLY ',
     *'PUNCHED FOR AREA ',2A4)
130   FORMAT(' *** EXIT SCMAT')
140   FORMAT ('0PARAMETER ARRAY VERSION NUMBER = ',I2)
C
      END
