C MEMBER SCMARO
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 06/07/95.15:04:03 BY $WC21DT
C
C @PROCESS LVL(77)
C
C DESC PUNCH MEAN AREAL RUNOFF (MARO) PARAMETERS
C
      SUBROUTINE SCMARO (IVMARO,XMAROI,XDESCR,CENTRD,NGRID,
     *   ITSREC,XSTAID,MMDRBX,NMGPA,NMRFRO,
     *   ISTAT)
C
      REAL XMAPI/4HMAPI/
      REAL XMAPG/4HMAPG/
      REAL XMARO/4HMARO/
      INCLUDE 'scommon/dimmaro'
      DIMENSION CARD(20),CHAR(2)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_punch/RCS/scmaro.f,v $
     . $',                                                             '
     .$Id: scmaro.f,v 1.1 1995/09/17 19:14:35 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA MAXCHR/8/,CARD/20*4H    /
C
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,100)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG(XMARO)
C
      ISTAT=0
C
C  PRINT PARAMETER ARRAY VERSION NUMBER
      IF (LDEBUG.EQ.0) GO TO 10
         WRITE (IOSDBG,110) IVMARO
         CALL SULINE (IOSDBG,2)
C
C  PUNCH 'MARO' STARTING IN COLUMN 1
10    NPOS=1
      CALL UTOCRD (ICDPUN,NPOS,XMARO,4,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH IDENTIFIER
      CALL UTOCRD (ICDPUN,NPOS,XMAROI,8,1,CARD,3,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH DESCRIPTION
      CALL UTOCRD (ICDPUN,NPOS,XDESCR,20,1,CARD,3,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH CENTROID COORDINATES
      CALL URELCH (CENTRD(1),MAXCHR,CHAR,2,NFILL,IERR)
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL URELCH (CENTRD(2),MAXCHR,CHAR,2,NFILL,IERR)
      NSPACE=1
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,NSPACE,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH GRID POINT ADDRESS OF EACH GRID POINT IN AREA
      CALL UTOCRD (ICDPUN,NPOS,4HGPA(,4,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      NSPACE=1
      DO 20 I=1,NGRID
         CALL UINTCH (NMGPA(I),MAXCHR,CHAR,NFILL,IERR)
         IF (I.EQ.NGRID) NSPACE=0
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,NSPACE,CARD,0,0,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
20       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH RAINFALL-RUNOFF RELATIONSHUP NUMBER ASSOCIATED WITH EACH GRID
C  POINT
      CALL UTOCRD (ICDPUN,NPOS,4HRRN(,4,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      NSPACE=1
      DO 30 I=1,NGRID
         CALL UINTCH (NMRFRO(I),MAXCHR,CHAR,NFILL,IERR)
         IF (I.EQ.NGRID) NSPACE=0
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,NSPACE,CARD,0,0,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
30       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH IDENTIFIER OF FIRST ORDER STATION ASSIGNED TO AREA
      CALL UTOCRD (ICDPUN,NPOS,XSTAID,8,1,CARD,3,0,LNUM,IERR)
C
C  PUNCH MDR BOXES THAT SURROUND THE AREA
      CALL UTOCRD (ICDPUN,NPOS,4HMDR(,4,0,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      NSPACE=1
      ITYPE=1
      DO 40 I=1,3
         CALL SBNUMM (MMDRBX(I),MDRCOL,MDRROW,IERR)
         CALL UINTCH (MDRROW,MAXCHR,CHAR,NFILL,IERR)
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,0,CARD,ITYPE,0,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
         CALL UTOCRD (ICDPUN,NPOS,1H,,1,0,CARD,0,0,LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
         CALL UINTCH (MDRCOL,MAXCHR,CHAR,NFILL,IERR)
         IF (I.EQ.3) NSPACE=0
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MAXCHR,NSPACE,CARD,ITYPE,0,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
40       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
      IF (ITSREC(1).GT.0.AND.ITSREC(2).GT.0) GO TO 70
C
C  PUNCH INDICATOR TO NOT GENERATE MAPG AND/OR MAPI TIME SERIES
      NUMNOT=0
      DO 60 I=1,2
         IF (ITSREC(I).GT.0) GO TO 60
            IF (NUMNOT.EQ.1) GO TO 50
               CALL UTOCRD (ICDPUN,NPOS,5HNOTS(,5,0,CARD,0,0,LNUM,IERR)
               IF (IERR.GT.0) GO TO 80
50          IF (NUMNOT.EQ.0) GO TO 55
               CALL UTOCRD (ICDPUN,NPOS,1H,,1,0,CARD,0,0,LNUM,IERR)
               IF (IERR.GT.0) GO TO 80
55          IF (I.EQ.1) CALL SUBSTR (XMAPG,1,4,CHAR,1)
            IF (I.EQ.2) CALL SUBSTR (XMAPI,1,4,CHAR,1)
            IF (NUMNOT.EQ.1) NPOS=NPOS+1
            CALL UTOCRD (ICDPUN,NPOS,CHAR,4,0,CARD,0,0,LNUM,IERR)
            IF (IERR.GT.0) GO TO 80
            NUMNOT=NUMNOT+1
60       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,1H),1,1,CARD,0,0,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
70    CALL UPNCRD (ICDPUN,CARD)
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,120) XMAROI
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
      GO TO 90
C
80    ISTAT=1
C
90    IF (ISTRCE.GT.0) WRITE (IOSDBG,130)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
100   FORMAT (' *** ENTER SCMARO')
110   FORMAT ('0PARAMETER ARRAY VERSION NUMBER = ',I2)
120   FORMAT (' *** NOTE - MARO PARAMETERS FOR AREA ',2A4,
     *   ' SUCCESSFULLY PUNCHED.')
130   FORMAT(' *** EXIT SCMARO')
C
      END
