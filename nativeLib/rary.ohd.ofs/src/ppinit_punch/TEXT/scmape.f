C MEMBER SCMAPE
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 06/07/95.14:18:31 BY $WC21DT
C
C @PROCESS LVL(77)
C
C DESC: ROUTINE TO PUNCH AREA MAPE PARAMETER RECORD
C
      SUBROUTINE SCMAPE (UNITS,IVMAPE,MAPEID,DESCRP,CENTRD,ISTWT,
     *   POWER,PEMEAN,NPE,STAID,STAWT,ISTAT)
C
      CHARACTER*(*) UNITS
      CHARACTER*8 MAPEID
      CHARACTER*20 DESCRP
      CHARACTER*8 CHAR
      CHARACTER*80 CARD/' '/
C
      DIMENSION CENTRD(2),PEMEAN(12),STAID(2,1),STAWT(1)
      DIMENSION VALUE(12),ARRAY(100)
C
      INCLUDE 'uio'

      INCLUDE 'scommon/sudbgx'
      INCLUDE 'scommon/sugnlx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_punch/RCS/scmape.f,v $
     . $',                                                             '
     .$Id: scmape.f,v 1.1 1995/09/17 19:14:33 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,100)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('MAPE')
C
      ISTAT=0
      LARRAY=100
C
      MCHAR=LEN(CHAR)
      NCHECK=0
      NUMWRN=0
C
C  PRINT PARAMETER ARRAY VERSION NUMBER
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,110) IVMAPE
         CALL SULINE (IOSDBG,2)
         ENDIF
C
C  PUNCH 'MAPE' STARTING IN COLUMN 1
      NPOS=1
      CHAR='MAPE'
      LCHAR=LENSTR(CHAR)
      NSPACE=0
      CALL UTOCRD (ICDPUN,NPOS,CHAR,LCHAR,NSPACE,CARD,0,NCHECK,
     *             LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH UNITS TYPE
      CALL UTOCRD (ICDPUN,NPOS,'(',1,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,UNITS,4,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,')',1,1,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH IDENTIFIER
      CALL UTOCRD (ICDPUN,NPOS,MAPEID,LEN(MAPEID),1,CARD,3,NCHECK,
     *             LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH DESCRIPTION
      CALL UTOCRD (ICDPUN,NPOS,DESCRP,LEN(DESCRP),1,CARD,3,NCHECK,
     *             LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  TRANSFORM COORDINATES FROM NWSRFS/HRAP TO LATITUDE/LONGITUDE
C  COORDINATES
C  PUNCH CENTROID COORDINATES
      CALL SBLLGD (XLONG,XLAT,1,CENTRD(1),CENTRD(2),0,IERR)
      IF (IERR.GT.0) GO TO 80
      IF (IUGFIL.EQ.0) CALL SUGTUG (LARRAY,ARRAY,ICHECK)
      IF (XLAT.LE.ULLMTS(1).AND.XLAT.GE.ULLMTS(2)) THEN
         ELSE
            WRITE (LP,15) 'LATITUDE',XLAT,MAPEID,
     *                        ULLMTS(2),ULLMTS(1)
            CALL SUWRNS(LP,2,NUMWRN)
         ENDIF
      IF (XLONG.LE.ULLMTS(4).AND.XLONG.GE.ULLMTS(3)) THEN
         ELSE
            WRITE (LP,15) 'LONGTITUDE',XLONG,MAPEID,
     *                        ULLMTS(3),ULLMTS(4)
            CALL SUWRNS(LP,2,NUMWRN)
         ENDIF
      CALL URELCH (XLAT,MCHAR,CHAR,2,NFILL,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,'(',1,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MCHAR,1,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
      CALL URELCH (XLONG,MCHAR,CHAR,2,NFILL,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MCHAR,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,')',1,1,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
      IF (ISTWT.EQ.2) GO TO 20
C
C  PUNCH TYPE OF STATION WEIGHTS
C  PREDETERMINED
      CALL UTOCRD (ICDPUN,NPOS,'PRE(',4,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      NSPACE=1
C
      DO 10 I=1,NPE
         IF (I.EQ.NPE) NSPACE=0
         CALL UTOCRD (ICDPUN,NPOS,STAID(1,I),8,0,CARD,3,NCHECK,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
         CALL UTOCRD (ICDPUN,NPOS,',',1,0,CARD,0,NCHECK,LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
         CALL URELCH (STAWT(I),MCHAR,CHAR,2,NFILL,IERR)
         IF (IERR.GT.0) GO TO 80
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MCHAR,NSPACE,CARD,0,NCHECK,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
10       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,')',1,1,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      GO TO 30
C
C  1/D**POWER
20    CALL UTOCRD (ICDPUN,NPOS,'DP(',3,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL URELCH (POWER,MCHAR,CHAR,2,NFILL,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,CHAR,MCHAR,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      CALL UTOCRD (ICDPUN,NPOS,')',1,1,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
C
C  PUNCH MEAN PE FOR 16TH OF EACH MONTH
30    IF (UNITS.EQ.'ENGL') GO TO 50
         NDEC=3
         DO 40 I=1,12
            VALUE(I)=PEMEAN(I)
40          CONTINUE
         GO TO 60
50    NDEC=2
      CALL UDUCNV ('MM  ','IN  ',1,12,PEMEAN,VALUE,IERR)
      IF (IERR.GT.0) GO TO 80
60    CALL UTOCRD (ICDPUN,NPOS,'(',1,0,CARD,0,NCHECK,LNUM,IERR)
      IF (IERR.GT.0) GO TO 80
      NSPACE=1
      DO 70 I=1,12
         IF (I.EQ.12) NSPACE=0
         CALL URELCH (VALUE(I),MCHAR,CHAR,NDEC,NFILL,IERR)
         CALL UTOCRD (ICDPUN,NPOS,CHAR,MCHAR,NSPACE,CARD,0,NCHECK,
     *                LNUM,IERR)
         IF (IERR.GT.0) GO TO 80
70       CONTINUE
      CALL UTOCRD (ICDPUN,NPOS,')',1,1,CARD,0,NCHECK,LNUM,IERR)
C
      CALL UPNCRD (ICDPUN,CARD)
C
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,120) MAPEID
         CALL SULINE (IOSDBG,1)
         ENDIF
      GO TO 90
C
80    ISTAT=1
C
90    IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,130)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
15    FORMAT ('0*** WARNING - ',A,' ',F11.1,' FOR AREA MAPE ',A8,' IS ',
     *        'NOT IN THE RANGE OF ',F11.1,' THROUGH ',F11.1,'.')
100   FORMAT (' *** ENTER SCMAPE')
110   FORMAT ('0PARAMETER ARRAY VERSION NUMBER = ',I2)
120   FORMAT (' *** NOTE - MAPE PARAMETERS SUCCESSFULLY ',
     *   'PUNCHED FOR AREA ',A,'.')
130   FORMAT(' *** EXIT SCMAPE')
C
      END
