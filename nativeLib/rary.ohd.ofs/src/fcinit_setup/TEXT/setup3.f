C MODULE SETUP3
C-----------------------------------------------------------------------
C
      SUBROUTINE SETUP3 (P,MP,C,MC,T,MT,TS,MTS,D,MD,NWORK,LWORK,IDT,
     1   IPASS,NXP2,LEFTP,IUSEP,NXC2,LEFTC,IUSEC,NXT,LEFT,IUSET,ISKIP,
     2   NUMOP,IERR)
C
C  THIS ROUTINE CALLS INPUT AND OPERATIONS TABLE ENTRY ROUTINES
C  FOR OPERATIONS 41-64.
C
C  ROUTINE INITIALLY WRITTEN BY ERIC ANDERSON - HRL   DECEMBER 1991
C
C  ADDED OPERATIONS 61 AND 62 - TIM SWEENEY - HRL - 4/1998
C
C  ADDED OPERATION 55 - JANICE LEWIS - HRL - 3/1999
C
C  ADDED OPERATION 64 (DISTRIBUTED HYDROLOGICAL MODELLING) - LEE CAJINA - HRL - 9/2005
C
C  PASSED ARGUMENTS:
C   NAME   I/O TYPE DESCRIPTION
C   ------ --- ---- -----------
C   P       O  REAL THE ENTIRE P ARRAY
C   MP      I  INT  DIMENSION OF THE P ARRAY
C   C       O  REAL THE ENTIRE C ARRAY
C   MC      I  INT  DIMENSION OF THE C ARRAY
C   T       O  INT  THE ENTIRE T ARRAY
C   MT      I  INT  DIMENSION OF THE T ARRAY
C   TS      I  REAL THE ENTIRE TS ARRAY
C   MTS     I  INT  DIMENSION OF THE TS ARRAY
C   D       I  REAL THE ENTIRE D ARRAY
C   MD      I  INT  DIMENSION OF THE D ARRAY
C   NWORK   I  INT  THE BEGINNING LOCATION AVAILABLE FOR WORKING SPACE
C   LWORK   O  INT  LENGTH OF WORKING SPACE NEEDED BY THE OPERATION
C   IDT     O  INT  COMPUTATIONAL TIME INTERVAL FOR THE OPERATION
C   IPASS   I  INT  0 = CALL PIN ROUTINE, 1 = CALL TAB ROUTINE
C   NXP2    I  INT  STARTING LOCATION OF PO() IN THE P ARRAY
C   LEFTP   I  INT  SPACE AVAILABLE IN THE P ARRAY
C   IUSEP   O  INT  AMOUNT OF SPACE IN P ARRAY USED BY THE OPERATION
C   NXC2    I  INT  STARTING LOCATION OF CO() IN THE C ARRAY
C   LEFTC   I  INT  SPACE AVAILABLE IN THE C ARRAY
C   IUSEC   O  INT  AMOUNT OF SPACE IN C ARRAY USED BY THE OPERATION
C   NXT     I  INT  STARTING LOCATION OF TO() IN THE T ARRAY
C   LEFT    I  INT  SPACE AVAILABLE IN THE T ARRAY
C   IUSET   O  INT  AMOUNT OF SPACE IN T ARRAY USED BY THE OPERATION
C   ISKIP   O  INT  1 = ERROR IN PIN ROUTINE, SKIP REST OF THE OPERATION
C   NUMOP   I  INT  NUMBER OF THE OPERATION TO BE SET UP
C   IERR    O  INT  = 1 IF PIN AND TAB FOR THIS OPERATION NOT INCLUDED
C
C  LOCAL VARIABLES:
C   NAME
C   ------
C   NUM     NUMBER USED IN COMPUTED GO TO STATEMENT
C   NEEDC   = 0 IF NO CARRYOVER IS BEING USED BY RSNWELEV OPERATION
C   LW      USED IN PEAKFLOW OPERATION
C   LEFTW   USED IN PEAKFLOW OPERATION
C   LS      USED IN PEAKFLOW OPERATION
C
      DIMENSION P(MP),C(MC),TS(MTS),D(MD)
      INTEGER T(MT)
C
      INCLUDE 'updaio'
      INCLUDE 'common/ionum'
      INCLUDE 'common/fdbug'
      INCLUDE 'common/fprog'
      INCLUDE 'common/fclfls'
      INCLUDE 'common/fcassm'
C
C  =================================== RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_setup/RCS/setup3.f,v $
     . $',                                                             '
     .$Id: setup3.f,v 1.17 2006/05/09 16:34:32 aivo Exp $
     . $' /
C  =====================================================================
C
C
      IF (ITRACE.GE.1) WRITE (IODBUG,*) 'ENTER SETUP3'
C
      IBUG=0
C
C  GO TO THE SECTION FOR THE CURRENT OPERATION AND CALL INPUT ROUTINE
C  IF IPASS IS 0 OR CALL OPERATIONS TABLE ENTRY ROUTINE IF IPASS IS 1
      NUM=NUMOP-40
      GO TO (41,42,43,44,45,46,47,48,49,50,
     1       51,52,53,54,55,56,57,58,59,60,
     2       61,62,63,64),NUM
      GO TO 90
C
C.......................................................................
C
C  API-HAR2 OPERATION #41 - 2ND VERSION OF THE HARRISBURG RFC API
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
41    IF (IPASS .EQ. 0) THEN
         CALL PIN41 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB41 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  RSNWELEV OPERATION #42 - RAIN-SNOW ELEVATION
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE INPUT
C  ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.  IF SPACE
C  WAS USED IN THE P ARRAY, SEE IF CARRYOVER IS NEEDED AND IF SO THEN
C  CHECK THAT SOME SPACE WAS USED IN THE C ARRAY.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
42    IF (IPASS .EQ. 0) THEN
         CALL PIN42 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF (IUSEP .LE. 0) THEN
            ISKIP = 1
            ELSE
               NEEDC = P(NXP2+11)
               IF ((NEEDC .NE. 0) .AND. (IUSEC .LE. 0)) ISKIP = 1
            ENDIF
         ELSE
         CALL TAB42 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
C
      GO TO 100
C.......................................................................
C
C  API-HFD  OPERATION #43 - HARTFORD API MODEL
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
43    IF (IPASS .EQ. 0) THEN
         CALL PIN43 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB43 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  SARROUTE OPERATION #44 - SSARR ROUTING
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
44    IF (IPASS .EQ. 0) THEN
         CALL PIN44 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB44 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  DELTA-TS OPERATION #45 - RATE OF CHANGE OF TIME SERIES
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
45    IF (IPASS .EQ. 0) THEN
         CALL PIN45 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB45 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C.......................................................................
C  NOMSNG   OPERATION #46 - NO MISSING VALUES TIME SERIES     
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
46    IF (IPASS .EQ. 0) THEN
         CALL PIN46 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB46 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  PEAKFLOW OPERATION #47 - COMPARISON OF PEAKFLOW (CALIBRATION ONLY)
C
C   FOR THE FIRST PASS THROUGH CHECK THAT THIS OPERATION IS BEING CALLED
C   BY MCP OR OPT.  THEN SET UP WATER YEAR SCRATCH FILE AND CALL THE
C   PIN ROUTINE AND CHECK THAT SOME SPACE WAS USED IN BOTH THE P AND C
C   ARRAY.  IF NOT THEN FLAG THAT THE INPUT ROUTINE HAD AN ERROR AND
C   SKIP THE REST OF THE OPERATION.
C   FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
47    IF (IPASS .EQ. 0) THEN
         IF (MAINUM .LE. 2) THEN
            ISKIP = 1
         ELSE
            CALL DEFWY
            LW = 1
C        NEED AN EQUAL AMOUNT OF SPACE IN THE D ARRAY FOR SORTING
            LEFTW = MD / 2
C        WORK ARRAY NEEDS 10 SPACES FOR EACH PEAKFLOW EVEN SO ALLOCATE
C        IN BLOCKS OF 10
            LEFTW = LEFTW / 10
            LEFTW = LEFTW * 10
            LS = LW + LEFTW
            CALL PIN47 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC,
     1                  D(LW), D(LS), LEFTW)
            IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ENDIF
         ELSE
         CALL TAB47 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, NWORK, NDD, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  MULT/DIV OPERATION #48 - MULTIPLY AND DIVIDE TIME SERIES
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
48    IF (IPASS .EQ. 0) THEN
         CALL PIN48 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
         ELSE
         CALL TAB48 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  BEGASSIM OPERATION #49 - MARK BEGINNING OF ASSIM LOOP (FORECAST ONLY)
C
C  FOR THE FIRST PASS THROUGH SET LWORKMX=0 AND INASSIM=1.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.

49    IF (IPASS .EQ. 0) THEN
         IF (MAINUM .NE. 1) THEN
            ISKIP = 1
            ELSE
               LWORKMX = 0
               INASSIM = 1
            ENDIF
         ELSE
         CALL TAB49 (T(NXT), LEFT, IUSET, NXT, LWORK)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  ASSIM    OPERATION #50 -  ASSIMILATOR (FORECAST ONLY)
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE AND SET INASSIM=0.
C
50    IF (IPASS .EQ. 0) THEN
         CALL PIN50 (P, MP, P(NXP2), LEFTP, IUSEP)
         IF (IWRPPP.GT.0) THEN
            CALL WPPPCO (IERR)
            IF (IERR.GT.0) THEN
               WRITE (IPR,110)
               CALL ERROR
               ELSE
                  WRITE (IPR,120)
               ENDIF
            CALL UCLOSL
            ENDIF
         IF (IUSEP .LE. 0) ISKIP = 1
         ELSE
         CALL TAB50 (P, MP, T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2),
     1               TS, MTS, NWORK, NDD, LWORK, IDT)
         INASSIM = 0
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  SSARRESV OPERATION #51 - SSARR RESERVOIR SIMULATION (FORECAST ONLY)
C
51    IF (IPASS .EQ. 0) THEN
         IF (MAINUM .NE. 1) THEN
            ISKIP = 1
            ELSE
            CALL PIN51 (P(NXP2), LEFTP, IUSEP, C(NXC2),LEFTC,IUSEC,D,MD)
            IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
            ENDIF
         ELSE
         CALL TAB51 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, NWORK, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  SUMPOINT OPERATION #52 - SSARR SUMMING POINT
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
52    IF (IPASS .EQ. 0) THEN
         CALL PIN52 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB52 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  LOOKUP3  OPERATION #53 - 3-VARIABLE TABLE LOOKUP
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
53    IF (IPASS .EQ. 0) THEN
         CALL PIN53 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
         ELSE
         CALL TAB53 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  SWB-NLE OPERATION #54 - NILE SIMPLE WATER BALANCE
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
54    IF (IPASS .EQ. 0) THEN
         CALL PIN54 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB54 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  FLDWAV   OPERATION #55 - GENERALIZED FLOOD WAVE ROUTING
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
55    IF (IPASS.EQ.0) THEN
         CALL PIN55 (P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC,D,MD,3)
         IF((IUSEP.LE.0).OR.(IUSEC.LE.0)) ISKIP = 1
         ELSE
         LKD=P(NXP2+72)+NXP2-1
         IF (IBUG.EQ.1) THEN 
            WRITE (UE,*) 'IN SETUP3 - NXP2=',NXP2,' LKD=',LKD
            ENDIF
         ICKVAL=0
         INDERR=0
         IF (LKD.LT.ICKVAL) THEN
            WRITE (IPR,997) 'LKD',LKD,ICKVAL
            CALL ERROR
            INDERR=1
            ENDIF
         ICKVAL=MP
         IF (LKD.GT.ICKVAL) THEN
            WRITE (IPR,998) 'LKD',LKD,ICKVAL
            CALL ERROR
            INDERR=1
            ENDIF
         IF (INDERR.EQ.0) THEN
            CALL TAB55(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,
     1                P(LKD),NWORK,NDD,LWORK,IDT,MP)
            ENDIF
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  GLACIER  OPERATION #56 - AKRFC GLACIER
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
56    IF (IPASS .EQ. 0) THEN
         CALL PIN56 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB56 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  CONS_USE OPERATION #57 - CONSUMPTIVE USE
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
57    IF (IPASS .EQ. 0) THEN
         CALL PIN57 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0) .OR. (IUSEC .LE. 0)) ISKIP = 1
         ELSE
         CALL TAB57 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  RES-J OPERATION #58 - JOINT RESERVOIR OPERATIONS
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN BOTH THE P AND C ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
C  EJM - RTi 12/02/97
C
58    IF (IPASS .EQ. 0) THEN
         CALL PIN58 (P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF (IUSEP .LE. 0) ISKIP = 1
         ELSE
         CALL TAB58 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100
C
C.......................................................................
C
C  TIDEREV  OPERATION #59 - TIDE BALANCE REVIEW
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
59    IF (IPASS .EQ. 0) THEN
         CALL PIN59 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
      ELSE
         CALL TAB59 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
      ENDIF
      GO TO 100
C
C.......................................................................
C
C  ADJUST-T OPERATION #60 - TIDE ADJUSTMENT
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
60    IF (IPASS .EQ. 0) THEN
         CALL PIN60 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
      ELSE
         CALL TAB60 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
      ENDIF
      GO TO 100
C
C.......................................................................
C
C  STAGEREV  OPERATION #61 - STAGE BALANCE REVIEW
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
61    IF (IPASS .EQ. 0) THEN
         CALL PIN61 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
      ELSE
         CALL TAB61 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), TS,
     1               MTS, LWORK, IDT)
      ENDIF
      GO TO 100
C
C.......................................................................
C
C  ADJUST-H OPERATION #62 - STAGE ADJUSTMENT
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
62    IF (IPASS .EQ. 0) THEN
         CALL PIN62 (P(NXP2), LEFTP, IUSEP)
         IF (IUSEP .LE. 0) ISKIP = 1
         ELSE
         CALL TAB62 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), TS,
     1               MTS, LWORK, IDT)
         ENDIF
      GO TO 100

C.......................................................................
C  SET-TS OPERATION #63 - SET TIME SERIES TO SPECIFIED VALUE
C
C  FOR THE FIRST PASS THROUGH CALL THE PIN ROUTINE AND CHECK THAT SOME
C  SPACE WAS USED IN THE P ARRAY.  IF NOT THEN FLAG THAT THE
C  INPUT ROUTINE HAD AN ERROR AND SKIP THE REST OF THE OPERATION.
C  FOR THE SECOND PASS THROUGH CALL THE TAB ROUTINE.
C
63    IF (IPASS .EQ. 0) THEN
         CALL PIN63 (P(NXP2), LEFTP, IUSEP, TS, MTS)
         IF (IUSEP .LE. 0) ISKIP = 1
      ELSE
         CALL TAB63 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), TS,
     1               MTS, LWORK, IDT)
      ENDIF
      GO TO 100

C.......................................................................
C
C.......................................................................
C  DHM-OP OPERATION #64 - DISTRIBUTED HYDROLOGICAL MODELLING
C
C
64    IF (IPASS .EQ. 0) THEN
         CALL PIN64(P(NXP2), LEFTP, IUSEP, C(NXC2), LEFTC, IUSEC)
         IF ((IUSEP .LE. 0).OR.(IUSEC .LE. 0))ISKIP = 1
      ELSE
         CALL TAB64 (T(NXT), LEFT, IUSET, NXT, NXP2, P(NXP2), NXC2, TS,
     1               MTS, LWORK, IDT)
      ENDIF
      GO TO 100

C.......................................................................

C  OPERATION NOT FOUND
90    WRITE (IPR,130) NUMOP
      CALL ERROR
      IERR=1
C
100   IF (ITRACE.GE.1) WRITE (IODBUG,*) 'ENTER SETUP3'
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
110   FORMAT ('0**ERROR** WRITING PREPROCESSOR PARAMETRIC ',
     *   'DATA BASE CONTROL RECORDS.')
120   FORMAT ('0**NOTE** PREPROCESOR PARAMETRIC ',
     *   'DATA BASE CONTROL RECORDS ',
     *   'SUCCESSFULLY WRITTEN.')
130   FORMAT ('0**ERROR** OPERATION NUMBER ',I3,' NOT FOUND.')
997   FORMAT ('0**ERROR** IN SETUP3 - VALUE OF VARIABLE ',A,' (',I10,
     *   ') IS LESS THAN ',I6,'.')
998   FORMAT ('0**ERROR** IN SETUP3 - VALUE OF VARIABLE ',A,' (',I10,
     *   ') IS GREATER THAN ',I6,'.')
C
      END
