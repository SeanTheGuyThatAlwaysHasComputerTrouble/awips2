C MEMBER SETUP1
C  (from old member FCSETUP1)
C
      SUBROUTINE SETUP1(P,MP,C,MC,T,MT,TS,MTS,D,MD,NWORK,LWORK,IDT,
C                             LAST UPDATE: 02/08/94.09:17:20 BY $WC20SV
C
     1  IPASS,NXP2,LEFTP,IUSEP,NXC2,LEFTC,IUSEC,NXT,LEFT,IUSET,ISKIP,
     2  NEXTP,NXP,NEXTC,NXC,NUMOP,IERR)
C.......................................
C     SETUP1 CALLS INPUT AND OPERATIONS TABLE ENTRY SUBROUTINES
C        FOR OPERATIONS 1-19.
C.......................................
C     SUBROUTINE INITIALLY WRITTEN BY...
C        ERIC ANDERSON - HRL   MARCH 1980
C.......................................
      DIMENSION P(MP),C(MC),TS(MTS),D(MD)
      INTEGER T(MT)
C
C     COMMON BLOCKS.
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/FPROG/MAINUM,VERS,VDATE(2),PNAME(5),NDD
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_setup/RCS/setup1.f,v $
     . $',                                                             '
     .$Id: setup1.f,v 1.1 1995/09/17 18:48:57 dws Exp $
     . $' /
C    ===================================================================
C
C.......................................
C     TRACE LEVEL FOR THIS SUBROUTINE=1.
      IF(ITRACE.GE.1) WRITE(IODBUG,900)
  900 FORMAT(1H0,17H** SETUP1 ENTERED)
C.......................................
C     GO TO THE SECTION FOR THE CURRENT OPERATION.
      GO TO (200,205,210,215,220,225,230,235,240,245,250,255,260,265,
     1270,275,280,285,290),NUMOP
C.......................................
C     SACRAMENTO SOIL-MOISTURE ACCOUNTING OPERATION - USED FOR ALL
C        APPLICATIONS - REQUIRES NO WORKING SPACE.
  200 IF (IPASS.EQ.1) GO TO 201
      CALL PIN1(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF ((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  201 CALL TAB1(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS)
      IDT=P(NXP2+1)
      LWORK=0
      GO TO 125
C.......................................
C     UNIT HYDROGRAPH OPERATION -- ALL APPLICATIONS -- REQUIRES WORKING
C SPACE.
  205 IF (IPASS.EQ.1) GO TO 208
      CALL PIN2(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF (IUSEP.GT.0) GO TO 206
  207 ISKIP=1
      GO TO 125
  206 NEEDC=P(NXP2+20)
      IF (NEEDC.EQ.0) GO TO 125
      IF (IUSEC.GT.0) GO TO 125
      GO TO 207
  208 CALL TAB2(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1NDD,LWORK)
      IDT=P(NXP2+15)
      GO TO 125
C.......................................
C     REDUCED ORDINATE UHG OPERATION - ALL APPLICATIONS.
  210 IF(IPASS.EQ.1) GO TO 211
      CALL PIN3(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC,D,MD)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  211 CALL TAB3(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1LWORK,IDT)
      GO TO 125
C.......................................
C     CLEAR TIME SERIES OPERATION -- ALL APPLICATIONS -- T ARRAY ONLY.
  215 CALL PIN4(T(NXT),LEFT,IUSET,NXT,TS,MTS)
      IF (IUSET.GT.0) GO TO 216
      ISKIP=1
      GO TO 125
  216 IDT=0
      LWORK=0
      NEXTP=NXP
      NEXTC=NXC
      IPASS=1
      GO TO 125
C.......................................
C     DAILY FLOW PLOT (SAC-PLOT) OPERATION--CALIBRATION ONLY--NEEDS
C        WORKING SPACE.
  220 IF (IPASS.EQ.1) GO TO 222
      IF (MAINUM.GT.2) GO TO 221
      ISKIP=1
      GO TO 125
  221 CALL PIN5(P(NXP2),LEFTP,IUSEP,P,MP)
      IF (IUSEP.GT.0) GO TO 125
      ISKIP=1
      GO TO 125
  222 CALL TAB5(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),TS,MTS,P,MP,NWORK,
     1LWORK)
      IF (IUSET.GT.0) GO TO 223
      IDT=0
      GO TO 125
  223 IDT=T(NXT+3)
      GO TO 125
C.......................................
C     MEAN DISCHARGE (MEAN-Q) OPERATION--ALL APPLICATIONS
  225 IF(IPASS.EQ.1) GO TO 226
      CALL PIN6(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF ((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  226 CALL TAB6(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS)
      IDT=P(NXP2+4)
      LWORK=0
      GO TO 125
C.......................................
C     LAG AND K OPERATION--ALL APPLICATIONS--WORKING SPACE NEEDED.
  230 IF(IPASS.EQ.1) GO TO 231
      CALL PIN7(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  231 CALL TAB7(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,C(NXC2),TS,MTS,
     1   NWORK,NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     CHANNEL LOSS OPERATION--ALL APPLICATIONS--NO CARRYOVER.
  235 IF(IPASS.EQ.1) GO TO 238
      CALL PIN8(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF(IUSEP.GT.0) GO TO 236
  237 ISKIP=1
      GO TO 125
  236 WSAREA=P(NXP2+10)
      IF (WSAREA.EQ.0.0) GO TO 125
      NEEDC=P(NXP2+11)
      IF (NEEDC.EQ.0) GO TO 125
      IF (IUSEC.GT.0) GO TO 125
      GO TO 237
  238 CALL TAB8(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,IDT)
      LWORK=0
      GO TO 125
C.......................................
C     MUSKINGUM ROUTING--ALL APPLICATIONS--NEEDS WORKING SPACE
  240 IF(IPASS.EQ.1) GO TO 241
      CALL PIN9(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  241 CALL TAB9(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1   NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     ADD/SUBTRACT OPERATION--ALL APPLICATIONS--MAY NEED WORKING SPACE
  245 IF(IPASS.EQ.1) GO TO 248
      CALL PIN10(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF(IUSEP.GT.0) GO TO 246
  247 ISKIP=1
      GO TO 125
  246 NEEDC=P(NXP2+10)
      IF(NEEDC.EQ.0) GO TO 125
      IF(IUSEC.GT.0) GO TO 125
      GO TO 247
  248 CALL TAB10(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1   NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     LAYERED COEFFICIENT ROUTING--ALL APPLICATIONS--NEEDS WORKING SPACE
  250 IF(IPASS.EQ.1) GO TO 251
      CALL PIN11(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  251 CALL TAB11(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1   NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     INSTANTANEOUS DISCHARGE PLOTTING OPERATION-ALL APPLICATIONS-
C          NO CARRYOVER - NEEDS WORKING SPACE
  255 IF(IPASS.EQ.1) GO TO 256
      CALL PIN12(P(NXP2),LEFTP,IUSEP)
      IF(IUSEP.GT.0) GO TO 125
      ISKIP=1
      GO TO 125
  256 CALL TAB12(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),TS,MTS,NWORK,NDD,
     1LWORK,IDT)
      GO TO 125
C.......................................
C     TATUM ROUTING--ALL APPLICATIONS--NEEDS WORKING SPACE
  260 IF(IPASS.EQ.1) GO TO 263
      CALL PIN13(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC,NEEDC)
      IF (IUSEP.GT.0) GO TO 261
  262 ISKIP=1
      GO TO 125
  261 IF (NEEDC.EQ.0) GO TO 125
      IF (IUSEC.GT.0) GO TO 125
      GO TO 262
  263 CALL TAB13(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1   NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     ADJUST SIM. Q OPERATION--ALL APPLICATIONS.
  265 IF (IPASS.EQ.1) GO TO 266
      CALL PIN14(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF ((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  266 CALL TAB14(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,
     1 NWORK,NDD,LWORK,IDT)
      GO TO 125
C.......................................
C     WEIGHT TIME SERIES--ALL APPLICATIONS--NO CARRYOVER
  270 IF(IPASS.EQ.1) GO TO 271
      CALL PIN15(P(NXP2),LEFTP,IUSEP,P,MP)
      IF(IUSEP.GT.0) GO TO 125
      ISKIP=1
      GO TO 125
  271 CALL TAB15(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),TS,MTS,LWORK,IDT)
      GO TO 125
C.......................................
C      DAILY DISCHARGE STATISTICS OPERATION--CALIBRATION ONLY
  275 IF(IPASS.EQ.1) GO TO 278
      IF(MAINUM.LT.3) GO TO 276
      IF(MD.GT.372) GO TO 277
      WRITE(IPR,901)
  901 FORMAT(1H0,10X,98H**WARNING** THE D ARRAY IS TOO SMALL TO SET UP T
     1HE 'STAT-QME' OPERATION--THE OPERATION IS SKIPPED.)
      CALL WARN
  276 ISKIP=1
      GO TO 125
  277 CALL DEFWY
      LEFTW=MD-372
      CALL PIN16(P(NXP2),LEFTP,IUSEP,D(373),LEFTW,D(1))
      IF(IUSEP.GT.0) GO TO 125
      ISKIP=1
      GO TO 125
  278 CALL TAB16(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),TS,MTS,NWORK,LWORK,
     1IDT)
      GO TO 125
C.......................................
C     WATER YEAR PLOT OPERATION--CALIBRATION ONLY--WORKING SPACE
  280 IF(IPASS.EQ.1) GO TO 282
      IF(MAINUM.GT.2) GO TO 281
      ISKIP=1
      GO TO 125
  281 CALL DEFWY
      CALL PIN17(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  282 CALL TAB17(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,
     1   NWORK,LWORK,IDT)
      GO TO 125
C.......................................
C     PLOT TIME SERIES OPERATION--NO CARRYOVER--WORKING SPACE
  285 IF(IPASS.EQ.1) GO TO 287
      CALL PIN18(P(NXP2),LEFTP,IUSEP)
      IF(IUSEP.GT.0) GO TO 286
      ISKIP=1
      GO TO 125
  286 NOPT=P(NXP2+6)
      IF(NOPT.EQ.1) CALL DEFWY
      GO TO 125
  287 CALL TAB18(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),TS,MTS,NWORK,LWORK,
     1IDT)
      GO TO 125
C.......................................
C     SNOW MODEL OPERATION-ALL APPLICATIONS--WORKING SPACE
  290 IF(IPASS.EQ.1) GO TO 291
      CALL PIN19(P(NXP2),LEFTP,IUSEP,C(NXC2),LEFTC,IUSEC)
      IF((IUSEP.GT.0).AND.(IUSEC.GT.0)) GO TO 125
      ISKIP=1
      GO TO 125
  291 CALL TAB19(T(NXT),LEFT,IUSET,NXT,NXP2,P(NXP2),NXC2,TS,MTS,NWORK,
     1  LWORK,IDT)
      GO TO 125
C.......................................
C     OPERATION NOT INCLUDED.
CCC80 IERR=1
C.......................................
  125 CONTINUE
      RETURN
      END
