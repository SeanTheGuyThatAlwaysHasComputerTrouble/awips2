C MEMBER PRDCTT
C  (from old member PRDDEFTS)
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 03/17/95.11:58:32 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE PRDCTT (ITSID,ITYPE,ITSTEP,IUNIT,NVAL,RLOCT,ITSIDF,
     *   INFO,NX,XBUF,LWKBUF,IWKBUF,IFUT,ISTAT)
C
C THIS ROUTINE CALLS THE CHANGE TIME SERIES HEADER ROUTINE AFTER IT
C CHECKS THAT THE USER IS NOT CHANGING DATA TIME INTERVAL OR NVALS WHICH
C CANNOT BE CHANGED.  PRDCTF DOES THE SAME FOR FUTURE TIME SERIES.
C
      DIMENSION IWKBUF(LWKBUF)
      DIMENSION ITSID(2),ITSIDF(2),INFO(5),XBUF(1),RLOCT(2)
C
      INCLUDE 'uio'
      INCLUDE 'udebug'
      INCLUDE 'udatas'
      INCLUDE 'prdcommon/pdftbl'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/prdutil/RCS/prdctt.f,v $
     . $',                                                             '
     .$Id: prdctt.f,v 1.1 1995/09/17 19:16:41 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (IPRTR.GT.0) WRITE (IOGDB,10)
10    FORMAT (' *** ENTER PRDCTT')
C
      ISTAT=0
      IXTYPE=ITYPE
C
C  CHECK IF FUTURE TIME SERIES
      IF (IFUT.EQ.0) GO TO 30
C
C GET THE FUTURE DATA TYPE
      CALL PFFTYP (ITYPE,IXTYPE,IX1,IX2)
      IF (IX1.NE.0.AND.IX2.NE.0) GO TO 30
      WRITE (LP,20) IXTYPE
20    FORMAT ('0**ERROR** ',A4,' IS AN INVALID DATA TYPE.')
      GO TO 150
C
C  GET THE TIME SERIES
30    CALL PGETTS (ITSID,IXTYPE,LWKBUF,IWKBUF,IREC,ISTAT)
      IF (ISTAT.NE.0) GO TO 110
C
C  CHECK CHANGES FOR DATA TIME INTERVAL OR NVAL
      IF (IWKBUF(2).EQ.ITSTEP) GO TO 50
      WRITE (LP,40) IWKBUF(2)
40    FORMAT (' **WARNING** TIME STEP OF',I6,' CANNOT BE CHANGED')
50    IF (IWKBUF(3).EQ.NVAL.OR.NVAL.EQ.0) GO TO 70
      WRITE (LP,60) IWKBUF(3)
60    FORMAT (' **WARNING** NUMBER OF VALUES',I6,' CANNOT BE CHANGED')
C
C NOW DO THE CHANGE
70    IF (IFUT.EQ.0) CALL WPRDC (ITSID,ITYPE,IUNIT,RLOCT,INFO,ITSIDF,
     *   NX,XBUF,LWKBUF,IWKBUF,IREC,ISTAT)
      IF (IFUT.EQ.1) CALL WPRDCF (ITSID,ITYPE,IUNIT,RLOCT,INFO,
     *   NX,XBUF,LWKBUF,IWKBUF,IREC,ISTAT)
      IF (ISTAT.NE.0) GO TO 90
      WRITE (LP,80) ITSID,IXTYPE
80    FORMAT (' **NOTE** TIME SERIES FOR ID ',2A4,' AND TYPE ',A4,
     *   ' SUCCESSFULLY CHANGED.')
C
C  PRINT CHANGES
      CALL PFDTYP (IXTYPE,IX)
      KEY=0
      CALL PTSHCS (1,DATFIL(7,IX),KEYS)
      IUNITS=IBLNK
      IFORM=2
      IFLAG=0
      CALL PTSREC (ITSID,IXTYPE,IUNITS,IFREC,
     *   IFLAG,IFORM,KEY,
     *   LWKBUF,IWKBUF,NDCNOW,ISTAT)
      GO TO 150
C
90    WRITE (LP,100) ITSID,IXTYPE
100   FORMAT ('0**ERROR** TIME SERIES FOR ID ',2A4,' AND TYPE ',A4,
     *   ' NOT SUCCESSFULLY CHANGED.')
      GO TO 150
C
C  CANNOT FIND TS
110   WRITE (LP,120) ITSID,IXTYPE
120   FORMAT (' **NOTE** TIME SERIES FOR ID ',2A4,' AND TYPE ',A4,
     *   ' DOES NOT EXIST AND WILL BE CREATED')
      IF (NX.EQ.-1) NX=0
      IF (IFUT.EQ.0) CALL WPRDH (ITSID,ITYPE,ITSTEP,IUNIT,NVAL,RLOCT,
     *   ITSIDF,INFO,NX,XBUF,LWKBUF,IWKBUF,IREC,ISTAT)
      IF (IFUT.EQ.1) CALL WPRDFH (ITSID,ITYPE,ITSTEP,IUNIT,NVAL,RLOCT,
     *   INFO,NX,XBUF,LWKBUF,IWKBUF,IREC,ISTAT)
      IF (ISTAT.EQ.0) WRITE (LP,130) ITSID,IXTYPE
130   FORMAT (' **NOTE** TIME SERIES FOR ID ',2A4,' AND TYPE ',A4,
     *   ' SUCCESSFULLY CREATED.')
      IF (ISTAT.NE.0) WRITE (LP,140) ITSID,IXTYPE
140   FORMAT ('0**ERROR** TIME SERIES FOR ID ',2A4,' AND TYPE ',A4,
     *   ' NOT SUCCESSFULLY CREATED.')
150   IF (IPRTR.GT.0) WRITE (IOGDB,160) ISTAT
160   FORMAT (' *** EXIT PRDCTT - STATUS CODE=',I5)
C
      RETURN
C
      END
