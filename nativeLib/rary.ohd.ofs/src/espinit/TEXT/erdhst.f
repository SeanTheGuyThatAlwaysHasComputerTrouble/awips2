C MEMBER ERDHST
C  (from old member EERDHST)
C
      SUBROUTINE ERDHST(TSESP,FILIN,
     * NXRLOC,STAID,IPTR,DESCR,ITIM,DTYPES,DIMS,UNITS,
     * IMOQ,IYRQ,LMOQ,LYRQ,MXQ,IFQTS,LTS,IER)
C
cew this subroutine is no longer an option
C .................................................................
C
C           HISTORICAL FILE CREATION SUBROUTINE
C
C THIS SUBROUTINE CREATES HISTORICAL FILES FROM INPUT TIME
C SERIES FOR ESP.
C HISTORICAL FILES HAVE MULTIPLE TIME SERIES IN ONE LOCATION.
C FOR A GIVEN MONTH, THE TS DATA FOLLOW EACH OTHER SEQUENTIALLY.
C
C THE HEART OF THIS ROUTINE IS USE OF THE READ WRITE FILE ROUTINES
C DOCUMENTED IN NWSRFS USERS MANUAL CHAP VII.7.2 AND WRITE ONE
C MONTH OF DATA AT A TIME FOR EACH TIME SERIES.
C
C ORIGINALLY BY: ED VANBLARGAN - HRL - AUG., 1981
C MODIFIED SEP 84 - TO SORT THE TIME SERIES ACCORDING TO LOCATION IN
C                   TSESP SO EXECUTION PROGRAM WOULD BE MORE EFFICIENT
C .................................................................
C
C VARIABLES USED (NOT IN COMMON BLKS OR READILY KNOWN)
C    (TS IS ABBREV. FOR TIME SERIES)
C
C MXTS  = MAX NUMBER OF TS
C NDV   = NUMBER OF DATA VALUES PER MONTH, MAX FOR EACH TS
C MINDT = MINIMUM DELTA T ALLOWED FOR ANY TIME SERIES. IT IS
C         CALCULATED AS 24/(NDV/31)
C TSID  = I.D. FOR TS (2A4)
C DTYP  = DATA TYPE FOR TS (A4)
C IDT   = TIME INTERVAL FOR TS
C NTS   = NUMBER OF TIME SERIES
C FILOUT= NAME OF OUTPUT FILE (3A4)
C FILIN = FILENAME CONTAINING TS (3A4)
C STAID = STATION I.D. (3A4) ARRAY
C DTYPES= DATA TYPE (A4) ARRAY
C ITIM  = TIME INTERVAL ARRAY
C DESCR = DESCRIPTOR INFO (5A4) ARRAY. (USUALLY BLANK)
C NXRLOC= NEXT READ LOCATION ARRAYC
C IPTR  = POINTER ARRAY FOR THE TS POSITIONS
C IMO   = INITIAL MONTH
C IYR   = INITIAL YEAR
C LMO   = LAST MONTH
C LYR   = LAST YEAR
C IMOQ  = INITIAL MONTH ARRAY FOR QME TIME SERIES
C IYRQ  = INITIAL YEAR  ARRAY FOR QME TIME SERIES
C LMOQ  = LAST   MONTH  ARRAY FOR QME TIME SERIES
C LYRQ  = LAST   YEAR   ARRAY FOR QME TIME SERIES
C NQTS  = NUMBER OF QME TS
C QTYPES= ARRAY CONTAINING FLOW DATA TYPES
C NQDT  = NUMBER OF FLOW DATA TYPES
C IPUN  = PUNCH INDICATOR FOR TS HEADER (1=YES)
C IFQTS = ARRAY INDICATING WHICH TS ARE OBSERVED Q (=1)
C LTS   = ARRAY TO KEEP TRACK OF LOCATION IN TSESP ARRAY OF EACH TS
C
C
      INTEGER CMONTH,CDAY,CYEAR,CHRMN,CSCNDS
C
      DIMENSION SBNAME(2),OLDOPN(2),TSID(2),FILIN(3,1),FILOUT(3),
     * NXRLOC(1),STAID(3,1),IPTR(1),DESCR(5,1),ITIM(1),
     * DTYPES(1),DIMS(1),UNITS(1),TSESP(1),
     * IMOQ(1),IYRQ(1),LMOQ(1),LYRQ(1),QTYPES(8),IFQTS(1),LTS(1)
C
      INCLUDE 'common/ionum'
      INCLUDE 'common/fdbug'
      INCLUDE 'common/where'
      INCLUDE 'clbcommon/crwctl'
      INCLUDE 'common/edata'
      COMMON/BHTIME/IBHREC,CMONTH,CDAY,CYEAR,CHRMN,CSCNDS,LSTHDR
      COMMON/CDEBUG/IND,IRWBUG,JDEBUG,KDEBUG,LDEBUG
C
      DATA NAME,SBNAME,SAME/4HEINI,4HERDH,4HST  ,4HSAME/
      DATA CALB,MXED,BLANK/4HCALB,4HMXED,4H    /,REPL/4HREPL/
      DATA JP,IYES/4H NO ,4H YES/,END/2HEN/
      DATA QTYPES/4HQME ,4HQINE,4HQIN ,4HRQME,4HRQOT,4HDQME,
     * 4HDQIN,4HDQIE/
      DATA GENR,BLEN/4HGENR,4HBLEN/
      CHARACTER*3 TEMP
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/espinit/RCS/erdhst.f,v $
     . $',                                                             '
     .$Id: erdhst.f,v 1.1 1995/09/17 18:46:38 dws Exp $
     . $' /
C    ===================================================================
C

C
C
C PUT ERROR TRACES FOR THIS ROUTINE IN COMMON BLK/WHERE/
C
      IOLDOP=IOPNUM
      IOPNUM=0
      DO 10 I=1,2
        OLDOPN(I)=OPNAME(I)
        OPNAME(I)=SBNAME(I)
10    CONTINUE
C
C FILL UNITS ARRAY WITH 'SAME' AND DESCR ARRAY WITH BLANKS.
C
C GET TRACE LEVEL AND DEBUG
C
      IF (ITRACE.GE.1) WRITE(IODBUG,50)
50    FORMAT(1H0,14HERDHST ENTERED)
C
cew read the input for histfile and give arning messages
60    READ(IN,*) TEMP
      IF(TEMP.EQ.'END') GO TO 100
      GO TO 60
C ....................................................................
cew write message to indicate that histfile no longer
cew no longer an option
100   WRITE(IPR,*) "**WARNING** HISTFILE NOT A WORKSTATION OPTION"
      WRITE(IPR,*) "**Remove the HISTFILE command from your workstation
     *input deck.**"
C
C CHANGE ERROR TRACES BACK THE WAY THEY WERE
C
999   IOPNUM=IOLDOP
      OPNAME(1)=OLDOPN(1)
      OPNAME(2)=OLDOPN(2)
C
      RETURN
      END
