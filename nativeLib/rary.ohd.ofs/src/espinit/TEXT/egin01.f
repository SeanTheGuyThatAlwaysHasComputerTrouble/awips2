C MODULE EGIN01
C-----------------------------------------------------------------------
C
      SUBROUTINE EGIN01(TTS,MTTS,ILOC,NUSE,GTYPE,IERR)
C
C ......................................................................
C
C          GENERATE PE FOR INITIALIZATTION PROGRAM SUBROUTINE
C
C THIS PROGRAM IS PART OF ESP INTIALIZATION.
C IT WILL READ INFORMATION AND STORE IT IN THE TTS ARRAY (TO BE LATER
C STORED IN TSESP BY CALLING ROUTINE).
C
C THE INFO READ IS BASICALLY 12 DAILY PE VALUES(1 FOR EACH MONTH
C ASSIGNED TO FALL ON THE 16TH OF THE MONTH).
C
C THE INFO STORED IN THE PE ARRAY IS NECESSARY AT EXECUTION TIME FOR
C GENERATING DAILY PE VALUES. IT IS STORED IN THE EXTERNAL LOCATION
C INFORMATION ELEMENTS OF TSESP. THE ASSOCIATED TIME SERIES INFO
C HAS ALREADY BEEN DEFINED BY THE CALLING PROGRAM.
C
C
C ROUTINE ORIGINALLY BY : ED VANBLARGAN - HRL 10/1981
C
C ......................................................................
C
      CHARACTER*80 CARD
C
      DIMENSION TTS(1),GTYPE(2),SBNAME(2),OLDOPN(2)
C
      INCLUDE 'common/fdbug'
      INCLUDE 'common/ionum'
      INCLUDE 'common/where'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/espinit/RCS/egin01.f,v $
     . $',                                                             '
     .$Id: egin01.f,v 1.2 2002/02/11 19:54:26 dws Exp $
     . $' /
C    ===================================================================
C
      DATA NAME,SBNAME/4HEINP,4HEGIN,4H01  /
C
C
C SET UP ERROR TRACE FOR THIS SUBROUTINE IN COMMON BLK/WHERE/
C
      IOLDOP=IOPNUM
      IOPNUM=0
      DO 10 I=1,2
        OLDOPN(I)=OPNAME(I)
        OPNAME(I)=SBNAME(I)
10    CONTINUE
C
C GET TRACE LEVEL AND DEBUG
C
      IF (ITRACE.GE.1) WRITE(IODBUG,50)
50    FORMAT(1H0,14HEGIN01 ENTERED)
      IBUG=IFBUG(NAME)
C
C SET VARIABLES. NUSE=NUMBER OF VALUES OF EXTERNAL INFO LOCATIONS USED.
C
      IERR=0
      NUSE=14
C
C CHECK THAT THERE IS ROOM IN TTS ARRAY.
C
      IF ((ILOC+NUSE-1).LE.MTTS) GO TO 200
C
      WRITE(IPR,100) MTTS
100   FORMAT(1H0,10X,30H**ERROR** NO ROOM IN TTS ARRAY,
     * 45H TO PUT THE GENERATE PE INFORMATION. MAX TTS=,I5)
      IERR=1
      CALL ERROR
      GO TO 999
C
C PUT GENERATE TYPE INFO INTO TTS ARRAY
C
200   TTS(ILOC)=GTYPE(1)
      TTS(ILOC+1)=GTYPE(2)
      TTS(ILOC-1)=NUSE
C
C READ INPUT.  12 DAILY PE VALUES ASSOCIATED WITH 16TH DAY
C OF EACH MONTH.
C
      READ (IN,'(A)') CARD
      READ (CARD,300,ERR=301) (TTS(I+ILOC+1),I=1,12)
300   FORMAT(12F5.0)
      GO TO 302
301   CALL FRDERR (IPR,'DAILY PE',CARD)
C
C .............DEBUG TIME .....................................
C
302   IF (IBUG.EQ.0) GO TO 999
C
      WRITE(IODBUG,900) (TTS(I+ILOC-1),I=1,NUSE)
900   FORMAT(1H0,40HINFORMATION STORED FOR PE GENERATION IS:
     * /1X,2A4,1X,12(F4.1,1X))
C
      WRITE(IODBUG,910) ILOC,NUSE,GTYPE
910   FORMAT(1H0,20HILOC, NUSE, GTYPE = ,I5,1X,I3,1X,2A4)
C
C .............................................................
C
C
C SET ERROR TRACE IN CB/WHERE/ BACK THE WAY THEY WERE
C
999   IOPNUM=IOLDOP
      OPNAME(1)=OLDOPN(1)
      OPNAME(2)=OLDOPN(2)
C
      RETURN
      END
