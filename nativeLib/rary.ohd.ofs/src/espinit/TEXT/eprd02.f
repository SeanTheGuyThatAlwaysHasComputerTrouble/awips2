C MEMBER EPRD02
C  (from old member EEPRD02)
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 06/08/94.08:40:08 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE EPRD02 (DSP,LPESP)
C
C ......................................................................
C
C        PRINT DISPLAY 2 INFO
C
C THIS ROUTINE PRINTS DISPLAY INFORMATION STORED IN THE DSP PORTION
C    OF THE DSP ARRAY. IT IS IS ONE OF THE PRINT DISPLAY ROUTINES
C    AND PRINTS INFO ABOUT THE 2ND DISPLAY TYPE : FREQUENCY.
C
C THIS ROUTINE IS PART OF THE ESP INITILIZATION PROGRAM
C   AND PRINT SEGMENT ROUTINE, AND MORE SPECIFICALLY
C   THE PRINT P ARRAY ROUTINE (EPRP).
C
C
C   ORIGINALLY WRITTEN BY
C     ED VANBLARGAN - HRL -NOV,1981
C
C
C .....................................................................
C
C
C VARIABLES:
C NV    - TOTAL NUMBER OF VALUES IN DSP ARRAY
C INUM  - NUMBER OF FREQ VALUES (IF IDFLT=1)
C IDIST - FITTED DISTRIBUTION NUMBER
C           1=EMPIRICAL   2=LOG NORMAL
C           3=NORMAL, NO SAMPLE
C IPLT  - PLOT SWITCH (O=NO PLOT    1=YES PLOT)
C ISAMP - SWITCH TO INCLUDE SAMPLE PTS IN PLOT (1=YES, 0=NO)
C ISUM  - "END OF RUN" SUMMARY TABLE SWITCH
C           0=NO TABLE    1=YES
C DSP   - ARRAY WHICH IS DISPLAY PORTION OF PESP ARRAY
C
C
C STRUCTURE OF DSP ARRAY FOR DISPLAY NUMBER 2 :
C LOCATION      VARIABLE   DESCRIPTION
C ********      ********   ***********
C    1             -       DISPLAY NUMBER=2
C    2            NV       NUMBER OF VALUES IN DSP ARRAY
C    3           IDIST     DISTRIBUTION TYPE
C    4           INUM      NUMBER OF FREQ VALUES
C 5 TO INUM+4      -       FREQ VALUES
C  INUM+5        IPLT      PLOT SWITCH
C  INUM+6        ISAMP     SAMPLE SWITCH     "    "   "   "   "
C INUM+7 TO INUM+11        SWITCH FOR TS TYPES    "   "   "   "
C INUM+6      (FOR IPLT=0) SUMMARY TABLE SWITCH (ISUM)
C INUM+12     (FOR IPLT=1)
C
C
C .....................................................................
C
C
C
      DIMENSION DSP(*),NOYES(2),SBNAME(2),OLDOPN(2),ITYP(5)
C
      INCLUDE 'common/ionum'
      INCLUDE 'common/fdbug'
      INCLUDE 'common/where'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/espinit/RCS/eprd02.f,v $
     . $',                                                             '
     .$Id: eprd02.f,v 1.1 1995/09/17 18:46:27 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA NAME,SBNAME/4HEPRT,4HEPRD,4H02  /
      DATA NOYES/4H  NO,4H YES/
C
C SET ERROR TRACES
C
      IOLDOP=IOPNUM
      IOPNUM=0
      DO 10 I=1,2
      OLDOPN(I)=OPNAME(I)
10    OPNAME(I)=SBNAME(I)
C
C GET TRACE LEVEL AND DEBUG
C
      IF (ITRACE.GE.1) WRITE(IODBUG,50)
50    FORMAT(1H0,14HEPRD02 ENTERED)
      IBUG=IFBUG(NAME)
C
C PRINT HEADER
C
      WRITE(IPR,60)
60    FORMAT(// 21X,24HDISPLAY TYPE : FREQUENCY
     * // 36X,32HOPTIONS DESIRED ARE AS FOLLOWS :)
C
C PRINT DISTRIBUTION TYPE
C
      NV=DSP(2)
      IDIST=DSP(3)
      GO TO(110,120,130),IDIST
      WRITE(IPR,105) IDIST
105   FORMAT(/ 11X,38H**ERROR** INVALID DISTRIBUTION TYPE OF ,I4,
     * ' IMPOSSIBLE GOTO.')
      CALL ERROR
      GO TO 900
C
110   WRITE(IPR,115)
115   FORMAT(/ 36X,30HTYPE OF FITTED DISTRIBUTION : ,9HEMPIRICAL)
      GO TO 200
C
120   WRITE(IPR,125)
125   FORMAT(/ 36X,30HTYPE OF FITTED DISTRIBUTION : ,10HLOG-NORMAL)
      GO TO 200
C
130   WRITE(IPR,135)
135   FORMAT(/ 36X,30HTYPE OF FITTED DISTRIBUTION : ,6HNORMAL)
C
C PRINT OUT FREQUENCY VALUES
C
200   INUM=DSP(4)
      WRITE(IPR,250) INUM,(DSP(I+4),I=1,INUM)
250   FORMAT(/ 36X,I3,31H PROBABILITY LEVELS REQUESTED : ,10F5.2)
C
C SEE IF PLOT IS DESIRED. IF SO, PRINT OUT PLOT OPTIONS
C
      IPLT=DSP(5+INUM)
      WRITE(IPR,300) NOYES(IPLT+1)
300   FORMAT(/ 36X,17HIS PLOT DESIRED ?,A4)
C
      IF (IPLT.EQ.0) GO TO 400
C
C PLOT OPTIONS FOLLOW
C
      ISAMP=DSP(INUM+6)
      WRITE(IPR,350) NOYES(ISAMP+1)
350   FORMAT(/ 36X,25HINCLUDE SAMPLES ON PLOT ?,A4)
      DO 355 I=1,5
      II=DSP(INUM+6+I)
      ITYP(I)=NOYES(II+1)
  355 CONTINUE
      WRITE(IPR,360) ITYP
  360 FORMAT(36X,31HTYPES OF TIME SERIES FOR PLOT :
     1 / 41X,46H         HISTORICAL    ADJUSTED    CONDITIONAL,
     2 27H    OBSERVED    BASE PERIOD
     3 / 52X,A4,9X,A4,10X,A4,9X,A4,9X,A4)
C
C PRINT OUT IF END OF RUN SUMMARY TABLE IS DESIRED
C
400   ISUM=DSP(INUM+6)
      IF (IPLT.GE.1) ISUM=DSP(INUM+12)
      WRITE(IPR,450) NOYES(ISUM+1)
450   FORMAT(/ 36X,24HINCLUDE IN RUN SUMMARY ?,A4)
C
C ...........DEBUG TIME.................................................
C
900   IF (IBUG.EQ.0) GO TO 999
C
      WRITE(IODBUG,910) (DSP(I),I=1,NV)
910   FORMAT(1X,12HDSP2 ARRAY :,20F5.2)
C
C ...........DEBUG TIME.................................................
C
C
C
C RESET ERROR TRACES IN CB/WHERE/
C
999   IOPNUM=IOLDOP
      OPNAME(1)=OLDOPN(1)
      OPNAME(2)=OLDOPN(2)
C
      RETURN
      END
