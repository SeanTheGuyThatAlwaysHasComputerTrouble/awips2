C MEMBER EPRG02
C  (from old member EEPRG02)
C
      SUBROUTINE EPRG02(BLENDV)
C                             LAST UPDATE: 01/26/95.17:16:23 BY $WC30EW
C
C
C ......................................................................
C
C          PRINT GENERATE 02 INFO
C
C THIS ROUTINE WILL PRINT OUT THE EXTERNAL LOCATION
C INFORMATION STORED IN THE TSESP ARRAY FOR A GENERATE
C TIME SERIES WHICH WILL BLEND HISTORICAL AND FUTURE DATA FROM
C THE PROCCESSED DATA BASE.
C
C
C
C SUBROUTINE ORIGINALLY BY :
C   ED VANBLARGAN - HRL - DEC, 1981
C
C
CE
CEW  BY EDWIN WELLES.  ALL OF MY ADDITIONS ARE MARKED WITH
CEW  COMMENTS THAT BEGIN WITH   CEW.   1/9/95
C
C ......................................................................
C
C
      INTEGER CMONTH,CDAY,CYEAR,CHRMN,CSCNDS
      DIMENSION BLENDV(1),SBNAME(2),OLDOPN(2),ITP(2),DESC(5),FILNM(8),
     * DIRNM(20)

C
      INCLUDE 'common/fdbug'
      INCLUDE 'common/ionum'
      INCLUDE 'common/where'
      INCLUDE 'clbcommon/crwctl'
      COMMON/BHTIME/IBHREC,CMONTH,CDAY,CYEAR,CHRMN,CSCNDS,LSTHDR
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/espinit/RCS/eprg02.f,v $
     . $',                                                             '
     .$Id: eprg02.f,v 1.2 2006/03/16 18:56:47 xfan Exp $
     . $' /
C    ===================================================================
C
C
      DATA NAME,SBNAME,ITP/4HEPRT,4HEPRG,4H02  ,4HTEMP,4HPCPN/,
     * SAME/4HSAME/
C
C SET UP ERROR TRACE FOR THIS SUBROUTINE IN COMMON BLK/WHERE/
C
      IOLDOP=IOPNUM
      IOPNUM=0
      DO 10 I=1,2
        OLDOPN(I)=OPNAME(I)
        OPNAME(I)=SBNAME(I)
10    CONTINUE
C
C GET TRACE LEVEL AND DEBUG
C
      IF (ITRACE.GE.1) WRITE(IODBUG,50)
50    FORMAT(1H0,14HEPRG02 ENTERED)
      IBUG=IFBUG(NAME)
C
C PRINT OUT VALUES NECESSARY FOR BLENDING
C BLENDV IS ARRAY WHICH OCCUPIES LOCATIONS OF THE TSESP ARRAY
C STARTING WITH THE 3RD LOCATION OF EXTERNAL INFO LOCATIONS
C IN TSESP
C
C dws    Made var LNU to get integer value from BLENDV(5) for index in
C dws     the write stmt to avoid a compiler warning ... 2006-01-23

      LWP=BLENDV(3)
      LBP=BLENDV(4)
      LNU=BLENDV(5)
      WRITE(IPR,200) (BLENDV(I),I=1,2),LWP,LBP,ITP(LNU+1)
200   FORMAT(/ 16X,40HWEIGHT OF FUTURE DATA AT START OF RUN  =,F5.2
     * / 16X,40HWEIGHT OF FUTURE DATA AT END OF PERIOD =,F5.2
     * / 16X,40HLENGTH OF PERIOD(HRS.) TO DO WEIGHTING =,I5
     * / 16X,40HLENGTH OF PERIOD(DAYS) TO DO BLENDING  =,I5
     * / 16X,40HTYPE OF DATA (TEMP OR PCPN)            =,1X,A4)
C
      WRITE(IPR,300) (BLENDV(I),I=6,8)
300   FORMAT(16X,35HTIME SERIES INFO (ID,DATA TYPE) FOR,
     * 15H FUTURE DATA : ,2A4,3X,A4
     * / 16X,29HHISTORICAL DATA INFO FOLLOWS:)
C
C
      IDT=BLENDV(16)
      IBHREC=BLENDV(17)
      CMONTH=BLENDV(21)
      CDAY=BLENDV(22)
      CYEAR=BLENDV(23)
      CHRMN=BLENDV(24)
      CSCNDS=BLENDV(25)
C      CALL LOCATX TO GET INITIAL AND LAST DATES.
C FIRST CALL ZERO TO ZERO OUT THE NUMBER OF READS.
C
      INMO=0
      INYR=0
      LAMO=0
      LAYR=0
      UNIT=SAME
C
      CALL CZRORD
      CALL LOCATX(INMO,INYR,LAMO,LAYR,UNIT,BLENDV(12),BLENDV(15),
     1 IDT,BLENDV(18),DESC,NSEQ,LPTR)
C
CEW ADDITION TO ACCOMADATE CARD INPUT
CEW CHECK IF ON HP'S
      IF(INMO.NE.-1000) GOTO 1140
C       CARD FILE EXTERNAL INFO
1150  DO 1154 II=1,20
1154  DIRNM(II) = BLENDV(19+II)
      DO 1155 II=1,8
1155  FILNM(II) = BLENDV(39+II)
      AM1       = BLENDV(13)
      AM2       = BLENDV(14)
      WRITE(IPR,1111) DIRNM,FILNM
1111   FORMAT(/ 11X,5HPATH:,1X,20A4/11X,13HAND FILENAME:,1X,8A4)
C
CEW FIND MONTH AND YEAR FROM ABSOLUTE MONTH
      INYR=AM1/12
      LAYR=AM2/12
      INMO=AM1-(12*INYR)
      LAMO=AM2-(12*LAYR)
      IF(INMO.NE.0) GOTO 1120
      INMO=12
      INYR=INYR-1
1120  IF(LAMO.NE.0) GOTO 1159
      LAMO=12
      LAYR=LAYR-1


1159  WRITE (IPR,1160) INMO,INYR,LAMO,LAYR
1160  FORMAT( 11X,38HPERIOD OF RECORD THAT IS STORED ON THE/
     * /12X,38HESP PARAMETER FILE FOR THE CARD FILE= ,
     * I2,1H-,I4,4H TO ,I2,1H-,I4)
C
      GO TO 900
CEW END OF ADDITION
C
1140  WRITE(IPR,400) (BLENDV(I),I=12,15),IDT,IBHREC,(BLENDV(I),I=18,20),
     * CMONTH,CDAY,CYEAR
400   FORMAT(/ 32X,42HDATA     TIME     BLOCK HEADER     STATION,
     *  4X,8HCREATION
     * /16X,9HFILE NAME,7X,16HTYPE    INTERVAL,4X,6HRECORD,
     * 10X,4HI.D.,7X,4HDATE
     * /16X,12(1H.),4X,4(1H.),4X,8(1H.),2X,11(1H.),3X,12(1H.),1X,8(1H.)
     * / 16X,3A4,4X,A4,6X,I3,5X,I10,4X,3A4,1X,I2,1H-,I2,1H-,I2)
C
C      CHECK IERROR=0 FROM COMMON BLOCK CRWCTL.
C
      IF (IERROR.EQ.0) GO TO 850
      WRITE (IPR,830)
830   FORMAT(/ 11X,39H**ERROR**CANNOT LOCATE PERIOD OF RECORD,
     * 22H FOR CALIBRATION FILE.)
      CALL ERROR
      IERROR=0
      GO TO 880
C
850   WRITE (IPR,860) INMO,INYR,LAMO,LAYR
860   FORMAT(/ 11X,40HPERIOD OF RECORD FOR CALIBRATION FILE = ,
     * I2,1H-,I4,4H TO ,I2,1H-,I4)
C
C SET ERROR TRACE IN CB/WHERE/ BACK THE WAY THEY WERE
C
880   IOPNUM=IOLDOP
      OPNAME(1)=OLDOPN(1)
      OPNAME(2)=OLDOPN(2)
C
900   CONTINUE
      RETURN
      END
