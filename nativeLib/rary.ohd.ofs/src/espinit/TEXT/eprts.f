C MEMBER EPRTS
C  (from old member EEPRTS)
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 01/13/95.14:08:01 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE EPRTS (TSESP,LTESP)
C
C ......................................................................
C
C                PRINT TSESP ARRAY ROUTINE
C
C     THIS ROUTINE IS PART OF THE ESP INTILIZATION PROGRAM
C       AND PRINT SEGMENT ROUTINE.
C     THIS ROUTINE WILL SIMPLY PRINT THE INFORMATION STORED
C       IN TIME SERIES (TS) ARRAY (TSESP).
C
C ......................................................................
C     ORIGINALLY WRITTEN BY
C       ED VANBLARGAN - HRL - MAY,1981
C
CEW  THIS CODE WAS MODIFIED TO RUN ON THE HP WORK STATIONS
CEW  BY EDWIN WELLES.  ALL OF MY ADDITIONS ARE MARKED WITH
CEW  COMMENTS THAT BEGIN WITH   CEW.   1/9/95
C
C ......................................................................
C
      INTEGER CMONTH,CDAY,CYEAR,CHRMN,CSCNDS
C
CEW IDATYPE INCREASED FROM 10 TO 11
CEW CHANGED ADDED DIRNAM(20) AND FILNAM(8)
      DIMENSION  TSESP(1),NAMTYP(8),IDATYP(11),DIRNM(20),FILNM(3),
     *FILNAM(8),STAID(3),DESC(5),SBNAME(2),OLDOPN(2)
CEW ADDED TEMPNM
      CHARACTER*39 TEMPNM

      INCLUDE 'common/fdbug'
      INCLUDE 'common/ionum'
      INCLUDE 'clbcommon/crwctl'
      INCLUDE 'common/where'
      COMMON/BHTIME/IBHREC,CMONTH,CDAY,CYEAR,CHRMN,CSCNDS,LSTHDR
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/espinit/RCS/eprts.f,v $
     . $',                                                             '
     .$Id: eprts.f,v 1.1 1995/09/17 18:46:34 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA NAME,SBNAME/4HEPRT,4HEPRT,4HS   /
      DATA CALB,ESP,XMSG,GENR,REPL,CARD/4HCALB,4HESP ,4HMSNG,4HGENR,
     *4HREPL,4HCARD/
      DATA NAMTYP/4HINPU,4HT   ,4HUPDA,4HTE  ,4HOUTP,4HUT  ,4HINTE,
     * 4HRNAL/
CEW CARD ADDED TO IDATYP
      DATA IDATYP/4HCALI,4HBRAT,4HION ,4HESP ,4HMISS,4HING ,
     * 4HGENE,4HRATE,4HREPL,4HACE ,4HCARD/
      DATA SAME,DESC/4HSAME,5*4H    /
      DATA CRPE,BLEND/4HCREA,4HBLEN/
C
C SET UP ERROR TRACES FOR THIS ROUTINE IN CB/WHERE/.
C
      IOLDOP=IOPNUM
      IOPNUM=0
      DO 10 I=1,2
        OLDOPN(I)=OPNAME(I)
        OPNAME(I)=SBNAME(I)
10     CONTINUE
C
C     GET TRACE LEVEL AND DEBUG
C
      IF (ITRACE.GE.1) WRITE(IODBUG,50)
50    FORMAT(1H0,13HEPRTS ENTERED)
      IBUG=IFBUG(NAME)
C
C     GO THRU AND SET LOCATIONS IN TS ARRAY. CHECK FOR END OF
C     FILE (TYPE=TSESP(I)=0) .
C
      WRITE (IPR,150)
150   FORMAT(//1H0,46HINFORMATION STORED IN THE TSESP ARRAY FOR THIS
     * / 1X,50HSEGMENT FOLLOWS SHOWING INFO FOR EACH TIME SERIES:
     * / 1H0,11HTIME SERIES,5X,12HDATA    TIME,9X,11HTIME SERIES
     * / 4X,4HI.D.,9X,4HTYPE,4X,8HINTERVAL,7X,4HTYPE
     * / 1X,11(1H-),5X,4(1H-),4X,8(1H-),4X,11(1H-))
C
      NTS=0
      IRPL=0
      IFUP=0
      NEX=1
C
100   I=NEX
      ITSTYP=TSESP(I)
      IF (ITSTYP.LE.0) GO TO 999
C
C
      NEX=TSESP(I+1)
      IDA=I+2
      IDB=I+3
      IDT=I+4
      IT=TSESP(I+5)
      NUMIN=TSESP(I+6)
      LOC=TSESP(I+7)
      IND=TSESP(I+8)
      IFILE=I+9
      IFLAG=TSESP(I+10)
      NV=TSESP(I+11)
C
C     SET INITIAL AND END LOCATIONS FOR PRINTING TS TYPE (IN TS ARRAY).
C
      INIT=ITSTYP*2 - 1
      IEND=INIT+1
C
C     PRINT INFO UP TO THIS POINT BEFORE SEARCHING EXTERNAL INFORMATION.
C
      NTS=NTS+1
      WRITE (IPR,170) NTS,TSESP(IDA),TSESP(IDB),TSESP(IDT),IT,
     * (NAMTYP(J),J=INIT,IEND)
170   FORMAT(1H0,I2,1H.,1X,2A4,4X,A4,7X,I3,9X,2A4)
C
      IF (IBUG.GE.1) WRITE(IODBUG,180) NEX,NUMIN,LOC,IND
180   FORMAT(/ 11X,42HLOCATION IN TS ARRAY OF NEXT TIME SERIES =,I5
     * / 11X,36HNUMBER OF VALUES PER TIME INTERVAL =,I5
     * / 11X,36HLOCATION OF TIME SERIES IN D ARRAY =,I5
     * / 11X,42HINDICATOR IF TIME SERIES HAS DATA VALUES =,I2,5X,
     * 12H1=YES   0=NO)
C
C     SKIP EXTERNAL INFO FOR INTERNAL TS TYPE ONLY.
C
      NADD=TSESP(I+9)
      IF(ITSTYP.EQ.4) GO TO 1300
C
C     SET FIRST AND LAST LOCATIONS FOR PRINTING TYPE OF PROCESSED
C     DATA FILE (IN TS ARRAY)
C
      ICASE=1
      IFIRST=1
      ILAST=3
      IF (TSESP(IFILE).NE.ESP) GO TO 200
      ICASE=2
      IFIRST=4
      ILAST=4
      GO TO 500
C
200   IF (TSESP(IFILE).NE.XMSG) GO TO 300
      ICASE=3
      IFIRST=5
      ILAST=6
      GO TO 500
C
300   IF (TSESP(IFILE).NE.GENR) GO TO 400
      ICASE=4
      IFIRST=7
      ILAST=8
      GO TO 500
C
400   IF (TSESP(IFILE).NE.REPL) GO TO 450
      ICASE=5
      IFIRST=9
      ILAST=10
C
CEW ADDED CARD FILE TYPE
450   IF (TSESP(IFILE).NE.CARD) GO TO 500
      ICASE=6
      IFIRST=11
      ILAST=11
C
500   WRITE (IPR,600) (IDATYP(J),J=IFIRST,ILAST)
600   FORMAT(/ 11X,30HTYPE OF PROCESSED DATA FILE : ,3A4)
C
C
C     WRITE INDICATOR FOR OUTPUT/UPDATE TS ONLY.
C
      IF (IBUG.LE.0) GO TO 730
      IF(ITSTYP.EQ.2 .OR. ITSTYP.EQ.3) WRITE(IODBUG,710) IFLAG
710   FORMAT(11X,44HINDICATOR FOR WHEN TIME SERIES WAS WRITTEN =,
     * I2,5X,38H1=DURING EXECUTION   0=AFTER EXECUTION)
C
      WRITE (IODBUG,720) NV
720   FORMAT(11X,42HNUMBER OF PIECES OF EXTERNAL INFORMATION =,I5)
C
C     NEXT, PRINT THE EXTERNAL INFO FOR WHICHEVER DATA FILE IT IS.
C
C     VARIABLES: IEXT=FIRST LOCATION OF EXTERNAL INFO IN ARRAY.
C
730   IEXT=I+12
C
      NADD=TSESP(I+12+NV)
      NESP=TSESP(I+13+NV+NADD)
C
      WRITE (IPR,750)
750   FORMAT(/ 11X,38HEXTERNAL LOCATION INFORMATION FOLLOWS:)
C
      IF (ITSTYP.EQ.2) WRITE(IPR,760)
760   FORMAT(/ 11X,44HTHIS IS EXTERNAL INFO FOR INPUT TIME SERIES:)
C
CEW ADDED CARD LINE GOTO 1150
      GO TO (800,900,1200,1000,1100,1150) ICASE
C
C     CALB DATA FILE - EXTERNAL INFO
C
800   FILNM(1)=TSESP(IEXT)
      FILNM(2)=TSESP(IEXT+1)
      FILNM(3)=TSESP(IEXT+2)
      DTC=TSESP(IEXT+3)
C
      ITA=TSESP(IEXT+4)
      IBHREC=TSESP(IEXT+5)
      STAID(1)=TSESP(IEXT+6)
      STAID(2)=TSESP(IEXT+7)
      STAID(3)=TSESP(IEXT+8)
C
      CMONTH=TSESP(IEXT+9)
      CDAY=TSESP(IEXT+10)
      CYEAR=TSESP(IEXT+11)
      CHRMN=TSESP(IEXT+12)
      CSCNDS=TSESP(IEXT+13)
C
      WRITE(IPR,810) FILNM,DTC,ITA,IBHREC,STAID,CMONTH,CDAY,CYEAR
810   FORMAT(/ 27X,42HDATA     TIME     BLOCK HEADER     STATION,
     *  4X,8HCREATION
     * /11X,9HFILE NAME,7X,16HTYPE    INTERVAL,4X,6HRECORD,
     * 10X,4HI.D.,7X,4HDATE
     * /11X,12(1H.),4X,4(1H.),4X,8(1H.),2X,11(1H.),3X,12(1H.),1X,8(1H.)
     * / 11X,3A4,4X,A4,6X,I3,5X,I10,4X,3A4,1X,I2,1H-,I2,1H-,I2)
C
C      CALL LOCATX TO GET INITIAL AND LAST DATES.
C FIRST CALL ZERO TO ZERO OUT THE NUMBER OF READS.
C
      INMO=0
      INYR=0
      LAMO=0
      LAYR=0
      UNIT=SAME
C
      CALL CZRORD
      CALL LOCATX(INMO,INYR,LAMO,LAYR,UNIT,FILNM,
     *DTC,ITA,STAID,DESC,NSEQ,LPTR)
C
C      CHECK IERROR=0 FROM COMMON BLOCK CRWCTL.
C
      IF (IERROR.EQ.0) GO TO 850
      WRITE (IPR,830)
830   FORMAT(/ 11X,39H**ERROR**CANNOT LOCATE PERIOD OF RECORD,
     * 22H FOR CALIBRATION FILE.)
      CALL ERROR
      IERROR=0
      GO TO 880
C
850   WRITE (IPR,860) INMO,INYR,LAMO,LAYR
860   FORMAT(/ 11X,40HPERIOD OF RECORD FOR CALIBRATION FILE = ,
     * I2,1H-,I4,4H TO ,I2,1H-,I4)
C
880   IF (IRPL.EQ.1) GO TO 1110
      IF (IFUP.EQ.1) GO TO 1500
      GO TO 1300
C
C
C     ESP DATA FILE EXTERNAL INFO
C
900   IT=TSESP(IEXT+3)
      IDELT=TSESP(IEXT+7)
C
      IF (ITSTYP.EQ.3) WRITE(IPR,910) (TSESP(IEXT+N),N=4,6),
     *   IDELT
910   FORMAT(/ 26X,21HWRITE ONLY TO SCRATCH,
     *  /11X,34HDESCRIPTION    FILE  (1=YES, 0=NO),
     *  /11X,11(1H.),4X,21(1H.),
     *  /11X,3A4,7X,I5)
C
      IF (ITSTYP.NE.3) WRITE(IPR,920) (TSESP(IEXT+N),N=4,6),
     * (TSESP(IEXT+N-1),N=1,3),IT,IDELT
920   FORMAT(/ 44X,13HDATA     TIME,8X,6HDELETE
     * / 11X,49HDESCRIPTION    TIME SERIES ID    TYPE    INTERVAL,
     * 4X,19HSWITCH(1=YES, 0=NO)
     * / 11X,11(1H.),4X,14(1H.),4X,4(1H.),4X,8(1H.),4X,19(1H.)
     * / 11X,3A4,6X,2A4,7X,A4,4X,I5,7X,I5)
C
      IF (IRPL.EQ.1) GO TO 1110
      IF (IFUP.EQ.1) GO TO 1500
      GO TO 1300
C
C     GENR DATA FILE, EXTERNAL INFO
C
1000  WRITE (IPR,1010) TSESP(IEXT),TSESP(IEXT+1)
1010  FORMAT(/ 11X,16HGENERATE TYPE : ,2A4)
C
C
C CHECK IF GENERATE TYPE IS CREATE PE OR BLEND TS.
C
      IF (TSESP(IEXT).NE.CRPE) GO TO 1020
      CALL EPRG01(TSESP(IEXT+2))
      GO TO 1060
C
1020  IF (TSESP(IEXT).NE.BLEND) GO TO 1030
      CALL EPRG02(TSESP(IEXT+2))
      GO TO 1060
C
1030  WRITE (IPR,1040)
1040  FORMAT(1H0,10X,38H**ERROR** ILLEGAL GENERATE TYPE ABOVE.)
      IER=1
      CALL ERROR
C
1060  IF (IRPL.EQ.1) GO TO 1110
      IF (IFUP.EQ.1) GO TO 1500
      GO TO 1300
C
C
C     REPLACE DATA FILE, EXTERNAL INFO
C
1100  TYPNU=TSESP(I+14+NV+NADD)
      IRPL=1
C
      WRITE (IPR,1105)
1105  FORMAT(/ 11X,41HTHIS IS THE EXTERNAL LOCATION INFORMATION,
     * 25H FOR THE NEW TIME SERIES:)
C
      IF (TYPNU.EQ.CALB) GO TO 800
      IF (TYPNU.EQ.ESP) GO TO 900
      IF (TYPNU.EQ.GENR) GO TO 1000
      IF (TYPNU.EQ.CARD) GO TO 1150
      IF (TYPNU.EQ.XMSG) GO TO 1200
1110  IRPL=0
      GO TO 1300
C
C
CEW ADDED CARD TYPE FILE HERE
C	CARD TYPE FILE
C
C	CARD FILE EXTERNAL INFO
C
1150  DO 1154 II=1,20
1154  DIRNM(II) = TSESP(IEXT+7+II)
      DO 1155 II=1,8
1155  FILNAM(II) = TSESP(IEXT+27+II)
      WRITE(IPR,1111) DIRNM,FILNAM
1111   FORMAT(/ 11X,5HPATH:,1X,20A4/11X,13HAND FILENAME:,1X,8A4)
C
CEW IF OUTPUT FILE SKIP NEXT SECTION
      IF(INIT.EQ.5) GO TO 1113
CEW FIND MONTH AND YEAR FROM ABSOLUTE MONTH
CEW SKIP FOR OUTPUT FILE
      ITA       = TSESP(IEXT+5)
      AM1       = TSESP(IEXT+1)
      AM2       = TSESP(IEXT+2)
      INYR=AM1/12
      LAYR=AM2/12
      INMO=AM1-(12*INYR)
      LAMO=AM2-(12*LAYR)
      IF(INMO.NE.0) GOTO 1120
      INMO=12
      INYR=INYR-1
1120  IF(LAMO.NE.0) GOTO 1140
      LAMO=12
      LAYR=LAYR-1

1140  WRITE (IPR,1160) INMO,INYR,LAMO,LAYR
1160  FORMAT( 11X,38HPERIOD OF RECORD THAT IS STORED ON THE/
     * /12X,38HESP PARAMETER FILE FOR THE CARD FILE= ,
     * I2,1H-,I4,4H TO ,I2,1H-,I4)
      GO TO 1113
C
CEW IF OUTPUT FILE TYPE SKIP TO HERE

1113  IF (IRPL.EQ.1) GO TO 1110
      IF (IFUP.EQ.1) GO TO 1500
      GOTO 1300
C
C      MISSING DATA FILE TYPE - EXTERNAL INFO
C
1200  WRITE (IPR,1210)
1210  FORMAT(11X,20HEXTERNAL INFO : NONE)
      IF (IRPL.EQ.1) GO TO 1110
      IF (IFUP.EQ.1) GO TO 1500
C
C
C     TIME FOR ADDITIONAL INFO
C
1300  IF (IBUG.GE.1) WRITE(IODBUG,1310) NADD
1310  FORMAT(/ 11X,I4,35H = PIECES OF ADDITIONAL INFORMATION)
C
      IF (NADD.GE.1) WRITE(IPR,1320) NADD
1320  FORMAT(/  11X,18HALTHOUGH THERE ARE,I4,
     * 43H PIECES OF ADDITIONAL INFORMATION NO FORMAT
     * / 12X,49H EXISTS AND THEY CAN NOT BE PRINTED AT THIS TIME.)
C
      IF (ITSTYP.EQ.4) GO TO 1500
C
C     TIME FOR ESP INFO
C
      IF (IBUG.GE.1) WRITE(IODBUG,1410) NESP
1410  FORMAT(/ 11X,I4,28H = PIECES OF ESP INFORMATION)
C
      IF (ICASE.NE.5) GO TO 1430
C
C     REPLACE FILE - ESP INFO
C
      ITNU=TSESP(I+18+NV+NADD)
C
      WRITE (IPR,1420) (TSESP(I+N+NV+NADD),N=14,17),ITNU
1420  FORMAT(/ 11X,41HESP INFORMATION FOR THE NEW TIME SERIES:
     * // 11X,41HNEW FILE   NEW TIME   NEW DATA   NEW TIME
     * / 11X,4HTYPE,7X,15HSERIES ID  TYPE,7X,8HINTERVAL
     * / 11X,4(1H.),7X,8(1H.),3X,4(1H.),7X,8(1H.)
     * / 11X,A4,7X,2A4,3X,A4,10X,I3)
      GO TO 1500
C
1430  IF (ITSTYP.NE.2) GO TO 1500
C
C     UPDATE TS - ESP INFO
C
      OUT=TSESP(I+14+NV+NADD)
      NVAL=TSESP(I+15+NV+NADD)
C
      WRITE (IPR,1440) OUT
1440  FORMAT(/ 11X,16HESP INFORMATION:
     * / 11X,A4,19H = OUTPUT FILE TYPE)
C
      IF (IBUG.GE.1) WRITE(IODBUG,1450) NVAL
1450  FORMAT(11X,I4,33H = PIECES OF EXTERNAL INFORMATION)
C
      IEXT=I+16+NV+NADD
      IFUP=1
C
      IF (OUT.EQ.REPL) GO TO 1500
      WRITE (IPR,1470)
1470  FORMAT(/ 11X,37HEXTERNAL LOCATION INFORMATION FOR THE,
     * 28H OUTPUT TIME SERIES FOLLOWS:)
C
      IF (OUT.EQ.CALB) GO TO 800
      IF (OUT.EQ.ESP) GO TO 900
      IF (OUT.EQ.GENR) GO TO 1000
      IF (OUT.EQ.CARD) GO TO 1480
      IF (OUT.EQ.XMSG) GO TO 1200
C
CEW CARD TYPE UPDATE
1480  WRITE(TEMPNM,1481) (FILNAM(II), II = 1, 8)
1481  FORMAT(7HUPDATE_,8A4)
      WRITE(IPR,1482)DIRNM,TEMPNM
1482   FORMAT(/ 11X,5HPATH:,1X,20A4/11X,13HAND FILENAME:,1X,A39 )
      GO TO 1500

1500  IFUP=0
C
C     CHECK FOR END OF ARRAY (NEX GT LTESP).
C
      IF (NEX.LE.LTESP) GO TO 100
C
C
C
C SET ERROR TRACES IN CB/WHERE/ BACK THE WAY THEY WERE.
C
999   IOPNUM=IOLDOP
      OPNAME(1)=OLDOPN(1)
      OPNAME(2)=OLDOPN(2)
C
      RETURN
      END
