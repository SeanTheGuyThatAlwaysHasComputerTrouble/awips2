C MEMBER SPMAPE
C-----------------------------------------------------------------------
C
C DESC PRINT AREA MAPE PARAMETER RECORD
C
      SUBROUTINE SPMAPE (UNIT,IVMAPE,XMAPEI,DESCRP,CENTRD,ISTWT,
     *   POWER,PEMEAN,PECHNG,NPE,STAID,IPDPTR,STAWT,
     *   UNUSED,ISTAT)
C
      REAL ENGL/4hENGL/,XMM/4hMM  /,XIN/4hIN  /
C
      DIMENSION XMAPEI(1),DESCRP(1),CENTRD(1)
      DIMENSION PEMEAN(1),PECHNG(1),STAID(2,1),IPDPTR(1),STAWT(1)
      DIMENSION UNUSED(1),CPEM(12),CPECH(12)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_print/RCS/spmape.f,v $
     . $',                                                             '
     .$Id: spmape.f,v 1.1 1995/09/17 19:14:11 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.1) WRITE (IOSDBG,150)
      IF (ISTRCE.GT.1) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG(4HMAPE)
C
      ISTAT=0
      NUMERR=0
C
      IUNDEF=-997
C
C  UNITS CONVERSION
      UNITPE=XMM
      DO 10 I=1,12
         CPEM(I)=PEMEAN(I)
         CPECH(I)=PECHNG(I)
10       CONTINUE
      IF (UNIT.NE.ENGL) GO TO 30
         UNITPE=XIN
         CALL UDUCNV(4HMM  ,4HIN  ,1,12,PEMEAN,CPEM,IERR)
         CALL UDUCNV(4HMM  ,4HIN  ,1,12,PECHNG,CPECH,IERR2)
         IF (IERR.EQ.0.AND.IERR2.EQ.0) GO TO 30
            WRITE (LP,20) IERR,IERR2
            CALL SUERRS (LP,2,NUMERR)
C
C  CHECK NUMBER OF LINES LEFT ON PAGE
30    IF (ISLEFT(5).GT.0) CALL SUPAGE
C
C  PRINT HEADING
      WRITE (LP,320)
      CALL SULINE (LP,2)
      WRITE (LP,330)
      CALL SULINE (LP,2)
      WRITE (LP,340)
      CALL SULINE (LP,1)
C
C  PRINT PARAMETER ARRAY VERSION NUMBER
      IF (LDEBUG.EQ.0) GO TO 40
         WRITE (LP,180) IVMAPE
         CALL SULINE (LP,2)
C
C  TRANSFORM COORDINATES FROM NWSRFS/HRAP TO LATITUDE/LONGITUDE
C  PRINT MAPE AREA IDENTIFIER, DESCRIPTIVE INFORMATION AND CENTROID
C  COORDINATES
40    CALL SBLLGD(XLONG,XLAT,1,CENTRD(1),CENTRD(2),0,IERR)
      WRITE (LP,190) XMAPEI(1),XMAPEI(2),(DESCRP(I),I=1,5),XLAT,
     *   XLONG
      CALL SULINE (LP,2)
C
C  PRINT TYPE OF STATION WEIGHTS AND EXPONENT IN 1/D**POWER
      GO TO (50,60),ISTWT
         WRITE (LP,195) ISTWT
         CALL SUERRS (LP,2,NUMERR)
         GO TO 75
50    WRITE (LP,200)
      GO TO 70
60    WRITE (LP,210) POWER
70    CALL SULINE (LP,2)
C
C  PRINT IDENTIFIER AND WEIGHT FOR MAPE COMPUTATION STATIONS
75    IF (NPE.GT.0) GO TO 80
         WRITE (LP,220)
         CALL SULINE (LP,2)
         GO TO 110
80    IF (ISLEFT(5).GT.0) CALL SUPAGE
      WRITE (LP,230)
      CALL SULINE (LP,3)
      DO 90 I=1,NPE
         WRITE (LP,240) I,STAID(1,I),STAID(2,I),STAWT(I)
         CALL SULINE (LP,1)
         IF (ISNWPG(LP).EQ.1) WRITE (LP,230)
         IF (ISNWPG(LP).EQ.1) CALL SULINE (LP,3)
90       CONTINUE
C
C  PRINT PPDB ARRAY LOCATION POINTERS
      IF (LDEBUG.EQ.0) GO TO 110
         IF (ISLEFT(5).GT.0) CALL SUPAGE
         WRITE (LP,260)
         CALL SULINE (LP,3)
         DO 100 I=1,NPE
            WRITE (LP,270) I,STAID(1,I),STAID(2,I),IPDPTR(I)
            CALL SULINE (LP,1)
            IF (ISNWPG(LP).EQ.1) WRITE (LP,260)
            IF (ISNWPG(LP).EQ.1) CALL SULINE (LP,3)
100         CONTINUE
C
C  PRINT MEAN PE FOR 16TH OF EACH MONTH
C  UNITS CONTROLLED BY UNIT PARAMETER
110   WRITE (LP,280)
      CALL SULINE (LP,2)
      WRITE (LP,290) (CPEM(I),I=1,12),UNITPE
      CALL SULINE (LP,2)
C
C  PRINT DAILY CHANGE IN MEAN PE
C  UNITS CONTROLLED BY UNITS PARAMETER
      IF (LDEBUG.EQ.0) GO TO 120
         WRITE (LP,300)
         CALL SULINE (LP,2)
         WRITE (LP,310) (CPECH(I),I=1,12),UNITPE
         CALL SULINE (LP,1)
C
C  PRINT NUMBER OF UNUSED POSITIONS
120   NUNUSD=2
      IF (LDEBUG.GT.0) WRITE (LP,250) NUNUSD
      IF (LDEBUG.GT.0) CALL SULINE (LP,2)
C
      WRITE (LP,320)
      CALL SULINE (LP,2)
C
130   IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) WRITE (IOSDBG,160)
      IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) CALL SULINE (IOSDBG,1)
C
140   IF (ISTRCE.GT.1) WRITE (IOSDBG,170)
      IF (ISTRCE.GT.1) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
150   FORMAT (' *** ENTER SPMAPE')
20    FORMAT ('0*** ERROR - UNIT CONVERSION FOR PE VALUES COULD NOT ',
     *   'BE COMPUTED.  STATUS=',2I3)
320   FORMAT (1H0,132(1H-))
330   FORMAT ('0*-->  MAPE AREA PARAMETERS')
340   FORMAT (1H )
180   FORMAT ('0PARAMETER ARRAY VERSION NUMBER = ',I2)
190   FORMAT ('0MAPE AREA ID = ',2A4,8X,'DESCRIPTION = ',5A4,8X,
     *   'CENTROID: LAT=',F6.2,2X,'LON=',F7.2)
195   FORMAT ('0*** ERROR - IN SPMAPE - INDICATOR FOR TYPE OF ',
     *   'STATION WEIGHTS NOT RECOGNIZED: ',I2,'.')
200   FORMAT ('0TYPE OF STATION WEIGHTS = PREDETERMINED')
210   FORMAT ('0TYPE OF STATION WEIGHTS = 1/D**POWER      EXPONENT ',
     *   'IN 1/D**POWER = ',F6.1)
220   FORMAT ('0STATIONS USED FOR COMPUTING MAPE:  ** NONE DEFINED **')
230   FORMAT ('0STATIONS USED FOR COMPUTING MAPE: ',
     *   5X,'IDENTIFIER',8X,'WEIGHT' /
     *   40X,10('-'),8X,6('-'))
240   FORMAT (36X,I1,4X,2A4,9X,F5.2)
250   FORMAT ('0NUMBER OF UNUSED POSITIONS = ',I2)
260   FORMAT ('0PPDB ARRAY LOCATION POINTERS:',
     *   5X,'IDENTIFIER',8X,'POINTER' /
     *   35X,10('-'),8X,7('-'))
270   FORMAT (31X,I1,4X,2A4,10X,I5)
280   FORMAT ('0MEAN PE FOR 16TH OF MONTH:    JAN    FEB    MAR',
     *   '    APR    MAY    JUN    JUL    AUG    SEP    OCT    NOV',
     *   '    DEC')
290   FORMAT (1H0,26X,12(2X,F5.3),2X,A4)
300   FORMAT ('0DAILY CHANGE IN MEAN PE :   JAN   FEB   MAR   APR',
     *   '   MAY   JUN   JUL   AUG   SEP   OCT   NOV   DEC')
310   FORMAT (29X,12(1X,F6.4),2X,A4)
160   FORMAT (' *** NOTE - MAPE PARAMETERS SUCCESSFULLY ',
     *     'PRINTED.')
170   FORMAT (' *** EXIT SPMAPE')
C
      END
