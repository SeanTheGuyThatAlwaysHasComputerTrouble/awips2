C MODULE FUN005
C-----------------------------------------------------------------------
C
C  THIS FUNCTION CHECKS THE CPU TIME USED SINCE IT WAS LAST COMPUTED.
C
C  THE PURPOSE OF THE FUNCTION CPUCHECK IS TO COMPUTE THE
C  CPU TIME USED SINCE THE LAST COMPUTE OF THE FUNCTION AND
C  SINCE THE FUNCTION WAS FIRST COMPUTED DURING A RUN.
C
C  TECHNIQUE RESETCPU SPECIFIES WHETHER OR NOT TO ZERO THE VARIABLE
C  WHICH COUNTS THE TIME SINCE THE FIRST COMPUTE OF THE FUNCTION.
C
      SUBROUTINE FUN005
C
      CHARACTER*8 TECHNAME
      INCLUDE 'common/ionum'
      COMMON /FUN5CB/ IFIRST,ICPUF5
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_top/RCS/fun005.f,v $
     . $',                                                             '
     .$Id: fun005.f,v 1.3 2002/02/11 20:40:15 dws Exp $
     . $' /
C    ===================================================================
C

      JFIRST=0
C
      IOUNT=0
      IF (IOUNT.EQ.1) THEN
C
C  CHECK IF TECHNIQUE PRINT SPECIFIED
      TECHNAME='PRINT'
      CALL HPAST (TECHNAME,IPR,ISTAT)
      IF (ISTAT.GT.0) CALL FPHPWN (ISTAT,TECHNAME)
      CALL FTEKCK (IPR,TECHNAME,6,IPR,1,6)
C
      ENDIF
C
C  CHECK IF TECHNIQUE RESETCPU SPECIFIED
      TECHNAME='RESETCPU'
      CALL HPAST (TECHNAME,IRESET,ISTAT)
      IF (ISTAT.GT.0) CALL FPHPWN (ISTAT,TECHNAME)
      CALL FTEKCK (IRESET,TECHNAME,0,IRESET,0,1)
C
C  CHECK IF RESETCPU IS ON
10    IF (IRESET.EQ.1) THEN
         ICPUF5=0
         IFIRST=-45678
         JFIRST=1
         ENDIF
C
C  CHECK IF IFIRST IS SET TO -45678
      IF (IFIRST.EQ.-45678) GO TO 40
C
C  PRINT WARNING THAT RESETCPU WAS NOT SET
      WRITE (IPR,30)
30    FORMAT ('0**WARNING** TECHNIQUE ',
     *   'RESETCPU WAS NOT ON FOR THE FIRST COMPUTE OF THIS ',
     *   'FUNCTION. TOTAL CPU TIME WILL BE SET TO ZERO.')
      CALL WARN
      IRESET=1
      GO TO 10
C
40    CALL URTIMR (LAPSE,ICPUF5)
C
      IF (JFIRST.EQ.1) GO TO 60
C
C  NOT FIRST TIME THROUGH THIS FUNCTION THIS RUN
      ELAPSE=LAPSE/100.
      XICPUF=ICPUF5/100.
      WRITE (IPR,50) ELAPSE,XICPUF
50    FORMAT ('0**NOTE** ', 
     *   'ELAPSED CPU TIME = ',F6.2,' SECONDS',5X,
     *   'TOTAL CPU TIME = ',F6.2,' SECONDS')
      GO TO 80
C
C  FIRST TIME THROUGH THIS FUNCTION
60    WRITE (IPR,70)
70    FORMAT('0**NOTE** TOTAL CPU TIME SET TO ZERO.')
C
80    RETURN
C
      END
