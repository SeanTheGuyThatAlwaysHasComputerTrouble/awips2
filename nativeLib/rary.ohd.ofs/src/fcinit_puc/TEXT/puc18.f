C MEMBER PUC18
C  (from old member FCPUC18)
C-----------------------------------------------------------------------
C                             LAST UPDATE: 10/31/95.09:31:33 BY $WC21DT
C @PROCESS LVL(77)
C
      SUBROUTINE PUC18(PO)
C
C   THIS SUBROUTINE IS THE PUNCH CARDS SUBROUTINE FOR
C   THE PLOT-TS OPERATION.
C
C   THIS SUBROUTINE WAS INITIALLY PROGRAMMED BY
C   GERALD N. DAY  -  HRL  MAY 1980
C
      DIMENSION PO(*),PMIN(2),PMAX(2),CRITA(2)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_puc/RCS/puc18.f,v $
     . $',                                                             '
     .$Id: puc18.f,v 1.2 1996/01/16 23:02:13 page Exp $
     . $' /
C    ===================================================================
C
      IF(ITRACE.GE.1) WRITE(IODBUG,900)
      NOPT=PO(7)
      NPLOTS=PO(8)
      NTTS=PO(9)
      NPER=PO(10)
C
C   PUNCH GENERAL RUN INFORMATION
C
      WRITE(IPU,800) (PO(K),K=2,6),NOPT,NPLOTS,NTTS,NPER
      NTSKNT=0
      DO 30 I=1,NPLOTS
      IPO=11+9*(I-1)
      NPTS=PO(IPO+2)
      NTS=PO(IPO+5)
      NDEC=7
      IF (PO(IPO+3).GT.-100000..AND.PO(IPO+3).LE.-10000.) NDEC=1
      IF (PO(IPO+3).GT.-10000..AND.PO(IPO+3).LE.-1000.) NDEC=2
      IF (PO(IPO+3).GT.-1000..AND.PO(IPO+3).LE.-100.) NDEC=3
      IF (PO(IPO+3).GT.-100..AND.PO(IPO+3).LE.-10.) NDEC=4
      IF (PO(IPO+3).GT.-10..AND.PO(IPO+3).LT.0.) NDEC=5
      IF (PO(IPO+3).GE.1..AND.PO(IPO+3).LT.10.) NDEC=6
      IF (PO(IPO+3).GE.10..AND.PO(IPO+3).LT.100.) NDEC=5
      IF (PO(IPO+3).GE.100..AND.PO(IPO+3).LT.1000.) NDEC=4
      IF (PO(IPO+3).GE.1000..AND.PO(IPO+3).LT.10000.) NDEC=3
      IF (PO(IPO+3).GE.10000..AND.PO(IPO+3).LT.100000.) NDEC=2
      IF (PO(IPO+3).GE.100000..AND.PO(IPO+3).LT.1000000.) NDEC=1
      CALL UFF2A(PO(IPO+3),PMIN,1,8,NDEC,0,6,IER)
      IF(IER.EQ.1) WRITE(IPR,700)
      NDEC=7
      IF (PO(IPO+4).GT.-100000..AND.PO(IPO+4).LE.-10000.) NDEC=1
      IF (PO(IPO+4).GT.-10000..AND.PO(IPO+4).LE.-1000.) NDEC=2
      IF (PO(IPO+4).GT.-1000..AND.PO(IPO+4).LE.-100.) NDEC=3
      IF (PO(IPO+4).GT.-100..AND.PO(IPO+4).LE.-10.) NDEC=4
      IF (PO(IPO+4).GT.-10..AND.PO(IPO+4).LT.0.) NDEC=5
      IF (PO(IPO+4).GE.1..AND.PO(IPO+4).LT.10.) NDEC=6
      IF (PO(IPO+4).GE.10..AND.PO(IPO+4).LT.100.) NDEC=5
      IF (PO(IPO+4).GE.100..AND.PO(IPO+4).LT.1000.) NDEC=4
      IF (PO(IPO+4).GE.1000..AND.PO(IPO+4).LT.10000.) NDEC=3
      IF (PO(IPO+4).GE.10000..AND.PO(IPO+4).LT.100000.) NDEC=2
      IF (PO(IPO+4).GE.100000..AND.PO(IPO+4).LT.1000000.) NDEC=1
      CALL UFF2A(PO(IPO+4),PMAX,1,8,NDEC,0,6,IER)
      IF(IER.EQ.1) WRITE(IPR,700)
C
C   PUNCH PLOT INFORMATION
C
      WRITE(IPU,805) PO(IPO+1),NPTS,PMIN,PMAX,NTS
      DO 20 J=1,NTS
      IPO=11+9*NPLOTS+12*(NTSKNT+J-1)
      IDT=PO(IPO+4)
C
C   PUNCH TS INFORMATION
C
      WRITE(IPU,810) (PO(IPO+K),K=1,3),IDT,(PO(IPO+K),K=5,10)
   20 CONTINUE
      NTSKNT=NTSKNT+NTS
   30 CONTINUE
      IF(NOPT.NE.2) GO TO 100
C
C   PUNCH PLOT OPTION 2 INFO
C
      DO 50 I=1,NPER
      IPO=11+9*NPLOTS+12*NTTS+2*(I-1)
      IJDAP=PO(IPO+1)
      LJDAP=PO(IPO+2)
      CALL MDYH1(IJDAP,1,IMOP,IDAP,IYRP,IHRP,100,0,TZONE)
      CALL MDYH1(LJDAP,1,LMOP,LDAP,LYRP,LHRP,100,0,TZONE)
      WRITE(IPU,815) IMOP,IDAP,IYRP,LMOP,LDAP,LYRP
   50 CONTINUE
      GO TO 500
  100 IF(NOPT.NE.4) GO TO 500
C
C   PUNCH PLOT OPTION 4 INFO
C
      IPO=11+9*NPLOTS+12*NTTS
      ITS=PO(IPO+1)
      CRIT=PO(IPO+2)
      KODE=PO(IPO+3)
      NDEC=7
      IF (CRIT.GT.-100000..AND.CRIT.LE.-10000.) NDEC=1
      IF (CRIT.GT.-10000..AND.CRIT.LE.-1000.) NDEC=2
      IF (CRIT.GT.-1000..AND.CRIT.LE.-100.) NDEC=3
      IF (CRIT.GT.-100..AND.CRIT.LE.-10.) NDEC=4
      IF (CRIT.GT.-10..AND.CRIT.LT.0.) NDEC=5
      IF (CRIT.GE.1..AND.CRIT.LT.10.) NDEC=6
      IF (CRIT.GE.10..AND.CRIT.LT.100.) NDEC=5
      IF (CRIT.GE.100..AND.CRIT.LT.1000.) NDEC=4
      IF (CRIT.GE.1000..AND.CRIT.LT.10000.) NDEC=3
      IF (CRIT.GE.10000..AND.CRIT.LT.100000.) NDEC=2
      IF (CRIT.GE.100000..AND.CRIT.LT.1000000.) NDEC=1
      CALL UFF2A(CRIT,CRITA,1,8,NDEC,0,6,IER)
      IF(IER.EQ.1) WRITE(IPR,700)
      IPO=11+9*NPLOTS+12*(ITS-1)
      IDT=PO(IPO+4)
      WRITE(IPU,820) (PO(IPO+K),K=1,3),IDT,CRITA,KODE,(PO(IPO+K),K=9,10)
  500 CONTINUE
      IF(ITRACE.GE.1) WRITE(IODBUG,910)
      RETURN
  700 FORMAT(1H0,10X,34H**WARNING** CONVERSION ERROR CHECK,
     1 18H CARD PUNCH OUTPUT)
  800 FORMAT(5X,5A4,4I5)
  805 FORMAT(1X,A4,I5,2X,2A4,2X,2A4,I5)
  810 FORMAT(2X,2A4,1X,A4,3X,I2,8X,3A4,4X,A1,2X,2A4)
  815 FORMAT(6I5)
  820 FORMAT(2X,2A4,1X,A4,I5,2X,2A4,I5,2X,2A4)
  900 FORMAT(1H0,16H** PUC18 ENTERED)
  910 FORMAT(1H0,15H** PUC18 EXITED)
      END
