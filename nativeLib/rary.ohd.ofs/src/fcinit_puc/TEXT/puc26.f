C MODULE PUC26
C-----------------------------------------------------------------------
C
C  THIS ROUTINE PUNCHES INPUT CARDS FOR THE RES-SNGL OPERATION IN THE
C  FORMAT REQUIRED BY THE PIN26 ROUTINE.
C
C  ORIGINALLY PROGRAMMED BY KAY KROUSE - 6/1983
C-----------------------------------------------------------------------
C
      SUBROUTINE PUC26 (PO,MCO,LCO,CO)
C
      CHARACTER*12 NAMEDP(27)
      CHARACTER*9  P /'(5HPARMS)'/
      CHARACTER*8  EP/'(4HENDP)'/
      CHARACTER*13 CA /'(9HCARRYOVER)'/
      CHARACTER*9  ECA/'(5HENDCO)'/
      CHARACTER*16 TS /'(11HTIME-SERIES)'/
      CHARACTER*9  ETS/'(5HENDTS)'/
      LOGICAL NEEDIT,NEEDVA,FOP7
C
      DIMENSION PO(*),CO(*)
      DIMENSION PU26(2)
      DIMENSION TS10(4),TS12(10),TS16(3),TS17(14),TS18(3),TS56(6)
      DIMENSION ANAME(5),UNIT(10),DIM(4),FLOPT(2),TITLE(68),TSG(12)
      DIMENSION EMTY(10),NEEDIT(8),NEEDVA(8,10),LISTOP(10)
      PARAMETER (MIDAY=365)
      DIMENSION X(MIDAY),Y(MIDAY),IDAY(MIDAY)
      DIMENSION CFACT(2,2)
      DIMENSION ITRIB(2),CTCUR(4)
C
      INCLUDE 'common/ionum'
      INCLUDE 'common/comn26'
      INCLUDE 'common/fdbug'
      INCLUDE 'common/fengmt'
      COMMON /CNVP26/ CONV1,CONV2,CONV3,CONV4,CONV5,
     *               UNT1,UNT2,UNT3,UNT4,UNT5
      COMMON /FPOR26/ IXY26
      COMMON /FATLGK/ IATL,C1,C2
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_puc/RCS/puc26.f,v $
     . $',                                                             '
     .$Id: puc26.f,v 1.16 2004/04/19 13:39:23 hsu Exp $
     . $' /
C    ===================================================================
C
      DATA PU26,BLANK,BLNK1,AMP/4HPUC2,4H6   ,4H    ,1H ,1H&/
      DATA FLOPT/4HNO  ,4HYES /
      DATA DIM/4HL   ,4HL3/T,4HL3  ,4HL/T /
      DATA UNIT/4HM   ,4HFT  ,4HCMS ,4HCFS ,4HCMSD,4HCFSD,4HM/S ,4HFT/S,
     * 4HMM  ,4HIN  /
C
      DATA TSG/4HINST,4HQIN ,4HMEAN,4HQIN ,4HMEAN,4HQOUT,4HINST,
     * 4HQOUT,4HPOOL,4H    ,4HSTOR,4HAGE /
C
      DATA TS10/4HUPQ ,4H    ,4HUPST,4HAGE /
      DATA TS12/4HLARG,4HEBDS,4HSMAL,4HLBDS,4HGATE,4H    ,4HGENQ,
     * 4H    ,4HSLUI,4HCEQ /
      DATA TS16/4HPCPN,4HEVAP,4HADDQ/
      DATA TS17/4HOBSQ,4HO   ,4HOBSQ,4HOM  ,4HOBSH,4H    ,4HADJQ,4HO   ,
     * 4HADJQ,4HOM  ,4HADJH,4H    ,4HADJS,4H    /
      DATA TS18/4HOBSQ,4HOBSH,4HNEWQ/
      DATA TS56/4HQLIM,4H    ,4HQGEN,4H    ,4HQSLU,4HICE /
C
      DATA TITLE/
     1  4HCURV,4HE   ,4HELVS,4HQ   ,4HHEAD,4HVSQ ,4HPOOL,4HVSQ ,
     1  4HELVS,4HSTOR,4H    ,4H    ,4HELVS,4HMAXQ,4HDIST,4H    ,
     2  4HOLDQ,4H    ,4HOLDH,4H    ,4HUPST,4HAGE ,4HUPPO,4HOL  ,
     3  4HUPQ ,4H    ,4HQDIS,4HT   ,4HRULE,4HCURV,4HE   ,4H CON,
     4  4HTROL,4H    ,4H    ,4H    ,4HRISI,4HNG  ,4HFALL,4HING ,
     5  4HSCQI,4H    ,4HSCEL,4HSCQO,4HGATE,4HL   ,4HOPEN,4HQ   ,
     6  4HRATI,4HNG-L,4HNG-S,4HNG-G,4HDAIL,4HY   ,4HMINQ,4H-INS,
     7  4HT   ,4HHUPP,4HER  ,4HHLOW,4HER  ,4HELVS,4HMAXQ,4HDEV ,
     8  4HWATE,4HRUSE,4HTABL,4HE   /
C
      DATA NAMEDP / '    PASSFLOW','        SETQ','        SETH',
     1              '   RULECURVE','   FILLSPILL','    SPILLWAY',
     2              '       POOLQ','     STPOOLQ','        MINQ',
     3              '        MINH','   INDSRCHGE','    FLASHBDS',
     4              '    POWERGEN','     RULEADJ','      SUMINF',
     5              '    RAINEVAP','      ADJUST','    BACKFLOW',
     6              '            ','        MAXQ','    ENTERISC',
     7              '      SETMIN','      SETMAX','     GOFLASH',
     8              '    WATERUSE','       SETDQ','       SETDH'  /
C
      DATA NEEDVA/.TRUE.,6*.FALSE.,2*.TRUE.,7*.FALSE.,
     3    .FALSE.,.TRUE.,.TRUE.,.TRUE.,.TRUE.,.FALSE.,.TRUE.,.TRUE.,
     4    .FALSE.,.TRUE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,
     5    .TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.TRUE.,
     6    .TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,
     7    .FALSE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,.TRUE.,.FALSE.,
     8    .FALSE.,6*.TRUE.,.FALSE.,
     9    8*.TRUE.,7*.TRUE.,.FALSE./
C
      DATA CFACT/4HRATI,4HO   ,4HDIFF,4H    /
      CHARACTER*4 QHTYPE(3)/'INST','MEAN','POOL'/
      DATA CTCUR/4H1   ,4H2   ,4H3   ,4H4   /
C
C
C  CHECK TRACE LEVEL
      CALL FPRBUG (PU26,1,26,IBUG)
C
      IXY26 = 0
C
      UNT1=UNIT(1)
      UNT2=UNIT(3)
      UNT3=UNIT(5)
      UNT4=UNIT(7)
      UNT5=UNIT(9)
      IMETEN=PO(8)
      KUNITS=IMETEN
      CONV1=1.0
      CONV2=1.0
      CONV3=1.0
      CONV4=1.0
      CONV5=1.0
      IF( METRIC .EQ. 0) KUNITS=0
      IF (METRIC .EQ. 1) KUNITS=1
      IF (KUNITS .EQ. 1) GO TO 2
C  DETERMINE UNITS AND CONVERSION FACTORS FROM METRIC TO
C  ENGLISH FOR ALL QUANTITIES EXCEPT STORAGES
      CALL CNVT26 (UNIT(1),DIM(1),UNT1,CONV1,CONST1,0,IERR)
      CALL CNVT26 (UNIT(3),DIM(2),UNT2,CONV2,CONST2,0,IERR)
      CALL CNVT26 (UNIT(7),DIM(4),UNT4,CONV4,CONST4,0,IERR)
      CALL CNVT26 (UNIT(9),DIM(1),UNT5,CONV5,CONST5,0,IERR)
C
C  CONVERT STORAGES IF NECESSARY
  2   MINODT=PO(7)
      NTIM24=24/MINODT
      DELTAT=MINODT
      IM=IMETEN+1
      IF (KUNITS.NE.1)
     1   CALL CNVT26 (UNIT(5),DIM(3),UNT3,CONV3,CONST3,IM,IERR)
      IF (IMETEN.EQ.-1 .AND. METRIC.NE.1)GO TO 4
      CONV3=CONV3*DELTAT/24.
  4   CONTINUE
C
C***********************************************************************
C
C  PUNCH GENERAL INFORMATION
C
      WRITE(IPU,700)
 700  FORMAT(7HGENERAL)
      WRITE(IPU,705)(PO(I),I=2,6)
 705  FORMAT(5HTITLE,1X,1H',5A4,1H')
      IF(KUNITS.EQ.1)WRITE(IPU,708)
      IF(KUNITS.EQ.0)WRITE(IPU,710)
      IF(KUNITS.LT.0)WRITE(IPU,712)
 708  FORMAT(5HUNITS,1X,6HMETRIC)
 710  FORMAT(5HUNITS,1X,7HENGLISH,1X,4HACFT)
 712  FORMAT(5HUNITS,1X,7HENGLISH,1X,4HTIMD)
      WRITE(IPU,P)
C
C  INITIALIZE ARRAYS
      DO 10 I=1,MIDAY
         IDAY(I)=0
         X(I)=0.0
         Y(I)=0.0
10       CONTINUE
C
C  PUNCH STORAGE CURVE
      LO=PO(10)
      NVAL=PO(LO)
      IY=LO+NVAL
      DO 5 I=1,NVAL
 5       X(I)=PO(LO+I )*CONV1
      DO 7 I=1,NVAL
 7       Y(I)=PO(IY+I)*CONV3
C
      CALL FPCV26(TITLE(9),TITLE(10),TITLE(42),IDAY,X,Y,1,NVAL,0)
C
      LO=LO+2*NVAL+1
      INTP=PO(LO)
      IF(INTP .EQ. 0)WRITE(IPU,740)
      IF(INTP .GT. 0)WRITE(IPU,742)
 740  FORMAT(6HINTERP,1X,6HLINEAR)
 742  FORMAT(6HINTERP,1X,3HLOG)
      WRITE(IPU,EP)
C
C  GENERAL TIME SERIES INFORMATION
      WRITE(IPU,TS)
      LO=PO(11)+1
      DO 25 I=1,6
         IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 22
         IT=PO(LO+3)
         I2=2*I
         I1=I2-1
         WRITE(IPU,750) TSG(I1),TSG(I2),PO(LO),PO(LO+1),PO(LO+2),IT
 750  FORMAT(2A4,1X,2A4,1X,A4,1X,I2)
         LO=LO+5
         GO TO 25
 22      LO=LO+2
 25      CONTINUE
      WRITE(IPU,ETS)
C
C  PUNCH GENERAL CARRYOVER
      WRITE(IPU,CA)
      FLOW=CO(1)*CONV2
      QM=CO(2)*CONV2
      QI=CO(3)*CONV2
      POOL=CO(4)*CONV1
      P1=CO(5)*CONV1
      STOR=CO(6)*CONV3
      WRITE(IPU,730)FLOW
      WRITE(IPU,732)QM
      WRITE(IPU,733)QI
      WRITE(IPU,734)POOL
      WRITE(IPU,735)P1
      WRITE(IPU,736)STOR
 730  FORMAT(6HINFLOW,1X,F11.2)
 732  FORMAT(6HQ-MEAN,1X,F11.2)
 733  FORMAT(6HQ-INST,1X,F11.2)
 734  FORMAT(5HPOOL0,1X,F11.2)
 735  FORMAT(5HPOOL1,1X,F11.2)
 736  FORMAT(7HSTORAGE,1X,F11.2)
      WRITE(IPU,ECA)
      WRITE(IPU,738)
 738  FORMAT(7HENDGENL)
C
C  END OF GENERAL INFORMATION
C
C***********************************************************************
C
      NTS17=6
      LOC=PO(9)
      NCOMPS=PO(LOC)
      LOC=LOC+1
      IF (NCOMPS.EQ.0) GO TO 501
C
C  PUNCH SPECIFIC REGULATION SCHEME/UTILITY INFORMATION
C
      WRITE(IPU,745)
 745  FORMAT(8HSPECIFIC)
      DO 500 I=1,NCOMPS
      SUNUM=PO(LOC)
      NDUM=SUNUM/10
      IF (NDUM .NE. 154) GO TO 40
         NSU17=(SUNUM-IFIX(SUNUM)+0.01)*10
         IF (NSU17.EQ.1) NTS17=7
   40 SUNUM=PO(LOC)
      LP=PO(LOC+1)
      LT=PO(LOC+2)
      LC=PO(LOC+3)
      LOC=LOC+4
C
      IBASE=SUNUM/10
      IF (IBUG.GE.1) WRITE (IPR,*) 'IN PUC26 - IBASE=',IBASE
      LEVEL=SUNUM-IBASE*10
      IF (IBASE .GT. 150) GO TO 1500
C
C***********************************************************************
C***********************************************************************
C
C  SELECTION IS A COMPUTATIONAL SCHEME
C
      NUM=IBASE-100
      IGOTO=IBASE-100
      IF (IBUG.GE.1) WRITE (IPR,*) 'IN PUC26 - NUM=',NUM
      GO TO (100,1020,1030,1040,1050,
     *       1060,1070,1080,1090,1100,
     *       1110,1120,1130,1140,1150),IGOTO
      WRITE (IPR,95) NUM
95    FORMAT ('0**ERROR** IN PUC26 - COMPUTATIONAL SCHEME NUMBER ',I3,
     * 'CANNOT BE PROCESSED.')
      CALL ERROR
      GO TO 500
C***********************************************************************
C
C  PASS INFLOW COMPUTATIONAL SCHEME (PASSFLOW)
C
C  NO INPUT REQUIRED
C
 100  GO TO 500
C***********************************************************************
C
C  PRESCRIBED DISCHARGE COMPUTATIONAL SCHEME (SETQ)
C
 1020 WRITE(IPU,772)LEVEL
 772  FORMAT(5HSETQ(,I1,1H))
      WRITE(IPU,P)
      IOPT=PO(LP)
      IF(IOPT .GT. 0)GO TO 112
C     SPECIFIED DISCHARGE
      SQVAL=PO(LP+1)*CONV2
      ITYPE=PO(LP+2)
      LP=LP+3
      IF(ITYPE.EQ.0)WRITE(IPU,775)SQVAL
      IF(ITYPE.EQ.1)WRITE(IPU,777)SQVAL
 775  FORMAT(6HQVALUE,1X,F11.2,1X,4HMEAN)
 777  FORMAT(6HQVALUE,1X,F11.2,1X,4HINST)
      WRITE(IPU,EP)
      GO TO 796
C     DISCHARGE SPECIFIED BY A TIME SERIES
 112  WRITE(IPU,780)
 780  FORMAT(6HQVALUE,1X,2HTS)
      ITYPE=PO(LP+1)
      WRITE(IPU,785)ITYPE
 785  FORMAT(6HOPTION,1X,I5)
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES HEADERS
      WRITE(IPU,TS)
      IT=PO(LT+3)
      WRITE(IPU,790)PO(LT),PO(LT+1),PO(LT+2),IT
 790  FORMAT(4HSQTS,1X,2A4,1X,A4,1X,I2)
      WRITE(IPU,ETS)
C     PUNCH CARRYOVER IF REQUIRED
      IF(ITYPE.EQ.0)GO TO 796
      WRITE(IPU,CA)
      DO 317 J=1,ITYPE
 317  X(J)=CO(LC+J-1)*CONV2
      CALL FPCV26(TITLE(17),TITLE(18),TITLE(42),IDAY,X,Y,1,ITYPE,1)
C
      WRITE(IPU,ECA)
 796  WRITE(IPU,3072)
 3072 FORMAT(7HENDSETQ)
      GO TO 500
C***********************************************************************
C
C  PRESCRIBED ELEVATION COMPUTATIONAL SCHEME (SETH)
C
 1030 WRITE(IPU,798)LEVEL
 798  FORMAT(5HSETH(,I1,1H))
      WRITE(IPU,P)
      IOPT=PO(LP)
      IF(IOPT .GT. 0)GO TO 122
C     SPECIFIED ELEVATION
      SHVAL=PO(LP+1)*CONV1
      WRITE(IPU,805) SHVAL
 805  FORMAT(6HHVALUE,1X,F11.2)
      WRITE(IPU,EP)
      GO TO 125
C     ELEVATION SPECIFIED BY A TIME SERIES
C
 122  WRITE(IPU,810)
 810  FORMAT(6HHVALUE,1X,2HTS)
      ITYPE=PO(LP+1)
      WRITE(IPU,800)ITYPE
 800  FORMAT(6HOPTION,1X,I5)
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES HEADERS
      WRITE(IPU,TS)
      IT=PO(LT+3)
      WRITE(IPU,802)PO(LT),PO(LT+1),PO(LT+2),IT
 802  FORMAT(4HSHTS,1X,2A4,1X,A4,1X,I2)
      WRITE(IPU,ETS)
C
C     PUNCH CARRYOVER IF REQUIRED
      IF(ITYPE.EQ.0)GO TO 125
      WRITE(IPU,CA)
      DO 124 J=1,ITYPE
 124  X(J)=CO(LC+J-1)*CONV1
      CALL FPCV26(TITLE(19),TITLE(20),TITLE(42),IDAY,X,Y,1,ITYPE,1)
      WRITE(IPU,ECA)
 125  WRITE(IPU,807)
 807  FORMAT(7HENDSETH)
      GO TO 500
C***********************************************************************
C
C  RULE CURVE COMPUTATIONAL SCHEME (RULECURVE)
C
 1040 WRITE(IPU,830)LEVEL
 830  FORMAT(10HRULECURVE(,I1,1H))
      WRITE(IPU,P)
      NVAL=PO(LP)
      LO=LP
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 131
      MOVE=1
      LO=NVAL*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 131  DO 132 J=1,NVAL
 132  IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 134 J=1,NVAL
 134  Y(J)=PO(LO+J)*CONV1
C
      IF(MOVE.EQ.1) THEN 
        WRITE(IPU,832) NAMEDP(NU),INM
        LO=NLOC+1
      ELSE
        CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,NVAL,0)
        LO =LO+NVAL+1
        ITIME=PO(LO)
        LO=LO+1
        IF(ITIME.GE.0) WRITE(IPU,834)ITIME
      ENDIF
 832  FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
 834  FORMAT(8HRULETIME,1X,I5)
C
      NUMBLD=PO(LO)
      QMAX=PO(LO+1)*CONV2
      WRITE(IPU,835)NUMBLD
 835  FORMAT(5HBLEND,1X,I5)
      WRITE(IPU,837)QMAX
 837  FORMAT(4HQMAX,1X,F11.2)
      WRITE(IPU,EP)
      WRITE(IPU,838)
 838  FORMAT(7HENDRULE)
      GO TO 500
C***********************************************************************
C
C  FILL AND SPILL COMPUTATIONAL SCHEME (FILLSPILL)
C
 1050 WRITE(IPU,840)LEVEL
 840  FORMAT(10HFILLSPILL(,I1,1H))
      QLIM=PO(LP)*CONV2
      NTS=3
      LO=LP+1
 141  ITYPE=PO(LO)
      WRITE(IPU,P)
      IF(NTS.EQ.3)WRITE(IPU,852)QLIM
 852  FORMAT(4HQLIM,1X,F11.2)
      IF(ITYPE .GE. 0)GO TO 142
      LO=-1*ITYPE+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      WRITE(IPU,842)  NAMEDP(NU),INM
 842  FORMAT(4HTYPE,1X,A12,1H(,I1,1H))
      WRITE(IPU,EP)
      GO TO 894
 142  IF(ITYPE .EQ. 0)WRITE(IPU,845)
      IF(ITYPE .GT. 0)WRITE(IPU,850)
 845  FORMAT(4HTYPE,1X,3HUNC)
 850  FORMAT(4HTYPE,1X,5HGATED)
      REPLQ=PO(LO+1)*CONV2
      CREST=PO(LO+2)*CONV1
      NVAL=PO(LO+3)
      LO=LO+3
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 143
      MOVE=1
      LO=NVAL*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 143  DO 144 J=1,NVAL
 144  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 146 J=1,NVAL
 146  Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF (REPLQ .LE. 1.0E06) WRITE(IPU,855)REPLQ
      WRITE(IPU,860)CREST
 855  FORMAT(5HREPLQ,1X,F11.2)
 860  FORMAT(5HCREST,1X,F11.2)
      IF(MOVE.EQ.1)WRITE(IPU,862)  NAMEDP(NU),INM
 862  FORMAT(5HELVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(3),TITLE(4),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
      INTP=PO(LO)
      IF(INTP.EQ.0)WRITE(IPU,853)
      IF(INTP.GT.0)WRITE(IPU,854)
 853  FORMAT(6HINTERP,1X,6HLINEAR)
 854  FORMAT(6HINTERP,1X,3HLOG)
      IF(ITYPE .EQ. 0)GO TO 152
      LO=LO+1
      PASS=PO(LO)*CONV1
 152  NVAL=PO(LO+1)
      LO=LO+1
      MOVE=0
      NHVAL=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 151
      LO=NVAL*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
      MOVE=1
      GO TO 156
 151  IF(NVAL.NE.0)GO TO 156
      NHVAL=1
      GO TO 157
 156  DO 1562 J=1,NVAL
 1562 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1564 J=1,NVAL
 1564 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONVG=PO(LO+2)
      LO=LO+2
      GO TO 158
 157  RMXNSQ=PO(LO+1)*CONV2
      LO=LO+1
 158  CONSTQ=PO(LO+1)*CONV2
C
      IF(ITYPE.GT.0)WRITE(IPU,868)PASS
 868  FORMAT(6HPASSEL,1X,F11.2)
      IF(NHVAL.EQ.1)GO TO 159
      IF(MOVE.EQ.1)WRITE(IPU,874) NAMEDP(NU),INM
 874  FORMAT(7HHEADVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
      WRITE(IPU,872)ANAME(1),ANAME(2)
 872  FORMAT(7HTWCURVE,1X,2A4)
      WRITE(IPU,878)CONVG
 878  FORMAT(4HCONV,1X,F10.3)
      GO TO 875
 159  WRITE(IPU,870)RMXNSQ
 870  FORMAT(4HQGEN,1X,F11.2)
 875  WRITE(IPU,879)CONSTQ
 879  FORMAT(7HQSLUICE,1X,F11.2)
      WRITE(IPU,EP)
C     PUNCH TIME SERIES INFORMATION
C
 894  ITS=0
      LO=LT
      DO 1679 J=1,NTS
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 1680
      IF(ITS.EQ.0)WRITE(IPU,TS)
      ITS=1
      IT=PO(LO+3)
      N=J
      IF(NTS.EQ.2)N=J+1
      J2=2*N
      J1=J2-1
      WRITE(IPU,895)TS56(J1),TS56(J2),PO(LO),PO(LO+1),PO(LO+2),IT
 895  FORMAT(2A4,1X,2A4,1X,A4,1X,I2)
      LO=LO+5
      GO TO 1679
 1680 LO=LO+2
 1679 CONTINUE
      IF(ITS.EQ.1)WRITE(IPU,ETS)
C
C     PUNCH CARRYOVER IF REQUIRED
      WRITE(IPU,CA)
      C=CO(LC)*CONV2
      WRITE(IPU,897)C
 897  FORMAT(4HOLDQ,1X,F11.2)
      WRITE(IPU,ECA)
      IF(NUM.EQ.5)WRITE(IPU,899)
 899  FORMAT(7HENDFILL)
      IF(NUM.EQ.6)WRITE(IPU,898)
 898  FORMAT(7HENDSPWY)
      GO TO 500
C***********************************************************************
C
C  SPILLWAY ROUTING COMPUTATIONAL SCHEME (SPILLWAY)
C
 1060 LO=LP
      NTS=2
      WRITE(IPU,890)LEVEL
 890  FORMAT(9HSPILLWAY(,I1,1H))
C
C  USE SAME STATEMENTS AS FILL AND SPILL COMPUTATIONAL SCHEME
      GO TO 141
C***********************************************************************
C
C  POOL ELEVATION CONTROLLED DISCHARGE COMPUTATIONAL SCHEME (POOLQ)
C
 1070 WRITE(IPU,881)LEVEL
 881  FORMAT(6HPOOLQ(,I1,1H))
      WRITE(IPU,P)
      INPQ=PO(LP)
      NVAL=INPQ
      IF (INPQ .LT. 0) NVAL=-INPQ
      DO 162 J=1,NVAL
      X(J)=PO(LP+J)
 162  IF(X(J).GE.0)X(J)=X(J)*CONV1
      LO=LP+NVAL
      DO 164 J=1,NVAL
 164  Y(J)=PO(LO+J)*CONV2
      CALL FPCV26(TITLE(7),TITLE(8),TITLE(42),IDAY,X,Y,1,NVAL,0)
      IF (INPQ .LT. 0) WRITE(IPU,882)
  882 FORMAT('LINEAR')
      LO=LO+NVAL+1
      ITYPE=PO(LO)
      IF(ITYPE.EQ.0)GO TO 887
      MOVE=0
      IF(ITYPE.GT.0)GO TO 161
      MOVE=1
      LO=-1*ITYPE+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
 161  NVAL=PO(LO)
      DO 167 J=1,NVAL
 167  IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 168 J=1,NVAL
 168  Y(J)=PO(LO+J)*CONV1
C
      IF(MOVE.EQ.1)WRITE(IPU,884) NAMEDP(NU),INM
 884  FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,
     1 NVAL,0)
      IF(MOVE.EQ.1)GO TO 887
      LO=LO+NVAL+1
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPU,885)ITIME
 885  FORMAT(8HRULETIME,1X,I5)
 887  WRITE(IPU,EP)
      WRITE(IPU,886)
 886  FORMAT(8HENDPOOLQ)
      GO TO 500
C***********************************************************************
C
C  STAGE AND POOL ELEVATION CONTROLLED OUTFLOW COMPUTATIONAL SCHEME 
C  (STPOOLQ)
C
 1080 WRITE(IPU,6000)LEVEL
 6000 FORMAT(8HSTPOOLQ(,I1,1H))
      WRITE(IPU,P)
      NGAGEX=ABS(PO(LP))
      NGAGES=NGAGEX
C
C  SET UP TRIBUTARY CONTROL INDICATOR IF USED
C  = 0, D/S FLOW CONDITION CONTROL, =1, TRIBUTARY CONTROL
      ITRIB(1)=0
      ITRIB(2)=0
      IF(NGAGEX.GT.2) THEN
         NGAGES=NGAGEX/100
         DUM=PO(LP)-NGAGES*100
         ITRIB(1)=DUM/10
         ITRIB(2)=DUM-ITRIB(1)*10
      ENDIF
      LO=LP+1
      IDA=PO(LO)
      IF(IDA.EQ.0)GO TO 7004
      IDT=NTIM24
      DO 7006 J=1,IDT
 7006 X(J)=PO(LO+J)
      CALL FPCV26(TITLE(27),TITLE(28),TITLE(42),IDAY,X,Y,1,IDT,1)
      LO=LO+IDT
C
 7004 LO=LO+1
      LOCCLK = LC + 1
      DO 7000 JJ=1,NGAGES
C      IF(JJ.EQ.1)WRITE(IPU,6002)
C      IF(JJ.EQ.2)WRITE(IPU,6004)
C 6002 FORMAT(5HGAGE1)
C 6004 FORMAT(5HGAGE2)
      IF(ITRIB(JJ).EQ.0) WRITE(IPU,6002) JJ
 6002 FORMAT(4HGAGE,I1)
      IF(ITRIB(JJ).EQ.1) WRITE(IPU,6004) JJ
 6004 FORMAT(4HGAGE,I1,1X,'TRIB')
C
      LAG=PO(LO)
      ANAME(1)=PO(LO+1)
      ANAME(2)=PO(LO+2)
      WRITE(IPU,6010)LAG
 6010 FORMAT(3HLAG,1X,I5)
      IF(ANAME(1).NE.BLANK.OR.ANAME(2).NE.BLANK)
     1 WRITE(IPU,6012)ANAME(1),ANAME(2)
 6012 FORMAT(6HRATING,1X,2A4)
      CNV=CONV1
      IF(ANAME(1).EQ.BLANK.AND.ANAME(2).EQ.BLANK)CNV=CONV2
      LO=LO+3
      NREL=PO(LO)
      LO=LO+1
      DO 7008 J=1,NREL
      NPAIR=PO(LO)*.5
      TT=CTCUR(J)
      DO 7010 K=1,NPAIR
 7010 X(K)=PO(LO+K)*CNV
      LO=LO+NPAIR
      DO 7012 K=1,NPAIR
      Y(K)=PO(LO+K)
 7012 IF(Y(K).GE.0) Y(K)=Y(K)*CONV2
C 7012 Y(K)=PO(LO+K)*CONV2
      LO=LO+NPAIR+1
      CALL FPCV26(TITLE(32),TITLE(33),TT,IDAY,X,Y,1,NPAIR,0)
 7008 CONTINUE
C
      NRISE=PO(LO)
      DO 7014 J=1,NRISE
      CNV = 1.0
      IF (ABS(PO(LO+J)+999.0) .GT. 1.0) CNV = CONV1
        Y(J)=PO(LO+J)*CNV
 7014 CONTINUE
      LO=LO+NRISE
      DO 7016 J=1,NRISE
 7016 IDAY(J)=PO(LO+J)
      LO=LO+NRISE+1
      IXY26 = 1
      CALL FPCV26(TITLE(37),TITLE(38),TITLE(42),IDAY,X,Y,0,NRISE,0)
      IXY26 = 0
C
      NFALL=PO(LO)
      IF(NFALL.LE.0)GO TO 7022
      DO 7018 J=1,NFALL
      CNV = 1.0
      IF (ABS(PO(LO+J)+999.0) .GT. 1.0) CNV = CONV1
        Y(J)=PO(LO+J)*CNV
 7018 CONTINUE
      LO=LO+NFALL
      DO 7020 J=1,NFALL
 7020 IDAY(J)=PO(LO+J)
      LO=LO+NFALL
      IXY26 = 1
      CALL FPCV26(TITLE(39),TITLE(40),TITLE(42),IDAY,X,Y,0,NFALL,0)
      IXY26 = 0
C
 7022 LO=LO+1
      IF(JJ.EQ.2)GO TO 7031
      NRULE=PO(LO)
      IF(NRULE.EQ.0)GO TO 7030
      MOVE=0
      NLOC=LO
      IF(NRULE.GT.0)GO TO 7024
      MOVE=1
      LO=-1*NRULE+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
 7024 NVAL=PO(LO)

      DO 7026 J=1,NVAL
 7026 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 7028 J=1,NVAL
 7028 Y(J)=PO(LO+J)*CONV1
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC
      IF(MOVE.EQ.1)WRITE(IPU,6014) NAMEDP(NU),INM
 6014 FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,
     1 NVAL,0)
      IF(MOVE.EQ.1)GO TO 7030
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPU,6016)ITIME
 6016 FORMAT(8HRULETIME,1X,I5)
 7030 LO=LO+1
 7031 NLK=PO(LO)
      LO=LO+1
      WRITE(IPU,6017)
 6017 FORMAT(5HLAG/K)
      DO 7034 K=1,NLK
      CALL PUC7(PO(LO),MCO,LCO+LOCCLK,CO(LOCCLK))
      LOCCLK = LOCCLK + CO(LOCCLK)
      LR=LO+15
      NUMLGK=PO(LR)
      LOCK1=PO(LR+2) + LO - 1
      LOCK2=LOCK1+1
      IF(.NOT.FOP7(PO(LOCK1),PO(LOCK2)).OR.IATL.EQ.0)GO TO 7034
      NV7LK=PO(LO+NUMLGK)
      NV72LK=PO(LO+NUMLGK+1+2*NV7LK)
      NUMLGK=NUMLGK + 2 + 2*NV7LK + 2*NV72LK
 7034 LO=LO+NUMLGK
 7000 CONTINUE
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES
C
      IWRIT=0
      LOCA1 = 0
      IF(PO(LT).EQ.BLANK.AND.PO(LT+1).EQ.BLANK)GO TO 7032
      WRITE(IPU,TS)
      IWRIT=1
      LOCA1 = 1
      IT=PO(LT+3)
      WRITE(IPU,6018)PO(LT),PO(LT+1),PO(LT+2),IT
 6018 FORMAT(6HLOCAL1,1X,2A4,1X,A4,1X,I2)
      LO=LT+5
      IT=PO(LO+3)
      GO TO 7033
 7032 LO=LT+2
      IT=PO(LO+3)
 7033 IF(NGAGES.LE.1)GO TO 7035
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 7035
      IF(IWRIT.EQ.0)WRITE(IPU,TS)
      IWRIT=1
      WRITE(IPU,6020)PO(LO),PO(LO+1),PO(LO+2),IT
 6020 FORMAT(6HLOCAL2,1X,2A4,1X,A4,1X,I2)
 7035 IF(IWRIT.EQ.1)WRITE(IPU,ETS)
C
C     PUNCH CARRYOVER IF ANY
C
      LOCCO=CO(LC)
      IF(LOCCO.EQ.0)GO TO 7041
C  HERE WE HAVE STAGE-DISCHARGE CONVERSION CARRYOVER
      WRITE(IPU,CA)
      LOCCO = LC + LOCCO
      G1 = CO(LOCCO-1)*CONV2
C  SEE IF WE USED TIME-SERIES FOR LOCAL FLOW AT FIRST GAGE
      IF (LOCA1 .EQ. 1) WRITE(IPU,6021) G1
 6021 FORMAT(5HGAGE1,F10.3)
C
      DO 7040 J=1,NGAGES
      LOCCO = LOCCO + (J-1)*4
      PS=CO(LOCCO)*CONV1
      PQ=CO(LOCCO+1)*CONV2
      PC=CO(LOCCO+2)*CONV1
      NMSG = CO(LOCCO+3)
      WRITE(IPU,6022) J,PS,PQ,PC,NMSG
 6022 FORMAT(6HRATING,I1,3F10.3,I4)
 7040 CONTINUE
      WRITE (IPU,ECA)
      GO TO 7038
C  HERE WE HAVE NO STAGE-Q CONV. SEE IF LOCAL AT GAGE1 WAS FROM TS
 7041 CONTINUE
      IF (LOCA1 .EQ. 0) GO TO 7038
      LOCCO = LC + CO(LC+1) + 1
      IF (NGAGES .EQ. 2) LOCCO = LOCCO + CO(LOCCO)
      G1 = CO(LOCCO)*CONV2
      WRITE(IPU,CA)
      WRITE(IPU,6021) G1
      WRITE(IPU,ECA)
 7038 WRITE(IPU,7036)
 7036 FORMAT(7HENDSTPQ)
      GO TO 500
C***********************************************************************
C
C  DISCHARGE MINIMIZATION COMPUTATIONAL SCHEME (MINQ)
C
 1090 WRITE(IPU,901)LEVEL
 901  FORMAT(5HMINQ(,I1,1H))
      WRITE(IPU,P)
      INCOPT=PO(LP)
      HUPPER=PO(LP+1)*CONV1
      HLOWER=PO(LP+2)*CONV1
      TOL=PO(LP+3)
      WRITE(IPU,902)INCOPT
 902  FORMAT(6HINCOPT,1X,I5)
      WRITE(IPU,904)HUPPER
 904  FORMAT(6HHUPPER,1X,F11.2)
      WRITE(IPU,906)HLOWER
 906  FORMAT(6HHLOWER,1X,F11.2)
      WRITE(IPU,908)TOL
 908  FORMAT(3HTOL,1X,F10.3)
C
      LO=LP+4
      IWHICH=PO(LO)
      LO=LO+1
      IF(IWHICH.NE.0)GO TO 185
      RNORMQ=PO(LO)*CONV2
      WRITE(IPU,4025)RNORMQ
      LO=LO+1
 185  MOVE=0
      NLOC=LO
      NVAL=PO(LO)
      IF(NVAL.GT.0)GO TO 181
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 181  DO 182 J=1,NVAL
 182  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 184 J=1,NVAL
 184  Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1.AND.IWHICH.GT.0)WRITE(IPU,4022) NAMEDP(NU),INM
      IF(MOVE.EQ.1.AND.IWHICH.LT.0)WRITE(IPU,4024) NAMEDP(NU),INM
      IF(MOVE.EQ.0.AND.IWHICH.GT.0)CALL FPCV26(TITLE(3),TITLE(4),
     1 TITLE(42),IDAY,X,Y,1,NVAL,0)
      IF(MOVE.EQ.0.AND.IWHICH.LT.0)CALL FPCV26(TITLE(13),TITLE(14),
     1 TITLE(42),IDAY,X,Y,1,NVAL,0)
      IF(IWHICH.LT.0)GO TO 186
      INTP=PO(LO)
      LO=LO+1
      IF(INTP.EQ.0)WRITE(IPU,853)
      IF(INTP.EQ.1)WRITE(IPU,854)
 186  IF(IWHICH.LE.0)GO TO 1885
      NVAL=PO(LO)
      MOVE=0
      IF(NVAL.EQ.0)GO TO 1882
      NLOC=LO
      IF(NVAL.GT.0)GO TO 188
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 188  DO 1872 J=1,NVAL
 1872 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1874 J=1,NVAL
 1874 Y(J)=PO(LO+J)*CONV2
      IF(MOVE.EQ.1)WRITE(IPU,9876) NAMEDP(NU),INM
 9876  FORMAT(7HHEADVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
C
 1882 LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      WRITE(IPU,9878)ANAME(1),ANAME(2)
 9878  FORMAT(7HTWCURVE,1X,2A4)
      LO=LO+2
      CONVG=PO(LO)
      WRITE(IPU,4028) CONVG
 1885 LO=LO+1
C
cc 1885 REPLQ=PO(LO)*CONV2
      REPLQ=PO(LO)*CONV2
      NPERR=PO(LO+1)
      INCQ=PO(LO+2)
      LO=LO+3
      IF(INCQ.NE.1)GO TO 1887
      FLOODQ=PO(LO)*CONV2
      LO=LO+1
 1887 IEVOPT=PO(LO)
      NPERF=PO(LO+1)
      HTARG=PO(LO+2)*CONV1
      LO=LO+3
      IF (REPLQ .LE. 1.0E06) WRITE(IPU,912)REPLQ
 912  FORMAT(5HREPLQ,1X,F11.2)
      WRITE(IPU,914)NPERR
 914  FORMAT(5HNPERR,1X,I5)
      IF(INCQ.EQ.0)WRITE(IPU,915)FLOPT(1)
      IF(INCQ.GT.0)WRITE(IPU,915)FLOPT(2)
 915  FORMAT(4HINCQ,1X,A4)
      IF(INCQ.GT.0)WRITE(IPU,917)FLOODQ
 917  FORMAT(6HFLOODQ,1X,F11.2)
      WRITE(IPU,916)IEVOPT
 916  FORMAT(5HEVOPT,1X,I5)
      WRITE(IPU,920)NPERF
 920  FORMAT(5HNPERF,1X,I5)
      IF(HTARG.GT.0)WRITE(IPU,922)HTARG
      IF(HTARG.LT.0)WRITE(IPU,923)
 923  FORMAT(4HRULE)
 922  FORMAT(7HTARGETH,1X,F11.2)
C
      NRULE=PO(LO)
      NVAL=NRULE
      NLOC=LO
      MOVE=0
      IF(NRULE.EQ.0) GO TO 1895
      IF(NVAL.GT.0)GO TO 1890
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 1890 DO 1892 J=1,NVAL
 1892 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 1894 J=1,NVAL
 1894 X(J)=PO(LO+J)*CONV1
      IF(MOVE.EQ.1)WRITE(IPU,924) NAMEDP(NU),INM
 924  FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,
     1 NVAL,0)
C
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1)GO TO 1895
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPU,926)ITIME
 926  FORMAT(8HRULETIME,1X,I5)
 1895 LO=LO+1
      IF((INCQ.NE.1).AND.(IEVOPT.NE.2))GO TO 1896
      QLOW=PO(LO)*CONV2
      WRITE(IPU,925)QLOW
 925  FORMAT(8HLOWRLIMQ,1X,F11.2)
 1896 WRITE(IPU,EP)
      WRITE(IPU,929)
 929  FORMAT(7HENDMINQ)
      GO TO 500
C***********************************************************************
C
C  UPSTREAM STAGE MINIMIZATION COMPUTATIONAL SCHEME (MINH)
C
 1100 WRITE(IPU,930)LEVEL
 930  FORMAT(5HMINH(,I1,1H))
      WRITE(IPU,P)
      NUPST=PO(LP)
      LO=LP
      DO 192 J=1,NUPST
 192  X(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(21),TITLE(22),TITLE(42),IDAY,X,Y,1,NUPST,1)
      LO=LO+NUPST+1
      NUPP=PO(LO)
      DO 194 J=1,NUPP
 194  X(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(23),TITLE(24),TITLE(42),IDAY,X,Y,1,NUPP,1)
      LO=LO+NUPP
      NVAL=NUPP*NUPST
      DO 195 J=1,NVAL
 195  X(J)=PO(LO+J)*CONV2
      CALL FPCV26(TITLE(25),TITLE(26),TITLE(42),IDAY,X,Y,1,NVAL,1)
      LO=LO+NVAL
C
      LO=LO+1
      NLINES=PO(LO)
      ANAME(1)=CONV2
      ANAME(2)=CONV1
      ANAME(3)=CONV4
      ANAME(4)=CONV1
      ANAME(5)=CONV1
      A=AMP
      DO 198 J=1,NLINES
      NLOC=LO+J
      DO 196 K=1,5
      X(K)=PO(NLOC)*ANAME(K)
      NLOC=NLOC+NLINES
 196  CONTINUE
      IF(J.EQ.1)WRITE(IPU,950)(X(K),K=1,5),A
      IF(J.EQ.NLINES)A=BLNK1
      IF(J.NE.1)WRITE(IPU,952)(X(K),K=1,5),A
 950  FORMAT(5HRULES,5(1X,F11.2),T72,A1)
 952  FORMAT(5X,5(1X,F11.2),T72,A1)
 198  CONTINUE
C
      NVAL=5*NLINES
      LO=LO+NVAL+1
      NPER=PO(LO)
      FACT=PO(LO+1)
      REFILL=PO(LO+2)*CONV1
      FLOODQ=PO(LO+3)*CONV2
      RNORMQ=PO(LO+4)*CONV2
      NORMP=PO(LO+5)*CONV1
      LO=LO+5
      WRITE(IPU,9952) NPER
 9952 FORMAT(8HNPERIODS,1X,I5)
      WRITE(IPU,954)FACT
 954  FORMAT(6HFACTOR,1X,F11.2)
      WRITE(IPU,956)REFILL
 956  FORMAT(6HREFILL,1X,F11.2)
      WRITE(IPU,958)FLOODQ
 958  FORMAT(6HFLOODQ,1X,F11.2)
      WRITE(IPU,960)RNORMQ
 960  FORMAT(7HNORMALQ,1X,F11.2)
C
      LO=LO+1
      IF(NORMP.GT.0)GO TO 1992
      WRITE(IPU,961)
 961  FORMAT(4HRULE)
      NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GT.0)GO TO 1982
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 1982 DO 1984 J=1,NVAL
 1984 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 1986 J=1,NVAL
 1986 X(J)=PO(LO+J)*CONV1
      IF(MOVE.EQ.1)WRITE(IPU,966) NAMEDP(NU),INM
 966  FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,
     1 NVAL,0)
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1)GO TO 1994
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPU,968)ITIME
 968  FORMAT(8HRULETIME,1X,I5)
      LO=LO+1
      GO TO 1994
 1992 WRITE(IPU,962)NORMP
 962  FORMAT(8HNORMPOOL,1X,I5)
C
 1994 NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 1995
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      MOVE=1
      NVAL=PO(LO)
 1995 DO 1996 J=1,NVAL
 1996 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1997 J=1,NVAL
 1997 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1)WRITE(IPU,970) NAMEDP(NU),INM
 970  FORMAT(5HELVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(3),TITLE(4),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
C
      NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 1960
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
      MOVE=1
      GO TO 1964
 1960 IF(NVAL.NE.0)GO TO 1964
      NHVAL=1
      GO TO 1966
 1964 DO 1968 J=1,NVAL
 1968 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1970 J=1,NVAL
 1970 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      GO TO 1972
 1966 CONSTQ=PO(LO+1)*CONV2
 1972 INT=PO(LO+2)
C
      IF(NHVAL.EQ.1)GO TO 1977
      IF(MOVE.EQ.1)WRITE(IPU,978) NAMEDP(NU),INM
 978  FORMAT(7HHEADVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
      WRITE(IPU,974)ANAME(1),ANAME(2)
 974  FORMAT(7HTWCURVE,1X,2A4)
      GO TO 1978
 1977 WRITE(IPU,964)CONSTQ
 964  FORMAT(6HCONSTQ,1X,F11.2)
 1978 IF(INT.EQ.0)WRITE(IPU,975)
      IF(INT.GT.0)WRITE(IPU,976)
 975  FORMAT(6HINTERP,1X,6HLINEAR)
 976  FORMAT(6HINTERP,1X,3HLOG)
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES
      WRITE(IPU,TS)
      LO=LT
      DO 1979 J=1,2
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 1981
      IT=PO(LO+3)
      J1=2*J
      J2=J1-1
      WRITE(IPU,980)TS10(J2),TS10(J1),PO(LO),PO(LO+1),PO(LO+2),IT
 980  FORMAT(2A4,1X,2A4,1X,A4,1X,I2)
      LO=LO+5
      GO TO 1979
 1981 LO=LO+2
 1979 CONTINUE
      WRITE(IPU,ETS)
C
C  PUNCH CARRYOVER
      WRITE(IPU,CA)
      WRITE(IPU,982)CO(LC)
 982  FORMAT(3HUPQ,1X,F11.2)
      LC=LC+1
      WRITE(IPU,984)CO(LC),CO(LC+1)
 984  FORMAT(7HUPSTAGE,2(1X,F11.2))
      WRITE(IPU,ECA)
      WRITE(IPU,985)
 985  FORMAT(7HENDMINH)
      GO TO 500
C***********************************************************************
C
C  INDUCED SURCHARGE COMPUTATIONAL SCHEME (INDSRCHGE)
C
 1110 WRITE(IPU,6025)LEVEL
 6025 FORMAT(10HINDSRCHGE(,I1,1H))
      WRITE(IPU,P)
C
C  POINTER FOR ADDITIONAL VARIABLES FOR 1993 FEBRUARY MANUAL
      LO=LP+4
      NSCQI=PO(LO)
      NSCEL=PO(LO+1)
      LO=LO+1
      LO=LO+NSCQI
      LO=LO+NSCEL
      NSCQO=NSCQI*NSCEL
      LO=LO+NSCQO+2
      NDT=PO(LO)
      LO=LO+1
      DO 7110 J=1,10
 7110 EMTY(J)=BLANK
      NLINES=PO(LO)
      LO=LO+1
      IF(NDT.GT.3)GO TO 7112
      DO 7114 J=1,NLINES
      N=PO(LO+1)
      EMTY(N)=AMP
      LO=LO+2
 7114 CONTINUE
      GO TO 7118
C
 7112 DO 7116 J=1,NLINES
      N=PO(LO+2)
      EMTY(N)=AMP
      LO=LO+3
 7116 CONTINUE
 7118 NOPT=0
      KI=0
      DO 7120 J=1,10
      IF(EMTY(J).EQ.BLANK)GO TO 7120
      KI=KI+1
      LISTOP(KI)=J
      NOPT=KI
 7120 CONTINUE
      DO 7122 J=1,8
 7122 NEEDIT(J)=.FALSE.
      DO 7124 KK=1,NOPT
      IOPT=LISTOP(KK)
      DO 7126 N=1,8
      NEEDIT(N)=NEEDIT(N).OR.NEEDVA(N,IOPT)
 7126 CONTINUE
 7124 CONTINUE
      IF(NEEDIT(1)) LO=LO+1
      IF(NEEDIT(2)) LO=LO+1
      IF(NEEDIT(3)) LO=LO+1
      IF(NEEDIT(4)) LO=LO+1
      IF(NEEDIT(5)) LO=LO+1
      IF(NEEDIT(6)) LO=LO+1
      IF(NEEDIT(7)) LO=LO+1
      IF(.NOT.NEEDIT(8)) GO TO 7154
      NGEL=PO(LO)
      LO=LO+1
      NGO=PO(LO)
      LO=LO+NGEL
      LO=LO+NGO
      NGA=NGEL*NGO
      LO=LO+NGA+2
7154  LO=LO+1
      NR=PO(LO)
      IF(NR.GT.0) LO=LO+2*NR+1
      LO=LO+1
      L9302=LO
      I9302=PO(L9302)
      HUP=PO(LP)
      LO=LP+1
      HCH=PO(LO)
      HLO=PO(LO+1)
      LO=LO+2
C
      IF(I9302.NE.199302) GO TO 7210
      IHRSCH=PO(L9302+1)
      IF(IHRSCH.GT.0) WRITE(IPU,7211)IHRSCH
 7211 FORMAT(8HHRSCHECK,1X,I5)
 7210 CONTINUE
C
      IF(HUP.GT.0.)GO TO 6142
      FACT=(HUP+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,6120)FACT
      IF(FACT.GT..001)WRITE(IPU,6122)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,6120)
 6120 FORMAT(6HHUPPER,1X,4HRULE,F5.2)
 6122 FORMAT(6HHUPPER,1X,5HRULE+,F4.2)
      GO TO 6144
 6142 HUP=HUP*CONV1
      WRITE(IPU,6028)HUP
 6028 FORMAT(6HHUPPER,1X,F11.2)
 6144 CONTINUE
C
      IF(HLO.GT.0.)GO TO 7046
      FACT=(HLO+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,6036)FACT
      IF(FACT.GT..001)WRITE(IPU,6038)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,6036)
 6036 FORMAT(6HHLOWER,1X,4HRULE,F5.2)
 6038 FORMAT(6HHLOWER,1X,5HRULE+,F4.2)
      GO TO 7048
 7046 HLO=HLO*CONV1
      WRITE(IPU,6040)HLO
 6040 FORMAT(6HHLOWER,1X,F11.2)
 7048 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7320
      IX=PO(L9302+12)
      IF(IX.EQ.-999) GO TO 7320
      QGENMX=PO(L9302+12)*CONV2
      WRITE(IPU,7321)QGENMX
 7321 FORMAT(7HQGENMAX,1X,F11.2)
 7320 CONTINUE
C
      IX=HCH
      IF(IX.EQ.-9998) GO TO 7044
      IF(HCH.GT.0.)GO TO 7042
      FACT=(HCH+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,6030)FACT
      IF(FACT.GT..001)WRITE(IPU,6032)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,6030)
 6030 FORMAT(6HHCHECK,1X,4HRULE,F5.2)
 6032 FORMAT(6HHCHECK,1X,5HRULE+,F4.2)
      GO TO 7044
 7042 HCH=HCH*CONV1
      WRITE(IPU,6034)HCH
 6034 FORMAT(6HHCHECK,1X,F11.2)
 7044 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7230
      IX=PO(L9302+2)
      IF(IX.EQ.-999) GO TO 7220
      QCHECK=PO(L9302+2)*CONV2
      WRITE(IPU,7221)QCHECK
 7221 FORMAT(6HQCHECK,1X,F11.2)
 7220 IX=PO(L9302+3)
      IF(IX.EQ.-999) GO TO 7230
      QDIFF=PO(L9302+3)*CONV2
      WRITE(IPU,7231)QDIFF
 7231 FORMAT(6HQDIFF ,1X,F11.2)
 7230 CONTINUE
      ICP=PO(LO)
      LO=LO+1
      WRITE(IPU,6080)ICP
 6080 FORMAT(7HCOMPINQ,1X,I5)
      NSCQI=PO(LO)
      NSCEL=PO(LO+1)
      LO=LO+1
      DO 7050 J=1,NSCQI
 7050 X(J)=PO(LO+J)*CONV2
      CALL FPCV26(TITLE(41),TITLE(42),TITLE(42),IDAY,X,Y,1,NSCQI,1)
      LO=LO+NSCQI
      DO 7052 J=1,NSCEL
 7052 X(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(43),TITLE(42),TITLE(42),IDAY,X,Y,1,NSCEL,1)
      LO=LO+NSCEL
      NSCQO=NSCQI*NSCEL
      LOX=LO
      DO 7054 J=1,NSCEL
 7054 X(J)=PO(LOX+J)*CONV2
      MULT=2
      CALL FPCV26(TITLE(44),TITLE(42),TITLE(42),IDAY,X,Y,1,NSCEL,2)
      DO 7555 ISCQI=2,NSCQI
      LOX=LOX+NSCEL
      DO 7554 J=1,NSCEL
 7554 X(J)=PO(LOX+J)*CONV2
      IF (ISCQI.EQ.NSCQI) MULT=1
 7555 CALL FPCV26(BLANK,BLANK,BLANK,IDAY,X,Y,1,NSCEL,MULT)
      LO=LO+NSCQO+1
C
      IF(I9302.NE.199302) GO TO 7310
      IX=PO(L9302+9)
      IF(IX.EQ.-999) GO TO 7290
      SCQIMN=PO(L9302+9)
      WRITE(IPU,7291) SCQIMN
 7291 FORMAT(7HMINSCQI,1X,A4)
 7290 IX=PO(L9302+11)
      IF(IX.EQ.-999) GO TO 7310
      SCQOMN=PO(L9302+11)*CONV2
      WRITE(IPU,7311)SCQOMN
 7311 FORMAT(7HMINSCQO,1X,F11.2)
 7310 CONTINUE
C
      CONVG=PO(LO)
      NDT=PO(LO+1)
      WRITE(IPU,6042)CONVG
 6042 FORMAT(4HCONV,1X,F5.3)
      WRITE(IPU,6043)NDT
 6043 FORMAT(5HDTYPE,1X,I3)
      LO=LO+2
      DO 7055 J=1,10
 7055 EMTY(J)=BLNK1
      NLINES=PO(LO)
      LO=LO+1
      IF(NDT.GT.3)GO TO 7058
      A=AMP
      DO 7056 J=1,NLINES
      IPO=PO(LO+1)
      IF(J.EQ.NLINES)A=BLNK1
      CNV = CONV1
      IF (NDT .EQ. 2) CNV = CONV2
      PV1 = PO(LO)*CNV
      IF(J.EQ.1)WRITE(IPU,6044)PV1,IPO,A
 6044 FORMAT(6HDTABLE,1X,F11.2,1X,I5,T72,A1)
      IF(J.NE.1)WRITE(IPU,6046)PV1,IPO,A
 6046 FORMAT(7X,F11.2,1X,I5,T72,A1)
      N=PO(LO+1)
      EMTY(N)=AMP
      LO=LO+2
 7056 CONTINUE
      GO TO 7061
C
7058  A=AMP
      DO 7060 J=1,NLINES
      IPO=PO(LO+2)
      IF(J.EQ.NLINES)A=BLNK1
      PV1 = PO(LO)*CONV1
      PV2 = PO(LO+1)*CONV2
      IF(NLINES.EQ.1)WRITE(IPU,6048)PV1,PV2,IPO,A
      IF(NLINES.NE.1)WRITE(IPU,6050)PV1,PV2,IPO,A
 6048 FORMAT(6HDTABLE,1X,F11.2,1X,F11.2,1X,I5,T72,A1)
 6050 FORMAT(7X,F11.2,1X,F11.2,1X,I5,T72,A1)
      N=PO(LO+2)
      EMTY(N)=AMP
      LO=LO+3
 7060 CONTINUE
C
C     CHECK 'EMTY' TO SEE WHICH OPTIONS HAVE BEEN SELECTED
C     (POSITION CONTATINS AN AMPERSAND)
 7061 NOPT=0
      KI=0
      DO 7057 J=1,10
      IF(EMTY(J).EQ.BLNK1)GO TO 7057
      KI=KI+1
      LISTOP(KI)=J
      NOPT=KI
 7057 CONTINUE
      DO 7059 J=1,8
 7059 NEEDIT(J)=.FALSE.
      DO 7062 KK=1,NOPT
      IOPT=LISTOP(KK)
      DO 7063 N=1,8
      NEEDIT(N)=NEEDIT(N).OR.NEEDVA(N,IOPT)
 7063 CONTINUE
 7062 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7340
      IX=PO(L9302+10)
      IF(IX.EQ.-9998) GO TO 7300
      HPREVQ=PO(L9302+10)
      IF(HPREVQ.GT.0.)GO TO 7304
      FACT=(HPREVQ+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,7301)FACT
      IF(FACT.GT..001)WRITE(IPU,7302)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,7301)
 7301 FORMAT(6HHPREVQ,1X,4HRULE,F5.2)
 7302 FORMAT(6HHPREVQ,1X,5HRULE+,F4.2)
      GO TO 7300
 7304 HPREVQ=HPREVQ*CONV1
      WRITE(IPU,7305)HPREVQ
 7305 FORMAT(6HHPREVQ,1X,F11.2)
 7300 CONTINUE
      IX=PO(L9302+14)
      IF(IX.EQ.-9998) GO TO 7340
      HEVACE=PO(L9302+14)
      IF(HEVACE.GT.0.)GO TO 7344
      FACT=(HEVACE+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,7341)FACT
      IF(FACT.GT..001)WRITE(IPU,7342)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,7341)
 7341 FORMAT(8HHEVACEND,1X,4HRULE,F5.2)
 7342 FORMAT(8HHEVACEND,1X,5HRULE+,F4.2)
      GO TO 7340
 7344 HEVACE=HEVACE*CONV1
      WRITE(IPU,7345)HEVACE
 7345 FORMAT(8HHEVACEND,1X,F11.2)
 7340 CONTINUE
C
      IF(.NOT.NEEDIT(1))GO TO 7068
      HTARG=PO(LO)
      IF(HTARG.GT.0.)GO TO 7064
      FACT=(HTARG+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,6052)FACT
      IF(FACT.GT..001)WRITE(IPU,6054)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,6052)
 6052 FORMAT(8HHTARGET1,1X,4HRULE,F5.2)
 6054 FORMAT(8HHTARGET1,1X,5HRULE+,F4.2)
      GO TO 7066
 7064 HTARG=HTARG*CONV1
      WRITE(IPU,6056)HTARG
 6056 FORMAT(8HHTARGET1,1X,F11.2)
 7066 LO=LO+1
 7068 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7250
      IX=PO(L9302+4)
      IF(IX.EQ.-9998) GO TO 7240
      HTARG2=PO(L9302+4)
      IF(HTARG2.GT.0.)GO TO 7244
      FACT=(HTARG2+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,7241)FACT
      IF(FACT.GT..001)WRITE(IPU,7242)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,7241)
 7241 FORMAT(8HHTARGET2,1X,4HRULE,F5.2)
 7242 FORMAT(8HHTARGET2,1X,5HRULE+,F4.2)
      GO TO 7240
 7244 HTARG2=HTARG2*CONV1
      WRITE(IPU,7245)HTARG2
 7245 FORMAT(8HHTARGET2,1X,F11.2)
 7240 CONTINUE
      IX=PO(L9302+5)
      IF(IX.EQ.-9998) GO TO 7250
      HTARG3=PO(L9302+5)
      IF(HTARG3.GT.0.)GO TO 7254
      FACT=(HTARG3+999.)*CONV1
      IF(FACT.LT.-.001)WRITE(IPU,7251)FACT
      IF(FACT.GT..001)WRITE(IPU,7252)FACT
      IF(FACT.GT.-.001 .AND. FACT.LT..001)WRITE(IPU,7251)
 7251 FORMAT(8HHTARGET3,1X,4HRULE,F5.2)
 7252 FORMAT(8HHTARGET3,1X,5HRULE+,F4.2)
      GO TO 7250
 7254 HTARG3=HTARG3*CONV1
      WRITE(IPU,7255)HTARG3
 7255 FORMAT(8HHTARGET3,1X,F11.2)
 7250 CONTINUE
      IF(.NOT.NEEDIT(2))GO TO 7070
      DIFQI1=PO(LO)*CONV2
      LO=LO+1
 7070 IF(.NOT.NEEDIT(3))GO TO 7072
      RED=PO(LO)*CONV2
      WRITE(IPU,6060)RED
 6060 FORMAT(7HREDUCE ,1X,F11.2)
      LO=LO+1
 7072 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7270
      IX=PO(L9302+6)
      IF(IX.EQ.-999) GO TO 7260
      REDUC1=PO(L9302+6)*CONV2
      WRITE(IPU,7261)REDUC1
 7261 FORMAT(7HREDUCE1,1X,F11.2)
 7260 CONTINUE
      IX=PO(L9302+7)
      IF(IX.EQ.-999) GO TO 7270
      REDUC2=PO(L9302+7)*CONV2
      WRITE(IPU,7271)REDUC2
 7271 FORMAT(7HREDUCE2,1X,F11.2)
 7270 CONTINUE
      IF(.NOT.NEEDIT(4))GO TO 7074
      QT1=PO(LO)*CONV2
      WRITE(IPU,6062)QT1
 6062 FORMAT(8HQTARGET1,1X,F11.2)
      LO=LO+1
 7074 IF(.NOT.NEEDIT(5))GO TO 7076
      QT2=PO(LO)*CONV2
      WRITE(IPU,6064)QT2
 6064 FORMAT(8HQTARGET2,1X,F11.2)
      LO=LO+1
 7076 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7280
      IX=PO(L9302+8)
      IF(IX.EQ.-999) GO TO 7280
      QTARG3=PO(L9302+8)*CONV2
      WRITE(IPU,7281)QTARG3
 7281 FORMAT(8HQTARGET3,1X,F11.2)
 7280 CONTINUE
      IF(NEEDIT(2)) WRITE(IPU,6058)DIFQI1
 6058 FORMAT(7HDIFFQI1,1X,F11.2)
      IF(.NOT.NEEDIT(6))GO TO 7082
      DIFF=PO(LO)*CONV2
      WRITE(IPU,6070)DIFF
 6070 FORMAT(7HDIFFQI2,1X,F11.2)
      LO=LO+1
 7082 IF(.NOT.NEEDIT(7))GO TO 7084
      DIFF=PO(LO)*CONV2
      WRITE(IPU,6072)DIFF
 6072 FORMAT(7HDIFFQI3,1X,F11.2)
      LO=LO+1
 7084 CONTINUE
C
      IF(I9302.NE.199302) GO TO 7330
      IX=PO(L9302+13)
      IF(IX.EQ.-999) GO TO 7330
      PEAKQ1=PO(L9302+13)*CONV2
      WRITE(IPU,7331)PEAKQ1
 7331 FORMAT(7HPEAKQO1,1X,F11.2)
 7330 CONTINUE
      IF(.NOT.NEEDIT(8))GO TO 7092
      NGEL=PO(LO)
      LO=LO+1
      LOEL=LO
      NGO=PO(LO)
      LO=LO+NGEL
      DO 7088 J=1,NGO
 7088 X(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(45),TITLE(47),TITLE(42),IDAY,X,Y,1,NGO,1)
      DO 7086 J=1,NGEL
 7086 X(J)=PO(LOEL+J)*CONV1
      CALL FPCV26(TITLE(45),TITLE(46),TITLE(42),IDAY,X,Y,1,NGEL,1)
      LO=LO+NGO
      NGA=NGEL*NGO
      LOX=LO
      DO 7090 J=1,NGEL
 7090 X(J)=PO(LOX+J)*CONV2
      MULT=2
      CALL FPCV26(TITLE(45),TITLE(48),TITLE(42),IDAY,X,Y,1,NGEL,MULT)
      DO 7591 IGO=2,NGO
      LOX=LOX+NGEL
      DO 7590 J=1,NGEL
 7590 X(J)=PO(LOX+J)*CONV2
      IF (IGO.EQ.NGO) MULT=1
 7591 CALL FPCV26(BLANK,BLANK,BLANK,IDAY,X,Y,1,NGEL,MULT)
      LO=LO+NGA+1
      IGS=PO(LO)
      LO=LO+1
      WRITE(IPU,6078)IGS
 6078 FORMAT(7HGATESET,1X,I5)
 7092 IOP=PO(LO)
      WRITE(IPU,6082)IOP
 6082 FORMAT(6HIOPTND,1X,I5)
      LO=LO+1
      NR=PO(LO)
      IF(NR.EQ.0)GO TO 8000
      IF(NR.GT.0)GO TO 7094
      LO=NR*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      WRITE(IPU,6084) NAMEDP(NU),INM
 6084 FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      GO TO 8000
 7094 DO 7096 J=1,NR
 7096 IDAY(J)=PO(LO+J)
      LO=LO+NR
      DO 7098 J=1,NR
 7098 Y(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,NR,0)
      LO=LO+NR+1
      ITR=PO(LO)
      WRITE(IPU,6086)ITR
 6086 FORMAT(8HRULETIME,1X,I5)
 8000 WRITE(IPU,EP)
C
C     PUNCH CARRYOVER
      WRITE(IPU,CA)
      C1=CO(LC)*CONV2
      WRITE(IPU,6088)C1
 6088 FORMAT(6HBACKQI,1X,F11.2)
      C2=CO(LC+1)*CONV1
      WRITE(IPU,6090)C2
 6090 FORMAT(8HBACKPOOL,1X,F11.2)
      LO=LC+2
      TEND=CO(LO)
      IF(TEND.LE.-999.)GO TO 8002
      TEND=TEND*CONV1
      WRITE(IPU,6092)TEND
 6092 FORMAT(8HTENDENCY,1X,F11.2)
 8002 RMAX=CO(LO+1)
      IF(RMAX.LE.-999.)GO TO 8004
      RMAX=RMAX*CONV1
      WRITE(IPU,6094)RMAX
      QMAX=CO(LO+2)*CONV2
      WRITE(IPU,6095)QMAX
 6094 FORMAT(5HMAXEL,1X,F11.2)
 6095 FORMAT(6HQMAXEL,1X,F11.2)
 8004 RMQ=CO(LO+3)
      IF(RMQ.LE.-999.)GO TO 8006
      RMQ=RMQ*CONV2
      WRITE(IPU,6096)RMQ
 6096 FORMAT(4HQMAX,1X,F11.2)
 8006 WRITE(IPU,ECA)
      WRITE(IPU,6098)
 6098 FORMAT(7HENDINDS)
      GO TO 500
C***********************************************************************
C
C  FLASHBOARDS COMPUTATIONAL SCHEME (FLASHBDS)
C
 1120 WRITE(IPU,9000)LEVEL
 9000 FORMAT(9HFLASHBDS(,I1,1H))
      WRITE(IPU,P)
      NBL=PO(LP)
      LO=LP+1
      NBS=PO(LO)
      WRITE(IPU,9002)NBL,NBS
 9002 FORMAT(7HNBOARDS,I4,3X,I4)
      LO=LO+1
      X(1)=PO(LO)*CONV1
      X(2)=PO(LO+1)*CONV1
      X(3)=PO(LO+2)*CONV1
      X(4)=PO(LO+3)*CONV1
      X(5)=PO(LO+4)*CONV1
      LO=LO+5
      WRITE(IPU,9006)(X(J),J=1,5)
 9006 FORMAT(6HGENL-L,1X,5F11.2)
      NRATEL=PO(LO)
      DO 8008 J=1,NRATEL
 8008 X(J)=PO(LO+J)*CONV1
      LO=LO+NRATEL
      DO 8010 J=1,NRATEL
 8010 Y(J)=PO(LO+J)*CONV2
      CALL FPCV26(TITLE(49),TITLE(50),TITLE(42),IDAY,X,Y,1,NRATEL,0)
      LO=LO+NRATEL+1
      IF(NBS.LE.0)GO TO 8016
      X(1)=PO(LO)*CONV1
      X(2)=PO(LO+1)*CONV1
      X(3)=PO(LO+2)*CONV1
      X(4)=PO(LO+3)*CONV1
      X(5)=PO(LO+4)*CONV1
      LO=LO+5
      WRITE(IPU,9008)(X(J),J=1,5)
 9008 FORMAT(6HGENL-S,1X,5F11.2)
      NRATES=PO(LO)
      DO 8012 J=1,NRATES
 8012 X(J)=PO(LO+J)*CONV1
      LO=LO+NRATES
      DO 8014 J=1,NRATES
 8014 Y(J)=PO(LO+J)*CONV2
      CALL FPCV26(TITLE(49),TITLE(51),TITLE(42),IDAY,X,Y,1,NRATES,0)
      LO=LO+NRATES+1
 8016 IWHICH=PO(LO)
      LO=LO+1
      IF(IWHICH.NE.1)GO TO 8022
      X(1)=PO(LO)*CONV1
      X(2)=PO(LO+1)*CONV1
      X(3)=PO(LO+2)*CONV1
      NFP=PO(LO+3)
      LO=LO+4
      WRITE(IPU,9010)(X(J),J=1,3),NFP
 9010 FORMAT(6HGENL-G,1X,3F11.2,I5)
      NRATEG=PO(LO)
      DO 8018 J=1,NRATEG
 8018 X(J)=PO(LO+J)*CONV1
      LO=LO+NRATEG
      DO 8020 J=1,NRATEG
 8020 Y(J)=PO(LO+J)*CONV2
      LO=LO+NRATEG+1
      CALL FPCV26(TITLE(49),TITLE(52),TITLE(42),IDAY,X,Y,1,NRATEG,0)
 8022 REPLQ=PO(LO)*CONV2
      IF (REPLQ.LE.1.0E06 .AND. REPLQ.GE.0.0) WRITE(IPU,9012)REPLQ
 9012 FORMAT(5HREPLQ,1X,F11.2)
      LO=LO+1
      NHEAD=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NHEAD.GE.0)GO TO 8024
      MOVE=1
      LO=-1*NHEAD+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      LO=NLOC+1
      WRITE(IPU,9014) NAMEDP(NU),INM
 9014 FORMAT(7HHEADVSQ,1X,A12,1H(,I1,1H))
      GO TO 8032
 8024 IF(NHEAD.EQ.0)GO TO 8030
      DO 8026 J=1,NHEAD
 8026 X(J)=PO(LO+J)*CONV1
      LO=LO+NHEAD
      DO 8028 J=1,NHEAD
 8028 Y(J)=PO(LO+J)*CONV2
      LO=LO+NHEAD+1
      CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,NHEAD,0)
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONVG=PO(LO+2)
      LO=LO+3
      WRITE(IPU,9016)ANAME(1),ANAME(2)
 9016 FORMAT(7HTWCURVE,1X,2A4)
      WRITE(IPU,9018)CONVG
 9018 FORMAT(4HCONV,1X,F11.2)
      GO TO 8032
 8030 GENQ=PO(LO+1)*CONV2
      LO=LO+2
      WRITE(IPU,9020)GENQ
 9020 FORMAT(4HGENQ,1X,F11.2)
 8032 SLU=PO(LO)*CONV2
      WRITE(IPU,9022)SLU
 9022 FORMAT(7HSLUICEQ,1X,F11.2)
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES IF ANY
      LO=LT
      NFIRST=0
      DO 8034 J=1,5
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 8036
      IF(NFIRST.EQ.0)WRITE(IPU,TS)
      NFIRST=1
      IT=PO(LO+3)
      J1=2*J
      J2=J1-1
      WRITE(IPU,9026)TS12(J2),TS12(J1),PO(LO),PO(LO+1),PO(LO+2),IT
 9026 FORMAT(2A4,1X,2A4,1X,A4,I2)
      LO=LO+5
      GO TO 8034
 8036 LO=LO+2
 8034 CONTINUE
      IF(NFIRST.EQ.1)WRITE(IPU,ETS)
C
C     PUNCH CARRYOVER
      WRITE(IPU,CA)
      LC=LC+1
      IF(NBS.GT.0)GO TO 8038
      IC1=CO(LC)
      LC=LC+1
      WRITE(IPU,9028)IC1
 9028 FORMAT(4HDOWN,1X,I5)
      GO TO 8040
 8038 IC1=CO(LC)
      IC2=CO(LC+1)
      LC=LC+2
      WRITE(IPU,9030)IC1,IC2
 9030 FORMAT(4HDOWN,1X,2I5)
 8040 IF(IWHICH.EQ.0)GO TO 8045
      GATE=CO(LC)*CONV1
      LC = LC+2
      IF(GATE.GT.0.0) WRITE(IPU,9032)GATE
 9032 FORMAT(4HGATE,1X,F11.2)
C
 8045 QNSP = CO(LC)*CONV2
      WRITE(IPU,9033) QNSP
 9033 FORMAT(4HOLDQ,1X,F11.2)
      WRITE(IPU,ECA)
      WRITE(IPU,9034)
 9034 FORMAT(8HENDFLASH)
      GO TO 500
C***********************************************************************
C
C  POWER GENERATION COMPUTATIONAL SCHEME (POWERGEN)
C
 1130 WRITE(IPU,9040)LEVEL
 9040 FORMAT(9HPOWERGEN(,I1,1H))
      WRITE(IPU,P)
      NTOD=PO(LP)
      LO=LP
      IF(NTOD.GE.0) WRITE(IPU,9042)NTOD
 9042 FORMAT(3HTOD,1X,I5)
      NDA=NTIM24
      DO 8046 J=1,NDA
 8046 X(J)=PO(LO+J)
      CALL FPCV26(TITLE(53),TITLE(54),TITLE(42),IDAY,X,Y,1,NDA,1)
      LO=LO+NDA+1
      NDOW=PO(LO)
      IF(NDOW.LT.0)GO TO 8047
      WRITE(IPU,9044)NDOW
 9044 FORMAT(3HDOW,1X,I5)
      WRITE(IPU,9046)(PO(LO+J),J=1,7)
 9046 FORMAT(6HWEEKLY,1X,7F7.2)
      LO=LO+7
 8047 LO=LO+1
      DMIN=PO(LO)
      IF(DMIN.LT.0)GO TO 8049
      DMIN=DMIN*CONV2
      WRITE(IPU,9048)DMIN
 9048 FORMAT(7HMINQDAY,1X,F11.2)
 8049 LO=LO+1
      WMIN=PO(LO)
      IF(WMIN.LT.0)GO TO 8050
      WMIN=WMIN*CONV2
      WRITE(IPU,9050)WMIN
 9050 FORMAT(8HMINQWEEK,1X,F11.2)
 8050 NVAL=PO(LO+1)
      LO=LO+1
      IF(NVAL.EQ.0)GO TO 8058
      IF(NVAL.EQ.1)GO TO 8056
      DO 8052 J=1,NVAL
 8052 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 8054 J=1,NVAL
 8054 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL
      CALL FPCV26(TITLE(55),TITLE(56),TITLE(57),IDAY,X,Y,0,NVAL,0)
      GO TO 8058
 8056 QMIN=PO(LO+1)*CONV2
      LO=LO+1
      WRITE(IPU,9052) QMIN
 9052 FORMAT(8HMINQINST,1X,F11.2)
C
 8058 LO = LO+1
      IHUPP=PO(LO)
      IF(IHUPP.GT.1)GO TO 8062
      VAL=PO(LO+1)
      LO=LO+1
      IF(VAL.LT.0.0)GO TO 8059
      VAL=VAL*CONV1
      WRITE(IPU,9054)VAL
 9054 FORMAT(6HHUPPER,1X,F11.2)
      GO TO 8068
 8059 IF(IFMSNG(VAL).EQ.0)GO TO 8060
      WRITE(IPU,9056)
 9056 FORMAT(6HHUPPER,5X,4HRULE)
      GO TO 8068
 8060 VAL=(VAL+999.)*CONV1
      WRITE(IPU,9058)VAL
 9058 FORMAT(6HHUPPER,5X,5HRULE+,F4.2)
      GO TO 8068
 8062 DO 8064 J=1,IHUPP
 8064 IDAY(J)=PO(LO+J)
      LO=LO+IHUPP
      DO 8066 J=1,IHUPP
 8066 Y(J)=PO(LO+J)*CONV1
      LO=LO+IHUPP
      CALL FPCV26(TITLE(58),TITLE(59),TITLE(42),IDAY,X,Y,0,IHUPP,0)
C
 8068 LO=LO+1
      IHLOW=PO(LO)
      IF(IHLOW.GT.1)GO TO 8072
      VAL=PO(LO+1)
      LO=LO+1
      IF(VAL.LE.0.0)GO TO 8069
      VAL=VAL*CONV1
      WRITE(IPU,9060)VAL
 9060 FORMAT(6HHLOWER,1X,F11.2)
      GO TO 8078
C
 8069 IF(IFMSNG(VAL).EQ.0)GO TO 8070
      WRITE(IPU,9062)
 9062 FORMAT(6HHLOWER,5X,4HRULE)
      GO TO 8078
 8070 VAL=(VAL+999.)*CONV1
      WRITE(IPU,9064)VAL
 9064 FORMAT(6HHLOWER,5X,4HRULE,F5.2)
      GO TO 8078
 8072 DO 8074 J=1,IHLOW
 8074 IDAY(J)=PO(LO+J)
      LO=LO+IHLOW
      DO 8076 J=1,IHLOW
 8076 Y(J)=PO(LO+J)*CONV1
      LO=LO+IHLOW
      CALL FPCV26(TITLE(60),TITLE(61),TITLE(42),IDAY,X,Y,0,IHLOW,1)
C
 8078 LO=LO+1
      DSM=PO(LO)
      IF(DSM.LT.0.)GO TO 8080
      WRITE(IPU,9066)DSM
 9066 FORMAT(6HDSMAXQ,1X,F11.2)
 8080 QGEN=PO(LO+1)*CONV2
      LO=LO+2
      WRITE(IPU,9068)QGEN
 9068 FORMAT(7HQGENMAX,1X,F11.2)
      IWHICH=PO(LO)
      IF(IWHICH.EQ.0)GO TO 8096
      IF(IWHICH.GT.0)GO TO 8086
      NEL=PO(LO+1)
      LO=LO+1
      DO 8082 J=1,NEL
 8082 IDAY(J)=PO(LO+J)*CONV1
      LO=LO+NEL
      DO 8084 J=1,NEL
 8084 Y(J)=PO(LO+J)*CONV2
      LO=LO+NEL
      CALL FPCV26(TITLE(62),TITLE(63),TITLE(42),IDAY,X,Y,0,NEL,0)
      GO TO 8096
 8086 LO=LO+1
      NVAL=PO(LO)
      NLOC=LO
      IF(NVAL.GT.0)GO TO 8085
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      LO=NLOC+1
      WRITE(IPU,9070) NAMEDP(NU),INM
 9070 FORMAT(7HHEADVSQ,1X,A12,1H(,I1,1H))
      GO TO 8094
 8085 DO 8090 J=1,NVAL
 8090 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 8092 J=1,NVAL
 8092 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,NVAL,0)
 8094 ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONVG=PO(LO+2)
      WRITE(IPU,9072)(ANAME(J),J=1,2)
 9072 FORMAT(7HTWCURVE,1X,2A4)
      WRITE(IPU,9074)CONVG
 9074 FORMAT(4HCONV,1X,F10.3)
      LO=LO+2
C
 8096 LO=LO+1
      NR=PO(LO)
      IF(NR.GT.0)GO TO 8087
      LO=-1*NR+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      WRITE(IPU,9076) NAMEDP(NU),INM
 9076 FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      GO TO 9099
C
 8087 DO 8088 J=1,NR
 8088 IDAY(J)=PO(LO+J)
      LO=LO+NR
      DO 8089 J=1,NR
 8089 Y(J)=PO(LO+J)*CONV1
      CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,NR,0)
      LO=LO+NR+1
      IRT=PO(LO)
      IF(IRT.GE.0) WRITE(IPU,9098)IRT
 9098 FORMAT(8HRULETIME,1X,I5)
 9099 WRITE(IPU,EP)
C
C  PUNCH CARRYOVER
      WRITE(IPU,CA)
      X(1)=CO(LC)*CONV2
      X(2)=CO(LC+1)*CONV2
      X(3)=CO(LC+2)*CONV2
      WRITE(IPU,9078)(X(J),J=1,3)
 9078 FORMAT(4HOLDQ,1X,3F11.2)
      WRITE(IPU,ECA)
      WRITE(IPU,9080)
 9080 FORMAT(8HENDPOWER)
      GO TO 500
C***********************************************************************
C
C  PRESCRIBED DISCHARGE CHANGE RATE SCHEME (SETDQ)
C
 1140 WRITE(IPU,1141) LEVEL
 1141 FORMAT(6HSETDQ(,I1,1H))
      WRITE(IPU,P)
      ITBL=PO(LP)
      IOPT=PO(LP+1)
      ITYPE=PO(LP+2)
      IF(ITBL .LE. 0) THEN
C     SPECIFIED DISCHARGE CHANGE RATE
        QVAL=PO(LP+1)*CONV2
        LP=LP+3
        WRITE(IPU,1142) QVAL,QHTYPE(ITYPE)
 1142   FORMAT(6HQVALUE,1X,F11.2,1X,A4)
        WRITE(IPU,EP)
CC        WRITE(IPU,ECA)
CC SETDQ doesn't have ENDCO card ---kwz,4/22/02,r20-25,v.3.3
        WRITE(IPU,'( ''ENDSETDQ'')')
        GO TO 500
        ENDIF
C  DISCHARGE CHANGE RATE TO BE DETERMINED FROM TABLE
      WRITE(IPU,1143) QHTYPE(ITYPE)
 1143 FORMAT(6HQVALUE,1X,4HTABL,1X,A4)
      WRITE(IPU,1144) QHTYPE(IOPT)
 1144 FORMAT(6HOPTION,1X,A4)
      CONVX=CONV2
      IF(IOPT.EQ.3) CONVX=CONV1
      LP=LP+3
      NVAL=PO(LP)
      DO J=1,NVAL
         X(J)=PO(LP+J)
         IF(X(J).GE.0)X(J)=X(J)*CONVX
         ENDDO
      LO=LP+NVAL
      DO J=1,NVAL
         Y(J)=PO(LO+J)*CONV2
         ENDDO
      CALL FPCV26(TITLE(67),TITLE(68),TITLE(42),IDAY,X,Y,1,NVAL,0)
      WRITE(IPU,EP)
CC      WRITE(IPU,ECA)
CC SETDQ doesn't have ENDCO card ---kwz,4/22/02,r20-25,v.3.3
      WRITE(IPU,'( ''ENDSETDQ'')')
      GO TO 500
C***********************************************************************
C
C   PRESCRIBED POOL ELEVATION CHANGE RATE SCHEME (SETDH)
C
 1150 WRITE (IPU,1151) LEVEL
 1151 FORMAT (6HSETDH(,I1,1H))
      WRITE (IPU,P)
      ITBL=PO(LP)
      ITYPE=PO(LP+1)
      IF (ITBL.LE.0) THEN
C     SPECIFIED POOL ELEVATION CHANGE RATE
         HVAL=PO(LP+1)*CONV1
         LP=LP+2
         WRITE (IPU,1152) HVAL
 1152    FORMAT ('HVALUE ',F11.2)
         WRITE (IPU,EP)
         WRITE (IPU,'( ''ENDSETDH'')')
         GO TO 500
         ENDIF
C  POOL ELEVATION CHANGE RATE TO BE DETERMINED FROM TABLE
      WRITE (IPU,1153)
 1153 FORMAT ('HVALUE  TABL')
      WRITE(IPU,1154) QHTYPE(ITYPE)
 1154 FORMAT ('TBLTYPE  ',A4)
      CONVX=CONV2
      IF (ITYPE.EQ.3) CONVX=CONV1
      LP=LP+2
      NVAL=PO(LP)
      IF (NVAL.GT.MIDAY) THEN
         WRITE (IPR,1155) NVAL,MIDAY
1155  FORMAT ('0**ERROR** IN PUC26 - NUMBER OF VALUES (',I4,
     * ') EXCEEDS NUMBER THAT CAN BE STORED IN TABLE ARRAYS (',I4,
     * ').')
         CALL ERROR
         NVAL=MIDAY
         ENDIF
      DO J=1,NVAL
         X(J)=PO(LP+J)
         IF(X(J).GE.0)X(J)=X(J)*CONVX
         ENDDO
      LO=LP+NVAL
      DO J=1,NVAL
         Y(J)=PO(LO+J)*CONV1
         ENDDO
      CALL FPCV26( TITLE(67),TITLE(68),TITLE(42),IDAY,X,Y,1,NVAL,0)
      WRITE (IPU,EP)
      WRITE (IPU,'( ''ENDSETDH'')')
      GO TO 500
C***********************************************************************
C***********************************************************************
C
C  SELECTION IS A UTILITY
C
 1500 NUM=IBASE-150
      IGOTO=IBASE-150
      IF (IBUG.GE.1) WRITE (IPR,*) 'IN PUC26 - NUM=',NUM
      GO TO (1510,1520,1530,1540,1550,
     *       1560,1570,1580,1590,1600,
     *       1610,1620),IGOTO
      WRITE (IPR,1505) NUM
1505  FORMAT ('0**ERROR** IN PUC26 - UTILITY NUMBER ',I3,
     * 'CANNOT BE PROCESSED.')
      CALL ERROR
      GO TO 500
C***********************************************************************
C
C  RULECURVE ADJUSTMENT UTILITY (RULEADJ)
C
 1510 WRITE(IPU,987)LEVEL
 987  FORMAT(8HRULEADJ(,I1,1H))
      WRITE(IPU,P)
      NVAL=PO(LP)
      LO=LP
      MOVE=0
      NLOC=LO
      IF(NVAL.GT.0)GO TO 261
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
 261  NVAL=PO(LO)
      DO 262 J=1,NVAL
 262  IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 264 J=1,NVAL
 264  Y(J)=PO(LO+J)*CONV1
      IF(MOVE.EQ.1)WRITE(IPU,986) NAMEDP(NU),INM
 986  FORMAT(5HCURVE,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(1),TITLE(2),TITLE(42),IDAY,X,Y,0,
     1 NVAL,0)
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1)GO TO 2013
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPU,988)ITIME
 988  FORMAT(8HRULETIME,1X,I5)
      LO=LO+1
 2013 INT=PO(LO)
      DIFF=PO(LO+1)*CONV1
      QABOVE=PO(LO+2)*CONV2
      WRITE(IPU,2015)INT
 2015 FORMAT(7HPERIODS,1X,I5)
      WRITE(IPU,2020)DIFF
 2020 FORMAT(8HELEVDIFF,1X,F11.2)
      WRITE(IPU,2025)QABOVE
 2025 FORMAT(5HMAXQI,1X,F11.2)
      WRITE(IPU,EP)
C
C     PUNCH TIME SERIES
      WRITE(IPU,TS)
      IT=PO(LT+3)
      WRITE(IPU,2028)PO(LT),PO(LT+1),PO(LT+2),IT
 2028 FORMAT(4HELEV,1X,2A4,1X,A4,1X,I2)
      WRITE(IPU,ETS)
C     PUNCH CARRYOVER IF REQUIRED
C
      WRITE(IPU,CA)
      MN=CO(LC)
      WRITE(IPU,2030)MN
 2030 FORMAT(4HMSNG,1X,I10)
      DO 2032 K=1,INT
 2032 X(K)=CO(LC+K)*CONV1
      CALL FPCV26(TITLE(64),TITLE(11),TITLE(12),IDAY,X,Y,1,INT,1)
      WRITE(IPU,ECA)
C
      WRITE(IPU,2040)
 2040 FORMAT(7HENDRADJ)
      GO TO 500
C***********************************************************************
C
C  INFLOW SUMMATION UTILITY (SUMINF)
C
 1520 WRITE(IPU,2048)LEVEL
 2048 FORMAT(7HSUMINF(,I1,1H))
      WRITE(IPU,P)
      RNORMQ=PO(LP)*CONV2
      CREST=PO(LP+1)*CONV1
      WRITE(IPU,2050)RNORMQ
      WRITE(IPU,2055)CREST
 2050 FORMAT(5HNORMQ,1X,F11.2)
 2055 FORMAT(6HELTEST,1X,F11.2)
      WRITE(IPU,EP)
      WRITE(IPU,2056)
 2056 FORMAT(6HENDSUM)
      GO TO 500
C***********************************************************************
C
C  RAIN/EVAP UTILITY (RAINEVAP)
C
 1530 WRITE(IPU,2066)LEVEL
 2066 FORMAT(9HRAINEVAP(,I1,1H))
      WRITE(IPU,P)
      IWHICH=PO(LP)
      LO=LP
C  THE FOLLOWING CHANGE MADE ON 10/17/90
      IF(IWHICH.GT.0)GO TO 284
      IF(IWHICH.LT.0)GO TO 281
C  END OF CHANGE OF 10/17/90
      DO 2060 J=1,12
 2060 X(J)=PO(LO+J)*CONV5
      WRITE(IPU,2065) (X(J),J=1,6)
 2065 FORMAT(4HEVAP,1X,6F10.3,T72,1H&)
      WRITE(IPU,2070) (X(J),J=7,12)
 2070 FORMAT(5X,6F10.3)
      LO=LO+12
  284 NDT=NTIM24
      DO 2064 J=1,NDT
 2064 X(J)=PO(LO+J)
      IF(NDT.LE.6) THEN
      WRITE(IPU,2161) (X(J),J=1,NDT)
 2161 FORMAT(4HDIST,1X,6F10.6)
      GO TO 2171
      ENDIF
      NDT2 = MOD(NDT,6)
      IF(NDT2.LE.0) NDT2=6
      NDT1 = NDT - NDT2
      WRITE(IPU,2165) (X(J),J=1,6)
 2165 FORMAT(4HDIST,1X,6F10.6,T72,1H&)
      IF(NDT1.GT.6) WRITE(IPU,2166) (X(J),J=7,NDT1)
 2166 FORMAT(5X,6F10.6,T72,1H&)
      IF(NDT.GT.NDT1) WRITE(IPU,2170) (X(J),J=NDT1+1,NDT)
 2170 FORMAT(5X,6F10.6)
ccc      CALL FPCV26(TITLE(15),TITLE(11),TITLE(12),IDAY,X,Y,1,NDT,1)
 2171 CONTINUE
      LO=LO+NDT
 281  HREA=PO(LO+1)
      IF(HREA .LE.1.0) GO TO 282
      HREAX= HREA
      IF(IMETEN .LE. 0) HREAX= HREA*CONV1
      WRITE(IPU,2069) HREAX
 2069 FORMAT('HREA ',1X,F10.0)
 282  WRITE(IPU,EP)
C
C     PUNCH TIME SERIES
      WRITE(IPU,TS)
      LO=LT
      DO 285 J=1,3
      IF(J.EQ.2.AND.IWHICH.LE.0)GO TO 285
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 286
      IT=PO(LO+3)
      WRITE(IPU,2062)TS16(J),PO(LO),PO(LO+1),PO(LO+2),IT
 2062 FORMAT(A4,1X,2A4,1X,A4,1X,I2)
      LO=LO+5
      GO TO 285
 286  LO=LO+2
 285  CONTINUE
      WRITE(IPU,ETS)
      WRITE(IPU,2071)
 2071 FORMAT(7HENDRAIN)
      GO TO 500
C***********************************************************************
C
C   DISCHARGE AND POOL ELEVATION ADJUSTMENT UTILITY (ADJUST)
C
 1540 WRITE(IPU,2072)LEVEL
 2072 FORMAT(7HADJUST(,I1,1H))
C
      IF (LP .LE. 0) GO TO 291
C
C  PUNCH PARAMETERS 'BLEND' AND 'CFACTOR'
      WRITE(IPU,P)
      IBLND = PO(LP)
      WRITE(IPU,2073) IBLND
 2073 FORMAT(5HBLEND,1X,I5)
      IW = PO(LP+1) + 1
      WRITE(IPU,2074) CFACT(1,IW),CFACT(2,IW)
 2074 FORMAT(7HCFACTOR,1X,2A4)
      WRITE(IPU,EP)
C
  291 CONTINUE
C   PUNCH TIME SERIES
      LO=LT
      WRITE(IPU,TS)
      DO 292 J=1,NTS17
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 295
      J2=2*J
      J1=J2-1
      IT=PO(LO+3)
      WRITE(IPU,2075)TS17(J1),TS17(J2), PO(LO),PO(LO+1),PO(LO+2),IT
 2075 FORMAT(2A4,1X,2A4,1X,A4,1X,I2)
      LO=LO+5
      GO TO 292
 295   LO=LO+2
 292   CONTINUE
      WRITE(IPU,ETS)
C  PUNCH CARRYOVER IF NEEDED
      IF (LC .LE. 0) GO TO 299
C
      WRITE(IPU,CA)
      WRITE(IPU,2076) PO(LC)
 2076 FORMAT(5HQDIFF,1X,F8.2)
      ISTPS = PO(LC+1)
      WRITE(IPU,2077) ISTPS
 2077 FORMAT(5HSTEPS,1X,I6)
      WRITE(IPU,ECA)
C
  299 CONTINUE
      WRITE(IPU,2079)
 2079 FORMAT(6HENDADJ)
      GO TO 500
C***********************************************************************
C
C  BACK COMPUTING INFLOW UTILITY (BACKFLOW)
C
 1550 WRITE(IPU,3018)LEVEL
 3018 FORMAT(9HBACKFLOW(,I1,1H))
      WRITE(IPU,TS)
      LO=LT
      DO 305 J=1,3
      IF(PO(LO).EQ.BLANK.AND.PO(LO+1).EQ.BLANK)GO TO 302
      IT=PO(LO+3)
      WRITE(IPU,3020)TS18(J),PO(LO),PO(LO+1),PO(LO+2),IT
 3020 FORMAT(A4,1X,2A4,1X,A4,1X,I2)
      LO=LO+5
      GO TO 305
 302  LO=LO+2
 305  CONTINUE
      WRITE(IPU,ETS)
C
C  PUNCH CARRYOVER
      WRITE(IPU,CA)
      ELEV=CO(LC)*CONV1
      WRITE(IPU,3021)ELEV
 3021 FORMAT(4HELEV,1X,F11.2)
      WRITE(IPU,ECA)
      WRITE(IPU,3022)
 3022 FORMAT(7HENDBACK)
      GO TO 500
C***********************************************************************
C
 1560 WRITE (IPR,1505) NUM
      CALL ERROR
      GO TO 500
C***********************************************************************
C
C  MAXIMUM OUTFLOW FROM DAM UTILITY (MAXQ)
C
 1570 WRITE(IPU,4020)LEVEL
 4020 FORMAT(5HMAXQ(,I1,1H))
      WRITE(IPU,P)
      IWHICH=PO(LP)
      LO=LP+1
      IF(IWHICH.NE.0)GO TO 3215
      RNORMQ=PO(LO)*CONV2
      WRITE(IPU,4025)RNORMQ
 4025 FORMAT(6HCONSTQ,1X,F11.2)
      LO=LO+1
 3215 MOVE=0
      NLOC=LO
      NVAL=PO(LO)
      IF(NVAL.GT.0)GO TO 321
      LO=NVAL*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      MOVE=1
      NVAL=PO(LO)
 321  DO 322 J=1,NVAL
 322  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 323 J=1,NVAL
 323  Y(J)=PO(LO+J)*CONV2
      IF(MOVE.EQ.1.AND.IWHICH.GT.0)WRITE(IPU,4022) NAMEDP(NU),INM
      IF(MOVE.EQ.1.AND.IWHICH.LT.0)WRITE(IPU,4024) NAMEDP(NU),INM
 4024 FORMAT(8HELVSMAXQ,1X,A12,1H(,I1,1H))
 4022 FORMAT(5HELVSQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0.AND.IWHICH.GE.0)CALL FPCV26(TITLE(3),TITLE(4),
     1 TITLE(42),IDAY,X,Y,1,NVAL,0)
      IF(MOVE.EQ.0.AND.IWHICH.LT.0)CALL FPCV26(TITLE(13),TITLE(14),
     1 TITLE(42),IDAY,X,Y,1,NVAL,0)
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(IWHICH.LE.0)GO TO 328
      NVAL=PO(LO)
      NLOC=LO
      MOVE=0
      IF(NVAL.GT.0)GO TO 329
      MOVE=1
      LO=NVAL*(-1)+PO(10)-1
      CALL FLOC26(PO,LO,NU,INM)
      NVAL=PO(LO)
 329  DO 326 J=1,NVAL
 326  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 327 J=1,NVAL
 327  Y(J)=PO(LO+J)*CONV2
      IF(MOVE.EQ.1)WRITE(IPU,4026) NAMEDP(NU),INM
 4026 FORMAT(7HHEADSVQ,1X,A12,1H(,I1,1H))
      IF(MOVE.EQ.0)CALL FPCV26(TITLE(5),TITLE(6),TITLE(42),IDAY,X,Y,1,
     1 NVAL,0)
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      WRITE(IPU,4029) ANAME(1),ANAME(2)
 4029 FORMAT(7HTWCURVE,1X,2A4)
      CONVG=PO(LO+2)
      WRITE(IPU,4028)CONVG
 4028 FORMAT(4HCONV,1X,F11.2)
 328  WRITE(IPU,EP)
      WRITE(IPU,4027)
 4027 FORMAT(7HENDMAXQ)
      GO TO 500
C***********************************************************************
C
C  ENTRY INTO INDUCED SURCHARGE SCHEME UTILITY (ENTERISC)
C
C  NO INPUT REQUIRED
C
1580  GO TO 500
C***********************************************************************
C
C  SET OUTPUT TO MINIMUM UTILITY (SETMIN)
C
 1590 WRITE(IPU,4082)LEVEL
 4082 FORMAT(7HSETMIN(,I1,1H))
      WRITE(IPU,P)
      NVAL=PO(LP)
      IF(NVAL.EQ.1)WRITE(IPU,4085)
      IF(NVAL.EQ.2)WRITE(IPU,4090)
      IF(NVAL.EQ.3)WRITE(IPU,4095)
 4085 FORMAT(4HTYPE,1X,5HINSTQ)
 4090 FORMAT(4HTYPE,1X,5HMEANQ)
 4095 FORMAT(4HTYPE,1X,4HPOOL)
      WRITE(IPU,EP)
      WRITE(IPU,4097)
 4097 FORMAT(7HENDSMIN)
      GO TO 500
C***********************************************************************
C
C  SET OUTPUT TO MAXIMUM UTILITY (SETMAX)
C
 1600 WRITE(IPU,5000)LEVEL
 5000 FORMAT(7HSETMAX(,I1,1H))
      WRITE(IPU,P)
      NVAL=PO(LP)
      IF(NVAL.EQ.1)WRITE(IPU,5005)
      IF(NVAL.EQ.2)WRITE(IPU,5010)
      IF(NVAL.EQ.3)WRITE(IPU,5015)
 5005 FORMAT(4HTYPE,1X,5HINSTQ)
 5010 FORMAT(4HTYPE,1X,5HMEANQ)
 5015 FORMAT(4HTYPE,1X,4HPOOL)
      WRITE(IPU,EP)
      WRITE(IPU,5017)
 5017 FORMAT(7HENDSMAX)
      GO TO 500
C***********************************************************************
C
C  ENTRY INTO FLASHBOARD SCHEME UTILITY (GOFLASH)
C
C  NO INPUT REQUIRED
C
 1610 GO TO 500
C***********************************************************************
C
C  WATERUSE
C
 1620 WRITE (IPR,1505) NUM
      CALL ERROR
      GO TO 500
C***********************************************************************
 500  CONTINUE
C
      WRITE(IPU,5020)
 5020 FORMAT(7HENDSPEC)
C
C***********************************************************************
C***********************************************************************
C
C     DECODE AND PRINT THE RESERVOIR COMMAND LANGUAGE
C
 501  INUM=IPU
      WRITE (IPU,'(''RCL'')')
      CALL FPR26 (PO,INUM)
C********************************************************************
C
C  PUNCH 'END' FOR OPERATION
C
      WRITE(IPU,'(''END'')')
C**********************************************************************
C
      RETURN
C
      END
