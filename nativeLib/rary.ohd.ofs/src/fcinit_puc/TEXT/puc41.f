C MEMBER PUC41
C  (from old member FCPUC41)
C
      SUBROUTINE PUC41(PO,CO)
C
C#######################################################################
C
C  THIS SUBROUTINE PUNCHES CARDS WHICH CAN BE READ INTO THE PIN ROUTINE
C  TO DEFINE OR RE-DEFINE A SEGMENT OR SEGMENTS FOR THE NEW EVENT-BASED
C  API-HAR2 OPERATION.
C
C#######################################################################
C
C  PARAMETRIC DATA IS OBTAINED FROM THE PO ARRAY PASSED INTO THIS
C  ROUTINE.  CARRYOVER DATA IS OBTAINED FROM THE CO ARRAY.  IF DEFAULT
C  CARRYOVER VALUES ARE REQUESTED, CARRYOVER IS NOT PUNCHED.
C
C#######################################################################
C
C
C  THE ORDER OF THE PUNCHED PARAMETRIC DATA IS AS FOLLOWS:
C
C     CARD 1:  RID, RNAME, IRNUM, RLAT, RLNG
C     CARD 2:  AEIWET, BWET, CWET, AEIDRY, BDRY, CDRY
C     CARD 3:  PA, PB, PC, PD, PE
C     CARD 4:  FIXPEV, PMAX, R24, IDELTA, NSW, IOFAAA, ICOF
C     CARD 5:  TSIDRM, DTCRM, TSIDPE, DTCPE, TSIDRO, DTCRO
C     CARD 6:  TSIDAI, DTCAI, TSIDAP, DTCAP, TSIDAE, DTCAE
C
C     NOTE:  CARD 6 AS LISTED ABOVE IS OPTIONAL, DEPENDING ON THE
C            VALUE OF IOFAAA.  IF IOFAAA = 0, THIS CARD
C            IS NOT PUNCHED.
C
C
C  THE ORDER OF THE PUNCHED CARRYOVER DATA IS AS FOLLOWS:
C
C     CARD 7 (OR 6):  TAPI, TAEI, TAI, SAPI, SAEI, SAI, SRAIM, SRO,
C                     DRAIM, DRO
C     CARD 8 - 9 (OR 7 - 8):  RNSP(I),I=1,24
C
C  FOR DEFINITION OF THESE VARIABLES, SEE THE PIN41 ROUTINE.
C
C#######################################################################
C
      DIMENSION PO(1),CO(1),SUBNAM(2),RID(2),RNAME(5),RNSP(24)
      COMMON /IONUM/ IN,IPR,IPU
      COMMON /FDBUG/ IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      COMMON /PUDFLT/ IPDFLT
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_puc/RCS/puc41.f,v $
     . $',                                                             '
     .$Id: puc41.f,v 1.1 1995/09/17 18:51:00 dws Exp $
     . $' /
C    ===================================================================
C
      DATA SUBNAM /4hPUC4,4h1   /,NOP/41/,EMPTY/4h    /
C
C  CALL DEBUG CHECK ROUTINE.
C
      CALL FPRBUG(SUBNAM,1,NOP,IFDEB)
C
C  EXTRACT NEEDED INFO FROM THE PO ARRAY.
C
      RID(1)=PO(2)
      RID(2)=PO(3)
      DO 100 I=1,5
100   RNAME(I)=PO(I+3)
      IRNUM=PO(9)
      RLAT=PO(10)
      RLNG=PO(11)
      AEIWET=PO(12)
      BWET=PO(13)
      CWET=PO(14)
      AEIDRY=PO(15)
      BDRY=PO(16)
      CDRY=PO(17)
      PA=PO(18)
      PB=PO(19)
      PC=PO(20)
      PD=PO(21)
      PE=PO(22)
      FIXPEV=PO(23)
      PMAX=PO(24)
      R24=PO(25)
      IDELTA=PO(26)
      NSW=PO(27)
      NSPER=PO(28)
C
C  SET CARRYOVER READ/NO READ FLAG DEPENDING ON VALUE OF IPDFLT.
C  IF IPDFLT = 1, DEFAULT CARRYOVER WILL BE USED.  IF IPDFLT = 0,
C  ACTUAL CARRYOVER WILL BE PUNCHED.
C
      IF(IPDFLT)120,120,110
110   ICOF=0
      GO TO 130
120   ICOF=1
130   IOFAAA=0
      IF(PO(41)-EMPTY)170,140,170
140   IF(PO(44)-EMPTY)170,150,170
150   IF(PO(47)-EMPTY)170,180,170
170   IOFAAA=1
C
C  PUNCH OUT FIRST 4 CARDS OF PARAMETRIC DATA.
C
180   WRITE(IPU,1000)RID,RNAME,IRNUM,RLAT,RLNG
      WRITE(IPU,1010)AEIWET,BWET,CWET,AEIDRY,BDRY,CDRY
      WRITE(IPU,1020)PA,PB,PC,PD,PE
      WRITE(IPU,1030)FIXPEV,PMAX,R24,IDELTA,NSW,IOFAAA,ICOF
C
C  PUNCH OUT 5TH CARD WITH INFO ON THE MANDATORY TIME SERIES NEEDED
C  BY THE API-HAR2 OPERATION.
C
      WRITE(IPU,1040)(PO(31+I),I=1,9)
C
C  PUNCH OUT 6TH CARD WITH INFO ON THE OPTIONAL TIME SERIES, IF NEEDED.
C
      IF(IOFAAA)200,200,190
190   WRITE(IPU,1040)(PO(40+I),I=1,9)
C
C  IF CARRYOVER VALUES ARE TO BE DEFAULTED, RETURN.
C
200   IF(ICOF)9999,9999,210
C
C  IF CARRYOVER VALUES ARE TO BE CURRENT VALUES FROM CO ARRAY,
C  PUNCH NEXT 2 (OR 3) CARDS WITH CURRENT CARRYOVER VALUES.
C
210   TAPI=CO(1)
      TAEI=CO(2)
      TAI=CO(3)
      SAPI=CO(4)
      SAEI=CO(5)
      SAI=CO(6)
      SRAIM=CO(7)
      SRO=CO(8)
      DRAIM=CO(9)
      DRO=CO(10)
      DO 220 I=1,NSPER
220   RNSP(I)=CO(10+I)
      WRITE(IPU,1240)TAPI,TAEI,TAI,SAPI,SAEI,SAI,SRAIM,SRO,DRAIM,DRO
      WRITE(IPU,1250)(RNSP(I),I=1,NSPER)
9999  RETURN
1000  FORMAT(2A4,6X,5A4,5X,I4,6X,F5.2,5X,F5.2)
1010  FORMAT(6F5.2)
1020  FORMAT(5F5.2)
1030  FORMAT(3F5.2,4I5)
1040  FORMAT(2A4,3X,A4,4X,2A4,3X,A4,5X,2A4,3X,A4)
1240  FORMAT(10F5.2)
1250  FORMAT(12F5.2,/,12F5.2)
      END
