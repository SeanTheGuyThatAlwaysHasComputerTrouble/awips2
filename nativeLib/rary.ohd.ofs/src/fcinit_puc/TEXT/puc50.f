C MEMBER PUC50
C  (from old member FCPUC50)
C @PROCESS LVL(77)
          SUBROUTINE PUC50(PO)
C                             LAST UPDATE: 04/25/95.13:33:15 BY $WC20SV
C
C
C       THIS IS THE PUNCH CARD ROUTINE FOR THE ASSIMILATOR OPERATION.
C       THIS ROUTINE CREATES INPUT CARDS FROM THE PO ARRAY USING
C       THE EXACT FORMAT REQUIRED BY THE INPUT ROUTINE PIN 50.
C
C       ROUTINE INITIALLY WRITTEN BY
C       ERIC MARKSTROM, RIVERSIDE TECHNOLOGY, DECEMBER 1994 VERSION 1
C

C    CONTENTS OF THE PO ARRAY -
C
C
C  POSITION  DESCRIPTION
C     1      VERSION NUMBER
C    2-6     GENERAL INFORMATION
C    7-8     ASSIMILATOR I.D.

C     9      NUMBER OF SUBAREAS WITHIN BASIN
C     10     NUMBER OF DAYS PER DISCHARGE INTERVAL
C     11     NUMBER OF DAYS PER PRECIPITATION INTERVAL

C     12     WEIGHT COEFFICIENT FOR DISCHARGE
C     13     WEIGHT COEFFICIENT FOR PRECIPITATION
C     14     WEIGHT COEFFICIENT FOR STATES

C   15-16    OBSERVED DISCHARGE TIME SERIES I.D.
C     17     OBSERVED DISCHARGE DATA TYPE

C   18-19    SIMULATED DISCHARGE TIME SERIES I.D.
C     20     SIMULATED DISCHARGE DATA TYPE

C     21     MAX NUMBER OF ITERATIONS FOR OPTIMIZER
C     22     DELTA VALUE FOR OPTIMIZER
C     23     MINIMUM CRITERIA VALUE FOR OPTIMIZER

C     24     POINTER TO A LIST OF RAINFALL/RUNOFF
C            OPERATION TYPES
C     25     POINTER TO A LIST OF RAINFALL/RUNOFF
C            OPERATION ID'S
C     26     POINTER TO A LIST OF PO ARRAYS
C            FOR RAINFALL/RUNOFF MODELS
C     27     POINTER TO A LIST OF CO ARRAYS
C            FOR RAINFALL/RUNOFF MODELS

C     28     POINTER TO A LIST OF KP TS ID'S

C     29     POINTER TO A LIST OF BASIN WEIGHTS
C            FOR PRECIPITATION
C     30     POINTER TO A LIST OF BASIN WEIGHTS
C            FOR STATES

C     31     POINTER TO A LIST OF LOWER BOUNDARYS FOR KP
C     32     POINTER TO A LIST OF UPPER BOUNDARYS FOR KP

C     33     POINTER TO A LIST OF STATE OPTIONS

C     34     POINTER TO A LIST OF LOWER BOUNDARYS FOR KS
C            (DEPENDS ON STATE OPTIONS)
C     35     POINTER TO A LIST OF UPPER BOUNDARYS FOR KS
C            (DEPENDS ON STATE OPTIONS)

C     36     POINTER TO A LIST OF ON/OFF SWITCHES FOR STATES
C            (DEPENDS ON STATE OPTIONS)

C    37-40   RESERVED FOR FUTURE USE

      DIMENSION PO(*)

      INCLUDE 'common/ionum'

      INTEGER NBASINS, IPUC50
      DIMENSION SNAME(2), ANAME(2)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_puc/RCS/puc50.f,v $
     . $',                                                             '
     .$Id: puc50.f,v 1.1 1995/09/17 18:51:03 dws Exp $
     . $' /
C    ===================================================================
C
      DATA SNAME /4HPUC5,4H0   /
      DATA ANAME /4HASSI,4HM   /
CCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCC  DEBUG INITIALIZATION
C
      CALL FOPCDE(ANAME, IPUC50)
      CALL FPRBUG( SNAME, 1, IPUC50, IBUG )

CCC  WRITE DATA TO PUNCH CARDS
C
      NBASINS              = INT(PO(9))



C    WRITE CARD 1
      WRITE (IPU,801) PO(2), PO(3), PO(4), PO(5), PO(6), PO(7),
     1 PO(8), INT(PO(9)), INT(PO(10)),
     1 INT(PO(11)), PO(12), PO(13), PO(14)


C    WRITE CARD 2
      WRITE (IPU, 802) PO(15), PO(16), PO(17), PO(18),
     1 PO(19), PO(20), INT(PO(21)), PO(22), PO(23)

C    WRITE CARDS 3, 4, ..., 2 + (NBASINS * 2)
      DO I = 1, NBASINS

          WRITE (IPU, 803)
     1 PO(INT(PO(24))+(I-1)*2), PO(INT(PO(24))+(I-1)*2+1), ! ROPTY
     2 PO(INT(PO(25))+(I-1)*2), PO(INT(PO(25))+(I-1)*2+1), ! ROPID
     3 PO(INT(PO(28))+(I-1)*2), PO(INT(PO(28))+(I-1)*2+1), ! RKPID
     4 PO(INT(PO(29))+(I-1)), PO(INT(PO(30))+(I-1)), !WP_B(I),WS_B(I)
     5 PO(INT(PO(31))+(I-1)), PO(INT(PO(32))+(I-1)), !RKPMIN, RKPMAX
     6 INT(PO(INT(PO(33))+(I-1)))                     !IST_OP

C         WRITE THE NEXT CARD IN A MANNER DEPENDING ON THE STATE OPTION

C         SAC-SMA, FIRST OPTION
           IF (INT(PO(INT(PO(33))+(I-1))).EQ.1) THEN
                 WRITE(IPU, 804)
C    RKSMIN, RKSMAX
C    ISTNF(1), ISTNF(2)
C    ISTNF(3), ISTNF(4)
C    ISTNF(5), ISTNF(6)
     1 PO(INT(PO(34))+(I-1)),   PO(INT(PO(35))+(I-1)),
     2 INT(PO(INT(PO(36))+(I-1)*6)),  INT(PO(INT(PO(36))+(I-1)*6+1)),
     3 INT(PO(INT(PO(36))+(I-1)*6+2)),INT(PO(INT(PO(36))+(I-1)*6+3)),
     4 INT(PO(INT(PO(36))+(I-1)*6+4)),INT(PO(INT(PO(36))+(I-1)*6+5))
           END IF
      END DO


  801 FORMAT ( 5A4, 2X, 2A4, 1X, I2, 2X, I2, 1X, I2,
     1 3X, F4.2, 1X, F4.2, 1X, F4.2 )
  802 FORMAT ( 2A4, 1X, A4, 9X, 2A4, 1X, A4, 1X, I4,
     1 1X, F8.6, 1X, F6.4 )
  803 FORMAT ( A4, A4, 1X, A4, A4, 1X, A4, A4, 1X, F4.2,
     1 1X, F4.2, 1X, F4.2, 1X, F4.2, 1X, I2 )
  804 FORMAT ( F4.2, 1X, F4.2, 1X, I1, 1X, I1, 1X,
     1 I1, 1X, I1, 1X, I1, 1X, I1 )

      END
