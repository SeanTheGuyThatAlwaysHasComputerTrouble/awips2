C MEMBER PUC38
C  (from old member FCPUC38)
C  VERSION 1
C
      SUBROUTINE PUC38(PO,CO)
C
C#####################################################################
C
C  THIS SUBROUTINE PUNCHES CARDS CONTAINING THE PARAMETRIC AND
C  CARRYOVER DATA WHICH CAN BE READ INTO THE PIN ROUTINE OF THE
C  BASEFLOW SIMULATION OPERATION.  THE PARAMETRIC DATA IS OBTAINED
C  FROM THE PO ARRAY, AND THE CARRYOVER DATA IS OBTAINED FROM THE
C  CO ARRAY.
C#####################################################################
C
C  THE ORDER OF THE PUNCHED PARAMETRIC DATA IS AS FOLLOWS:
C
C  CARD 1:  METRIC/ENGLISH SWITCH, BASEFLOW TIME SERIES ID,
C           BASEFLOW TIME SERIES TYPE, BASEFLOW TIME SERIES TIME
C           INTERVAL, AREA, CONSTANT BASEFLOW AMOUNT,
C           VARIABLE BASEFLOW OPTION INDICATOR.
C
C  CARD 2:  A)  IF VARIABLE BASEFLOW OPTION INDICATOR = 0:
C               CARD 2 IS NOT PUNCHED.
C
C           B)  IF VARIABLE BASEFLOW OPTION INDICATOR = 1:
C               BASEFLOW RECESSION COEFFICIENT.
C
C           C)  IF VARIABLE BASEFLOW OPTION INDICATOR = 2:
C               BASEFLOW RECESSION COEFFICIENT TIME SERIES ID,
C               BASEFLOW RECESSION COEFFICIENT TIME SERIES TYPE.
C
C
C
C  THE ORDER OF THE PUNCHED CARRYOVER DATA IS AS FOLLOWS:
C
C  CARD 1:  A)  IF VARIABLE BASEFLOW OPTION INDICATOR = 0:
C               THIS CARD IS NOT PUNCHED.
C
C           B)  IF VARIABLE BASEFLOW OPTION INDICATOR = 1:
C               PREVIOUS TOTAL BASEFLOW (CMS).
C
C           C)  IF VARIABLE BASEFLOW OPTION INDICATOR = 2:
C               PREVIOUS TOTAL BASEFLOW (CMS),
C               PREVIOUS BASEFLOW RECESSION COEFFICIENT.
C
C
C#####################################################################
C
      DIMENSION PO(1),CO(1),TSIDBF(2),TSIDRC(2)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/FENGMT/METRIC
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_puc/RCS/puc38.f,v $
     . $',                                                             '
     .$Id: puc38.f,v 1.1 1995/09/17 18:50:57 dws Exp $
     . $' /
C    ===================================================================
C
C
C  EXTRACT NEEDED PARAMETERS FROM THE PO ARRAY.
C
      METENG=PO(2)
      TSIDBF(1)=PO(3)
      TSIDBF(2)=PO(4)
      DTCBF=PO(5)
      IDELTA=PO(6)
      AREA=PO(7)
      CBFLOW=PO(8)
      IVBF=PO(9)
      NVBFP=PO(10)
C
C  CHECK TO SEE IF ENGLISH UNITS ARE SPECIFIED.  IF SO, CONVERT
C  AREA AND CBFLOW FROM METRIC TO ENGLISH UNITS.
C
      IF(METRIC)50,25,25
25    METENG=METRIC
50    IF(METENG)100,100,150
100   AREA=AREA/2.58999
      CBFLOW=CBFLOW/.028317
C
C  IF NO VARIABLE BASEFLOW PARAMETERS ARE SPECIFIED, PUNCH FIRST
C  PARAMETRIC DATA CARD AND RETURN TO MAIN PROGRAM.  OTHERWISE, EXTRACT
C  FURTHER INFO FROM THE PO ARRAY AND CO ARRAY AND PUNCH ALL NECESSARY
C  CARDS.
C
150   IF(IVBF-1)600,300,200
200   TSIDRC(1)=PO(18)
      TSIDRC(2)=PO(19)
      DTCRC=PO(20)
      GO TO 400
300   BFREC=PO(18)
C
C  EXTRACT CARRYOVER DATA FROM THE CO ARRAY.
C
400   TBFLOW=CO(1)
      IF(METENG)425,425,450
425   TBFLOW=TBFLOW/.028317
450   IF(IVBF-1)600,600,500
500   BFREC=CO(2)
C
C  PUNCH CARDS.
C
600   WRITE(IPU,7100)METENG,TSIDBF,DTCBF,IDELTA,AREA,CBFLOW,IVBF
      IF(IVBF-1)1000,800,700
700   WRITE(IPU,7200)TSIDRC,DTCRC
      GO TO 900
800   WRITE(IPU,7300)BFREC
900   IF(IVBF-1)1000,950,925
925   WRITE(IPU,7400)TBFLOW,BFREC
      GO TO 1000
950   WRITE(IPU,7500)TBFLOW
1000  RETURN
7100  FORMAT(I1,3X,2A4,2X,A4,1X,I2,3X,F9.2,1X,F9.2,1X,I1)
7200  FORMAT(2A4,1X,A4)
7300  FORMAT(F5.3)
7400  FORMAT(F9.2,5X,F5.3)
7500  FORMAT(F9.2)
      END
