C MEMBER PIN60
C-----------------------------------------------------------------------
C
C                             LAST UPDATE:
C
C @PROCESS LVL(77)
C
      SUBROUTINE PIN60 (P,LEFTP,IUSEP)

C     THIS IS THE TIDE AJUSTMENT ROUTINE FOR DWOPER.  THIS
C     ROUTINE INPUTS ALL CARDS FOR THE OPERATION AND FILLS THE
C     P ARRAY.

C     THIS ROUTINE ORIGINALLY WRITTEN BY
C        JOANNE R. SALERNO - NWRFC   OCT 1997

C     DEFINITION OF VARIABLES
C     IVERSN = I1     VERSION NUMBER OF OPERATION
C     CTITLE = C72    GENERAL NAME OR TITLE FOR OPERATION

C  INPUT
C     ASTORIA DW OBSERVED STAGE
C     ASTID  = C8     DWOPER OBSERVED STAGE TIME SERIES IDENTIFIER
C     TIDE   = C4     DWOPER OBSERVED STAGE DATA TYPE CODE

C     ASTORIA NOS STAGE
C     NOSID  = C8     NOS TIME SERIES IDENTIFIER
C     STID   = C4     NOS DATA TYPE CODE

C     ASTORIA OBS/FX  MAX/MIN BALANCE TIME SERIES
C     ASTID1 = C8     TIDE1   BALANCE TIME SERIES IDENTIFIER
C     SSTG   = C4     TIDE1   BALANCE TYPE CODE
C     ASTID2 = C8     TIDE2   BALANCE TIME SERIES IDENTIFIER
C     SSTG   = C4     TIDE2   BALANCE TYPE CODE
C     ASTID3 = C8     TIDE3   BALANCE TIME SERIES IDENTIFIER
C     SSTG   = C4     TIDE3   BALANCE TYPE CODE
C     ASTID4 = C8     TIDE4   BALANCE TIME SERIES IDENTIFIER
C     SSTG   = C4     TIDE4   BALANCE TYPE CODE

C  OUTPUT
C     ASTORIA DWOPER ADJUSTED STAGE (USER ADJUSTED)
C     DWTIDA = C8     DWOPER ADJUSTED STAGE TIME SERIES IDENTIFIER
C     TIDA   = C4     DWOPER ADJUSTED STAGE DATA TYPE CODE

C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012

C     POSITION     CONTENTS OF P ARRAY

C      1           VERSION NUMBER OF OPERATION
C      2-19        GENERAL NAME OR TITLE

C  INPUT
C     ASTORIA DW OBSERVED STAGE
C     20-21       OBSERVED STAGE TIME SERIES IDENTIFIER
C     22          OBSERVED STAGE DATA TYPE CODE

C     ASTORIA NOS STAGE
C     23-24       NOS TIME SERIES IDENTIFIER
C     25          NOS DATA TYPE CODE

C     ASTORIA MAX/MIN OBS/FX BALANCE
C     26-27       OBS/FX MAX/MIN BALANCE TIME SERIES IDENTIFIER - TIDE1
C     28            "       "       "    DATA TYPE CODE
C     29-30       OBS/FX MAX/MIN BALANCE TIME SERIES IDENTIFIER - TIDE2
C     31            "       "       "    DATA TYPE CODE
C     32-33       OBS/FX MAX/MIN BALANCE TIME SERIES IDENTIFIER - TIDE3
C     34            "       "       "    DATA TYPE CODE
C     35-36       OBS/FX MAX/MIN BALANCE TIME SERIES IDENTIFIER - TIDE4
C     37            "       "       "    DATA TYPE CODE

C  OUPUT
C     ASTORIA DWOPER ADJUSTED STAGE (USER ADJUSTED)
C     38-39       DWOPER ADJUSTED STAGE TIME SERIES IDENTIFIER
C     40          DWOPER ADJUSTED STAGE DATA TYPE CODE

C**********************************************************************

C     THE NUMBER OF ELEMENTS REQUIRED IN THE P ARRAY IS  40

C     THE NUMBER OF ELEMENTS REQUIRED IN THE C ARRAY IS   0

C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012

      CHARACTER *72 CTITLE
      CHARACTER * 8 ASTID,NOSID,ASTID1,ASTID2,ASTID3,ASTID4,DWTIDA
      CHARACTER * 4 TIDE,STID,SSTG,TIDA

      DIMENSION RTITLE(18)
      DIMENSION RASTID(2),RNOSID(2),RASTID1(2),RASTID2(2),RASTID3(2),
     +          RASTID4(2),RDWTIDA(2)
      DIMENSION P(*)

      EQUIVALENCE (CTITLE,RTITLE)
      EQUIVALENCE (ASTID,RASTID),(TIDE,RTIDE)
      EQUIVALENCE (NOSID,RNOSID),(STID,RSTID)
      EQUIVALENCE (ASTID1,RASTID1),(SSTG,RSSTG)
      EQUIVALENCE (ASTID2,RASTID2),(SSTG,RSSTG)
      EQUIVALENCE (ASTID3,RASTID3),(SSTG,RSSTG)
      EQUIVALENCE (ASTID4,RASTID4),(SSTG,RSSTG)
      EQUIVALENCE (DWTIDA,RDWTIDA),(TIDA,RTIDA)

C     COMMON BLOCKS

      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      COMMON/IONUM/IN,IPR,IPU
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_pntb/RCS/pin60.f,v $
     . $',                                                             '
     .$Id: pin60.f,v 1.1 1998/04/07 11:57:02 page Exp $
     . $' /
C    ===================================================================
C

C     CHECK TRACE LEVEL
      CALL FPRBUG('PIN60   ',1,60,IBUG)


C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012

C                   NWRFS CARDS
C                   FREE FORMAT
C
C
C TIDE ADJUSTMENT
C ASTID TIDE NOSID STID
C ASTID1 SSTG ASTID2 SSTG ASTID3 SSTG ASTID4 SSTG DWTIDA TIDA
C
C     CARD 1 - GENERAL USER SUPPLIED INFORMATION
C     CARD 2 - TIME SERIES DEFINITION
C        FIELD 1  - DW OBSERVED STAGE TIME SERIES IDENTIFIER - 8 CHAR
C        FIELD 2  - DW OBSERVED STAGE DATA TYPE CODE  - 4 CHAR
C        FIELD 3  - NOS         STAGE TIME SERIES IDENTIFIER - 8 CHAR
C        FIELD 4  - NOS         STAGE DATA TYPE CODE  - 4 CHAR
C     CARD 3 - TIME SERIES DEFINITION
C        FIELD 1  - TIDE1 OBS/FX SERIES IDENTIFIER    - 8 CHAR
C        FIELD 2  - TIDE1 OBS/FX DATA TYPE CODE       - 4 CHAR
C        FIELD 3  - TIDE2 OBS/FX SERIES IDENTIFIER    - 8 CHAR
C        FIELD 4  - TIDE2 OBS/FX DATA TYPE CODE       - 4 CHAR
C        FIELD 5  - TIDE3 OBS/FX SERIES IDENTIFIER    - 8 CHAR
C        FIELD 6  - TIDE3 OBS/FX DATA TYPE CODE       - 4 CHAR
C        FIELD 7  - TIDE4 OBS/FX SERIES IDENTIFIER    - 8 CHAR
C        FIELD 8  - TIDE4 OBS/FX DATA TYPE CODE       - 4 CHAR
C        FIELD 9  - DW ADJUSTED STAGE SERIES IDENTIFIER - 8 CHAR
C        FIELD 10 - DW ADJUSTED STAGE DATA TYPE CODE    - 4 CHAR

C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012

C     READ IN CARDS IN FREE FORMAT
      IUSEP = 0
      IUSEC = 0
      IERROR = 0

      READ(IN,FMT='(A)',ERR=9981) CTITLE
      IF (IBUG.GE.1) WRITE(IODBUG,801) CTITLE
 801  FORMAT('PIN60: CTITLE: ',A72)

      READ(IN,*,ERR=9982) ASTID,TIDE,NOSID,STID
      IF (IBUG.GE.1) WRITE(IODBUG,805)
     +               ASTID,TIDE,NOSID,STID
 805  FORMAT('PIN60: ASTID,TIDE : ',2A8,/,
     +       '       NOSID,STID : ',2A8)

      READ(IN,*,ERR=9983) ASTID1,SSTG,ASTID2,SSTG,
     +       ASTID3,SSTG,ASTID4,SSTG,DWTIDA,TIDA
      IF (IBUG.GE.1) WRITE(IODBUG,806)
     +       ASTID1,SSTG,ASTID2,SSTG,ASTID3,SSTG,
     +       ASTID4,SSTG,DWTIDA,TIDA
 806  FORMAT('PIN60: ASTID1,SSTG: ',2A8,/,
     +       '       ASTID2,SSTG: ',2A8,/,
     +       '       ASTID3,SSTG: ',2A8,/,
     +       '       ASTID4,SSTG: ',2A8,/,
     +       '       DWTIDA,TIDA: ',2A8)

C23456789012345678901234567890123456789012345678901234567890123456789012

C     CHECK TS - ASTID,TIDE
C                NOSID,STID
C                ASTID1,SSTG
C                ASTID2,SSTG
C                ASTID3,SSTG
C                ASTID4,SSTG
C                DWTIDA,TIDA

      CALL CHEKTS (ASTID,TIDE,1,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (NOSID,STID,1,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (ASTID1,SSTG,24,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (ASTID2,SSTG,24,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (ASTID3,SSTG,24,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (ASTID4,SSTG,24,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      CALL CHEKTS (DWTIDA,TIDA,1,1,'L   ',0,1,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1
C        1         2         3         4         5         6         7
C23456789012345678901234567890123456789012345678901234567890123456789012


C     CHECK SPACE IN P AND C ARRAYS
C     NUMBER POINTS REQUIRED IN THE P ARRAY IS 40
C     NUMBER POINTS REQUIRED IN THE C ARRAY IS 0
C     IF ICARRY IS NONZERO

      IUSEP = 40

      CALL CHECKP (IUSEP,LEFTP,IERFLG)
      IF (IERFLG.NE.0) IERROR = 1

      IF (IERROR.GE.1) GO TO 990

C     SAVE TIME SERIES IDENTIFIERS AND PARAMETERS TO P AND C ARRAYS

      IVERSN = 1
      P(1) = REAL(IVERSN)
      DO 500 I=1,18
 500  P(I+1) = RTITLE(I)

      P(20) = RASTID(1)
      P(21) = RASTID(2)
      P(22) = RTIDE

      P(23) = RNOSID(1)
      P(24) = RNOSID(2)
      P(25) = RSTID

      P(26) = RASTID1(1)
      P(27) = RASTID1(2)
      P(28) = RSSTG

      P(29) = RASTID2(1)
      P(30) = RASTID2(2)
      P(31) = RSSTG

      P(32) = RASTID3(1)
      P(33) = RASTID3(2)
      P(34) = RSSTG

      P(35) = RASTID4(1)
      P(36) = RASTID4(2)
      P(37) = RSSTG

      P(38) = RDWTIDA(1)
      P(39) = RDWTIDA(2)
      P(40) = RTIDA

      GO TO 990

 9981 IERROR = 1
      WRITE(IPR,9901)
 9901 FORMAT(//,10X,'**ERROR** TIDE ADJUSTMENT INPUT ERROR',/,
     +          10X,'CARD 1 READ: USER SUPPLIED INFORMATION')
      CALL ERROR
      GO TO 990

 9982 IERROR = 1
      WRITE(IPR,9902)
 9902 FORMAT(//,10X,'**ERROR** TIDE ADJUSTMENT INPUT ERROR',/,
     +          10X,'CARD 2 READ: TIME SERIES INFORMATION')
      CALL ERROR
      GO TO 990

 9983 IERROR = 1
      WRITE(IPR,9903)
 9903 FORMAT(//,10X,'**ERROR** TIDE ADJUSTMENT INPUT ERROR',/,
     +          10X,'CARD 3 READ: TIME SERIES INFORMATION')
      CALL ERROR
      GO TO 990

 990  IF (IERROR.GE.1) THEN
         IUSEP = 0
      ENDIF

      IF (ITRACE.GE.1) WRITE(IODBUG,999)
 999  FORMAT('PIN60 (TIDE ADJUSTMENT) EXITED')

      RETURN
      END
