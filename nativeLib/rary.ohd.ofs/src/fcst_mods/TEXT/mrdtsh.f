C MODULE MRDTSH
C-----------------------------------------------------------------------
C
C
C
C   THIS ROUTINE READS THE TIME SERIES ID, DATA TYPE AND TIME INTERVAL
C   USED WITH A1 AND A2 MOD FORMAT DECODING
C
      SUBROUTINE MRDTSH (NCARDS,MODCRD,NFLD,TSID,DTYPE,IDT,ISTAT)
C
      REAL*8 TSID
C
      DIMENSION MODCRD(20,NCARDS),OLDOPN(2)
C
      INCLUDE 'ufreex'
C
      EQUIVALENCE (ICVAR1,IPRFLD)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_mods/RCS/mrdtsh.f,v $
     . $',                                                             '
     .$Id: mrdtsh.f,v 1.2 1998/07/02 20:46:46 page Exp $
     . $' /
C    ===================================================================
C
C
C
      CALL FSTWHR ('MRDTSH  ',0,OLDOPN,IOLDOP)
C
      IPRFLD=0
      ICKDAT=0
C
      NFLD=1
C
C  GET TIME SERIES IDENTIFIER
C
      ISTRT=-3
      NCHAR=2
      CALL UFIEL2 (NCARDS,MODCRD,NFLD,ISTRT,LEN,ITYPE,NREP,INTGER,REAL,
     *  NCHAR,TSID,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
C
      IF (IPRFLD.EQ.1) THEN
      CALL UPRFLD (NFLD,ISTRT,LEN,ITYPE,NREP,INTGER,REAL,
     *  NCHAR,TSID,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      ENDIF
C
      IF (ITYPE.GT.-1) GO TO 10
C
C     END OF FILE
C
      ISTAT=1
      GO TO 40
C
C  GET DATA TYPE
C
10    ISTRT=-3
      NCHAR=1
      CALL UFIEL2 (NCARDS,MODCRD,NFLD,ISTRT,LEN,ITYPE,NREP,INTGER,REAL,
     *  NCHAR,DTYPE,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
C
      IF (IPRFLD.EQ.1) THEN
      CALL UPRFLD (NFLD,ISTRT,LEN,ITYPE,NREP,INTGER,REAL,
     *  NCHAR,DTYPE,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      ENDIF
C
      IF (ITYPE.GT.-1) GO TO 20
C
C     END OF FILE
C
      ISTAT=1
      GO TO 40
C
C  GET TIME INTERVAL - MUST BE INTEGER DIVISIBLE INTO 24
C
20    ISTRT=-3
      NCHAR=1
C
      CALL UFIEL2 (NCARDS,MODCRD,NFLD,ISTRT,LEN,ITYPE,NREP,IDT,REAL,
     *  NCHAR,IFIELD,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
C
      IF (IPRFLD.EQ.1) THEN
      CALL UPRFLD (NFLD,ISTRT,LEN,ITYPE,NREP,INTGER,REAL,
     *  NCHAR,IFIELD,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      ENDIF
C
      IF (ITYPE.EQ.0) GO TO 30
C
C     NOT A VALID INTEGER
C
      ISTAT=1
      GO TO 40
C
30    ISTAT=0
      IF (MOD(24,IDT).GT.0) ISTAT=1
C
40    CALL FSTWHR (OLDOPN,IOLDOP,OLDOPN,IOLDOP)
C
      RETURN
C
      END
