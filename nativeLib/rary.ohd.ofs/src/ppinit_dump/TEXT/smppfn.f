C MEMBER SMPPFN
C-----------------------------------------------------------------------
C
C DESC ROUTINE FOR PRINTING INDEX AND PARAMETER RECORD FOR SPECIFIED
C DESC IDENTIFIER AND TYPE.
C DESC PPINIT COMMAND :  @DUMP PPFNDR
C
      SUBROUTINE SMPPFN (NFLD,ISTAT)
C
      REAL SNGL/4HSNGL/
      REAL GENL/4HGENL/,STAN/4HSTAN/
      REAL USER/4HUSER/,UGNL/4HUGNL/
      REAL BLNK/4H    /
C
      DIMENSION CHAR(5),CHK(5),PARMID(2),IXBUF(4)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'pppcommon/ppdtdr'
      INCLUDE 'pppcommon/ppunts'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_dump/RCS/smppfn.f,v $
     . $',                                                             '
     .$Id: smppfn.f,v 1.1 1995/09/17 19:13:01 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,140)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG(4HDUMP)
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,150) LARRAY,NFLD
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      ISTAT=0
C
      ISTRT=0
      LCHAR=5
      LCHK=5
      ILPFND=0
      IRPFND=0
      NXTFLD=1
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK FIELDS FOR IDENTIFIERS
C
10    CALL UFIELD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,
     *   CHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
      IF (LDEBUG.GT.0)
     *   CALL UPRFLD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,
     *   CHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
      IF (IERR.NE.1) GO TO 20
         IF (LDEBUG.GT.0) WRITE (IOSDBG,190) IFIELD
         IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
         GO TO 10
C
C  CHECK FOR END OF INPUT
20    IF (NFLD.EQ.-1) GO TO 130
C
C  CHECK FOR COMMAND
      IF (LATSGN.EQ.1) GO TO 130
C
C  CHECK FOR PAIRED PARENTHESIS
      IF (ILPFND.GT.0.AND.IRPFND.EQ.0) GO TO 30
         GO TO 40
30    IF (NFLD.EQ.1) CALL SUPCRD
      WRITE (LP,200) NFLD
      CALL SULINE (LP,2)
      ILPFND=0
      IRPFND=0
40    IF (LLPAR.GT.0) ILPFND=1
      IF (LRPAR.GT.0) IRPFND=1
C
C  CHECK FOR PARENTHESIS IN FIELD
      IF (LLPAR.GT.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LLPAR-1,IERR)
      IF (LLPAR.EQ.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LENGTH,IERR)
C
      IF (NXTFLD.EQ.2) GO TO 50
C
C  CHECK FOR KEYWORD
      CALL SUIDCK (4HDUMP,CHK,NFLD,0,IKEYWD,IERR)
      IF (IERR.EQ.2) GO TO 130
         IF (LDEBUG.GT.0) WRITE (IOSDBG,160) CHK
         IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
50    IF (NFLD.EQ.1) CALL SUPCRD
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
      IF (NXTFLD.EQ.2) GO TO 70
C
C  SET IDENTIFIER
60    CALL SUBSTR (CHAR,1,8,PARMID,1)
      IF (LDEBUG.GT.0) WRITE (IOSDBG,170) PARMID
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
      NXTFLD=2
      GO TO 10
C
C  SET PARAMETER TYPE
70    TYPE=CHAR(1)
      IF (LDEBUG.GT.0) WRITE (IOSDBG,180) TYPE
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
80    IF (PARMID(1).NE.SNGL) GO TO 100
         IF (LENGTH.LE.4) GO TO 90
            WRITE (LP,210) LENGTH,CHAR(1),CHAR(2)
            CALL SUERRS (LP,2,-1)
            GO TO 120
90       PARMID(1)=BLNK
C
C  CHECK IF PARAMETER RECORD IS IN INDEX
100   CALL SUDOPN (1,4HPPP ,IERR)
      IF (IERR.GT.0) GO TO 120
      TYPEX=TYPE
      IF (TYPE.EQ.STAN) TYPEX=GENL
      IF (TYPE.EQ.UGNL) TYPEX=USER
      IFIND=1
      CALL PPFNDR (PARMID,TYPEX,IFIND,IXBUF,IFREE,IERR)
      IF (IERR.EQ.0.AND.IFIND.GT.0) GO TO 110
         IF (IFIND.EQ.0) WRITE (LP,220) TYPE,PARMID
         IF (IFIND.EQ.0) CALL SUWRNS (LP,2,-1)
         IF (IERR.EQ.0) WRITE (LP,225) TYPE,PARMID,IERR
         IF (IERR.EQ.0) CALL SUERRS (LP,2,-1)
         GO TO 120
C
110   CALL SUBLID (PARMID,IERR)
      WRITE (LP,230) TYPE,PARMID,IFIND
      CALL SULINE (LP,2)
      IDXDAT=IPCKDT(TYPEX)
      NUNIT=KPPRMU(IPDTDR(2,IDXDAT))
      WRITE (LP,240) IXBUF(4),NUNIT
      CALL SULINE (LP,1)
C
120   NXTFLD=1
      GO TO 10
C
130   IF (ISTRCE.GT.0) WRITE (IOSDBG,250)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
140   FORMAT (' *** ENTER SMPPFN')
150   FORMAT (' LARRAY=',I5,3X,'NFLD=',I2)
160   FORMAT (' INPUT FIELD = ',5A4)
170   FORMAT (' IDENTIFIER SET TO : ',2A4)
180   FORMAT (' TYPE SET TO : ',A4)
190   FORMAT (' NULL FIELD FOUND IN FIELD ',I2)
200   FORMAT ('0*** NOTE - RIGHT PARENTHESES ASSUMED IN FIELD ',
     *   I2,'.')
210   FORMAT ('0*** ERROR - NUMBER OF CHARACTERS (',I2,
     *   ') IN SINGLE RECORD PARAMETER TYPE SPECIFIED (',2A4,
     *   ') EXCEEDS 4.')
220   FORMAT ('0*** WARNING - ',A4,' PARAMETERS FOR IDENTIFIER ',2A4,
     *   ' NOT FOUND IN INDEX.')
225   FORMAT ('0*** ERROR - ACCESSING ',A4,' PARAMETERS FOR ID ',2A4,
     *   '. PPFNDR STATUS CODE=',I2,'.')
230   FORMAT ('0*** NOTE - ',A4,' PARAMETERS FOR IDENTIFIER ',2A4,
     *   ' SUCCESSFULLY FOUND AT RECORD ',I5,' OF INDEX.')
240   FORMAT (T13,'PARAMETER RECORD IS AT RECORD ',I5,' OF ',
     *   'PARAMETER FILE ',I2,'.')
250   FORMAT (' *** EXIT SMPPFN')
C
      END
