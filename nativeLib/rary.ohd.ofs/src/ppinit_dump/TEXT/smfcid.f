C MEMBER SMFCID
C-----------------------------------------------------------------------
C
C  ROUTINE FOR PRINTING THE NAMES OF TIME SERIES USED IN THE
C  FORECAST COMPONENT
C
      SUBROUTINE SMFCID (LARRAY,ARRAY,NFLD,ISTAT)
C
      REAL FCID(2)/4HFCID,4H    /
      REAL*8 DMPOPT,DPCHK
      REAL*8 XSORT/8HSORT    /,XNSRT/8HNOSORT  /
C
      DIMENSION CHAR(5),CHK(5)
      DIMENSION ARRAY(LARRAY),ISPTR(1)
      DIMENSION TYPE(2)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'scommon/sworkx'
C
      EQUIVALENCE (ISPTR(1),SWORK(1))
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_dump/RCS/smfcid.f,v $
     . $',                                                             '
     .$Id: smfcid.f,v 1.2 1997/04/06 12:22:56 page Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,180)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('DUMP')
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,190) LARRAY,NFLD
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      ISTAT=0
C
      ISTRT=-1
      LCHAR=5
      LCHK=5
      LDPCHK=2
      ILPFND=0
      IRPFND=0
      NUMFLD=0
      NUMERR=0
      NPRINT=0
      DMPOPT=XNSRT
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK FIELDS FOR TIME SERIES TYPE
C
10    CALL UFIELD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,
     *   CHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IRUFLD)
      IF (LDEBUG.GT.0)
     *   CALL UPRFLD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,
     *   CHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IRUFLD)
      IF (IRUFLD.NE.1) GO TO 20
         IF (LDEBUG.GT.0) WRITE (IOSDBG,230) IFIELD
         IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
         GO TO 10
C
C  CHECK FOR END OF INPUT
20    IF (NFLD.EQ.-1) GO TO 160
C
C  CHECK FOR COMMAND
      IF (LATSGN.EQ.1) GO TO 160
C
C  CHECK FOR PAIRED PARENTHESIS
      IF (ILPFND.GT.0.AND.IRPFND.EQ.0) GO TO 30
         GO TO 40
30    IF (NFLD.EQ.1) CALL SUPCRD
      WRITE (LP,240) NFLD
      CALL SULINE (LP,2)
      ILPFND=0
      IRPFND=0
40    IF (LLPAR.GT.0) ILPFND=1
      IF (LRPAR.GT.0) IRPFND=1
C
C  CHECK FOR PARENTHESIS IN FIELD
      IF (LLPAR.GT.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LLPAR-1,IERR)
      IF (LLPAR.EQ.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LENGTH,IERR)
C
      NUMFLD=NUMFLD+1
      IF (NUMFLD.GT.1) GO TO 90
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK OPTION
      TYPE(1)=CHK(1)
      TYPE(2)=CHK(2)
      IF (TYPE(1).EQ.FCID(1).AND.TYPE(2).EQ.FCID(2)) GO TO 50
         WRITE (LP,210) CHK(1)
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
50    IF (NFLD.EQ.1) CALL SUPCRD
C
C  CHECK DUMP TYPE
      IF (LLPAR.EQ.0) GO TO 80
      IF (LRPAR.GT.0) GO TO 60
         WRITE (LP,240) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
60    CALL UFPACK (LDPCHK,DPCHK,ISTRT,LLPAR+1,LRPAR-1,IERR)
      IF (DPCHK.EQ.XSORT.OR.DPCHK.EQ.XNSRT) GO TO 70
         WRITE (LP,250) NFLD,DPCHK
         CALL SUERRS (LP,2,NUMERR)
         NUMERR=NUMERR+1
         GO TO 80
70    DMPOPT=DPCHK
      IF (LDEBUG.GT.0) WRITE (LP,270) DMPOPT
      IF (LDEBUG.GT.0) CALL SULINE (LP,1)
80    WRITE (LP,260) DMPOPT
      CALL SULINE (LP,2)
      ISORT=0
      IF (DMPOPT.EQ.XSORT) ISORT=1
      GO TO 10
C
C  CHECK FOR KEYWORD
90    CALL SUIDCK ('DMPG',CHK,NFLD,0,IKEYWD,IRIDCK)
      IF (IRIDCK.EQ.2) GO TO 160
         IF (LDEBUG.GT.0) WRITE (IOSDBG,220) CHK
         IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      IF (NFLD.EQ.1) CALL SUPCRD
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  SET PARAMETER TYPE
      TYPE(1)=CHAR(1)
      IF (LENGTH.LE.4) GO TO 100
         WRITE (LP,280) LENGTH,CHAR(1),CHAR(2)
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
C
C  READ TIME SERIES IDENTIFIERS FROM FORECAST COMPONENT DATA BASE
100   CALL SUDOPN (1,'FC  ',IERR)
      IF (IERR.GT.0) GO TO 10
      TYPEX=TYPE(1)
      MAXID=LSWORK/10
      IFILFC=1
      IPRMSG=1
      CALL SUGTFC (TYPEX,MAXID,SWORK(MAXID+1),NUMID,IFILFC,
     *   SWORK(MAXID*3+1),SWORK(MAXID*5+1),SWORK(MAXID*7+1),
     *   IPRMSG,IERR)
      IF (IERR.EQ.0) GO TO 110
         WRITE (LP,290) TYPEX
         CALL SULINE (LP,2)
         GO TO 10
110   IF (NUMID.GT.0) GO TO 120
         WRITE (LP,350) TYPEX
         CALL SULINE (LP,2)
         GO TO 10
C
C  SORT LIST IF OPTION SPECIFIED
120   NWORDS=2
      IF (ISORT.EQ.0) GO TO 140
         ISPTR(1)=1
         IF (LARRAY/2.GT.NUMID) GO TO 130
            WRITE (LP,300) LARRAY,NUMID
            CALL SUERRS (LP,2,NUMERR)
            GO TO 10
130      CALL SUSORT (NWORDS,NUMID,SWORK(MAXID+1),ARRAY(1),
     *      ISPTR(1),IERR)
C
C  PRINT LIST OF IDENTIFIERS
140   IF (ISORT.EQ.0) WRITE (LP,320) TYPEX
      IF (ISORT.EQ.1) WRITE (LP,330) TYPEX
      CALL SULINE (LP,2)
      WRITE (LP,200)
      CALL SULINE (LP,1)
      WRITE (LP,310) TYPEX
      CALL SULINE (LP,3)
      WRITE (LP,200)
      CALL SULINE (LP,1)
      DO 150 I=1,NUMID
         IF (ISORT.EQ.0) IPOS=I*2-1
         IF (ISORT.EQ.1) IPOS=ISPTR(I)*2-1
         WRITE (LP,340) I,SWORK(MAXID+IPOS),SWORK(MAXID+IPOS+1),
     *           SWORK(MAXID*3+IPOS),SWORK(MAXID*3+IPOS+1),
     *           SWORK(MAXID*5+IPOS),SWORK(MAXID*5+IPOS+1),
     *           SWORK(MAXID*7+IPOS),SWORK(MAXID*7+IPOS+1)
         CALL SULINE (LP,1)
150      CONTINUE
      NPRINT=NPRINT+1
C
      GO TO 10
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  PRINT NUMBER OF PARAMETERS PRINTED
160   IF (NPRINT.EQ.0) WRITE (LP,360)
      IF (NPRINT.GT.0) WRITE (LP,370) NPRINT
      CALL SULINE (LP,2)
C
170   IF (ISTRCE.GT.0) WRITE (IOSDBG,380)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
180   FORMAT (' *** ENTER SMFCID')
190   FORMAT (' LARRAY=',I4,3X,'NFLD=',I2)
200   FORMAT (1H )
210   FORMAT ('0*** ERROR IN SMFCID - ',A4,' IS AN INVALID OPTION.')
220   FORMAT (' INPUT FIELD = ',5A4)
230   FORMAT (' NULL FIELD FOUND IN FIELD ',I2)
240   FORMAT ('0*** NOTE - RIGHT PARENTHESES ASSUMED IN FIELD ',
     *   I2,'.')
250   FORMAT ('0*** ERROR - CARD FIELD ',I2,' HAS AN INVALID DUMP ',
     *   'FCID OPTION : ',A8)
260   FORMAT ('0DUMP FCID OPTION IN EFFECT = ',A8)
270   FORMAT (' DUMP FCID OPTION IS ',A8)
280   FORMAT ('0*** ERROR - NUMBER OF CHARACTERS (',I2,
     *   ') IN TIME SERIES TYPE TYPE SPECIFIED (',2A4,
     *   ') EXCEEDS 4.')
290   FORMAT ('0*** ERROR IN SMFCID - LIST OF FORECAST ',
     *   'COMPONENT IDENTIFIERS FOR TYPE ',A4,' NOT ',
     *   'SUCCESSFULLY OBTAINED.')
300   FORMAT ('0*** ERROR IN SMFCID - LENGTH OF ARRAY TO BE ',
     *   'FOR SORTING IDENTIFIERS (',I5,') IS NOT LARGE ENOUGH ',
     *   'TO PROCESS ',I5,' IDENTIFIERS.')
320   FORMAT ('0- FORECAST COMPONENT IDENTIFIERS FOR TYPE  ',A4,
     *   '  IN COMPUTATIONAL ORDER -')
330   FORMAT ('0- FORECAST COMPONENT IDENTIFIERS FOR TYPE  ',A4,
     *   '  IN ALPHABETICAL ORDER -')
310   FORMAT (11X,A4,11X,'CARRYOVER',5X,'FORECAST',5X,'SEGMENT' /
     *   11X,'IDENTIFIER',5X,'GROUP',9X,'GROUP',8X,'IDENTIFIER' /
     *   11X,10(1H-),5X,9(1H-),5X,8(1H-),5X,10(1H-))
340   FORMAT (5X,I4,2X,2A4,7X,2A4,6X,2(2A4,5X))
350   FORMAT ('0*** NOTE - NO ',A4,' FORECAST COMPONENT TIME ',
     *   'SERIES IDENTIFIER TYPES FOUND.')
360   FORMAT ('0*** NOTE - NO  IDENTIFIER TYPES SUCCESSFULLY PRINTED.')
370   FORMAT ('0*** NOTE - ',I3,' IDENTIFIER TYPES ',
     *   'SUCCESSFULLY PRINTED.')
380   FORMAT (' *** EXIT SMFCID')
C
      END
