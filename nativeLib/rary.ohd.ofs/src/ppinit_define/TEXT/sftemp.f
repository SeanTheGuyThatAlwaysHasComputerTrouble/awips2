C MODULE SFTEMP
C-----------------------------------------------------------------------
C
C  ROUTINE TO DEFINE STATION TEMPERATURE PARAMETERS.
C
      SUBROUTINE SFTEMP (LARRAY,ARRAY,DISP,TDISP,IRUNCK,
     *   PRPARM,PRNOTE,UNITS,NFLD,
     *   STAID,DESCRP,STATE,NBRSTA,
     *   ICSTANO,ILTLNN,IELEVN,IFSTAN,
     *   ITTAVR,ITYOBS,IPMMMT,TEMPCF,ITFMMO,ITFMM,TEMPFEO,TEMPFE,
     *   NPTEMP,IPMMMTO,IPMMMTN,TMPMAX,TMPMIN,
     *   NSTERR,NSTWRN,IWRITE,LPTEMP,NSPACE,ISTAT)
C
      CHARACTER*4 DISP,TDISP,PRPARM,PRNOTE,UNITS,UCODE,TYPE,WDISP
      PARAMETER (MOPTN=8)
      CHARACTER*8 OPTN(MOPTN)
     *   /'MX      ','MN      ','CF      ','FMM     ',
     *    'NFMM    ','FE      ','        ','        '/
      CHARACTER*20 CHAR/' '/,CHK/' '/
C
      DIMENSION ARRAY(LARRAY)
      DIMENSION UNUSED(2)
C
C  STAN PARAMETER ARRAYS 
       INCLUDE 'scommon/dimstan' 
C
C  TEMP PARAMETER ARRAYS
      INCLUDE 'scommon/dimtemp'
      DIMENSION VALMAX(MAXTMP),VALMIN(MAXTMP)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_define/RCS/sftemp.f,v $
     . $',                                                             '
     .$Id: sftemp.f,v 1.3 1998/04/07 15:13:00 page Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,1320)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('TEMP')
C
      ISTAT=0
C      
      LCHAR=LEN(CHAR)/4
      LCHK=LEN(CHK)/4
C
      TDISP=DISP
C
C  SET VALUE FOR MISSING PARAMETER
      UNSD=-999.
      UNDEF=-997.
C
      NUMERR=0
      NUMWRN=0
      ILPFND=0
      IRPFND=0
      ISTRT=-1
      NUMFLD=0
      MINFLD=4
      MAXFLD=8
      INWIND=0
      NOPFLD=0
      NXTFLD=0
      NPIFLD=0
      NPCFLD=NFLD
      IENDIN=0
      NPTEMP=0
C
      IOFLD1=0
      IOFLD2=0
      IOFLD3=0
      IOFLD5=0
C
      IDTIME=6
      ITYFLG=0
      ITTAVR=0
      DO 15 I=1,3
         DO 10 J=1,4
            IPDMMT(I,J)=0
            WTMMT(I,J)=0.0
            IPDINS(I,J)=0
            WTINS(I,J)=0.0
10          CONTINUE
15       CONTINUE
      DO 25 I=1,2
         DO 20 J=1,4
            IPDFMM(I,J)=0
            WTFMM(I,J)=0.0
20          CONTINUE
25       CONTINUE
      NUMCF=0
      TEMPCF(1)=0.0
      TEMPCF(2)=0.0
      NUMMAX=0
      NUMMIN=0
      DO 30 I=1,MAXTMP
         TMPMAX(I)=UNDEF
         TMPMIN(I)=UNDEF
30       CONTINUE
      NUMFE=0
      TEMPFE=0.0
      IMTN=0
C
C  CHECK NUMBER OF LINES LEFT ON PAGE
      IF (ISLEFT(5).GT.0) CALL SUPAGE
C
C  PRINT CARD
      CALL SUPCRD
C
C  PRINT HEADER LINE
      WRITE (LP,1330)
      CALL SULINE (LP,2)
      WRITE (LP,1340)
      CALL SULINE (LP,2)
C
      IF (LDEBUG.GT.0) THEN
C     PRINT OPTIONS
         WRITE (LP,1350) TDISP,PRPARM,PRNOTE,UNITS
         CALL SULINE (LP,2)
         ENDIF
C         
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK IF PREPROCESSOR PARAMETRIC DATA BASE ALLOCATED
C
      IDPPP=1
      CALL SUDALC (0,0,0,0,IDPPP,0,0,0,0,0,NUMERR,IERR)
      IF (IERR.NE.0) THEN
         WRITE (LP,1400)
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK STATION IDENTIFIER
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,*) 'STAID=',STAID
         CALL SULINE (IOSDBG,1)
         ENDIF
      IF (STAID.EQ.'????????') THEN
         WRITE (LP,1390)
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  STORE CURRENT ATTRIBUTES
      TDESCRP=DESCRP
      TSTATE=STATE
      TNBRSTA=NBRSTA
C
C  CHECK IF STATION EXISTS
      IPRERR=0
      IPTR=0
      IREAD=1
      INCLUDE 'scommon/callsrtemp'
      IF (IERR.EQ.0) THEN
         ITFMMO=ITFMM
         TEMPFEO=TEMPFE      
C     RESET STATION ATTRIBUTES
         DESCRP=TDESCRP
         STATE=TSTATE
         NBRSTA=TNBRSTA
         IF (LDEBUG.GT.0) THEN
            IPRNT=1
            LEVEL=1
            INCLUDE 'scommon/callsptemp'
            ENDIF
         ENDIF
C
C  STATION EXIST AND DISP IS NEW
      IF (IERR.EQ.0.AND.TDISP.EQ.'NEW') THEN
         WRITE (LP,1370) STAID
         CALL SULINE (LP,2)
         TDISP='OLD'
         GO TO 100
         ENDIF
C
C  STATION DOES NOT EXIST AND DISP IS OLD
      IF (IERR.GT.0.AND.TDISP.EQ.'OLD') THEN
         WRITE (LP,1380) STAID
         CALL SUWRNS (LP,2,NUMWRN)
         TDISP='NEW'
         ENDIF
C
C  CHECK IF STATION HAS MEAN TEMPS
100   IF (IPMMMT.GT.0) THEN
C     READ MAX AND MIN MEAN TEMPERATURES
         CALL RPP1MT (IPMMMT,TMPMAX,TMPMIN,IERR)
         IF (IERR.NE.0) THEN
            IF (IERR.EQ.1) THEN
               WRITE (LP,1430)
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.EQ.2) THEN
               WRITE (LP,1440) IPMMMT
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.EQ.3) THEN
               WRITE (LP,2025)
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.LT.0.OR.IERR.GT.3) THEN
               WRITE (LP,1460) IERR
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            GO TO 120
            ENDIF
         IPMMMTO=IPMMMT
         IF (LDEBUG.GT.0) THEN
            WRITE (LP,1410)
            CALL SULINE (LP,2)
            IF (UNITS.EQ.'ENGL') THEN
               UCODE='DEGF'
               CALL UMEMOV (TMPMAX,VALMAX,MAXTMP)
               CALL UMEMOV (TMPMIN,VALMIN,MAXTMP)
               GO TO 110
               ENDIF
            UCODE='DEGC'
            ICONV=1
            NVAL=MAXTMP
            CALL UDUCNV ('DEGF','DEGC',ICONV,NVAL,TMPMAX,VALMAX,IERR)
            CALL UDUCNV ('DEGF','DEGC',ICONV,NVAL,TMPMIN,VALMIN,IERR)
110         WRITE (LP,1420) 'MAX',VALMAX,UCODE
            CALL SULINE (LP,2)
            WRITE (LP,1420) 'MIN',VALMIN,UCODE
            CALL SULINE (LP,2)
            ENDIF
         ENDIF
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK FIELDS FOR DEFINE STATION TEMP OPTIONS
120   IF (INWIND.EQ.0) GO TO 130
         INULL=1
         GO TO 200
130   INULL=0
      NULREP=0
      CALL UFIELD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,CHAR,
     *   LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
      IF (NFLD.NE.-1) GO TO 140
      IENDIN=1
      GO TO 180
140   IF (LDEBUG.GT.0) THEN
         CALL UPRFLD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,LCHAR,
     *      CHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
         ENDIF
C
C  CHECK FOR NULL FIELD
      IF (IERR.NE.1) GO TO 160
         IF (LDEBUG.GT.0) THEN
            WRITE (IOSDBG,1550) NFLD
            CALL SULINE (IOSDBG,1)
            ENDIF
         IF (TDISP.EQ.'NEW') GO TO 150
            NUMFLD=NUMFLD+1
            IF (NFLD.EQ.1) CALL SUPCRD
            GO TO 120
150      INULL=1
         GO TO 300
C
160   IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,*) 'CHAR=',CHAR
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK FOR DEBUG
      CALL SUIDCK ('CMDS',CHAR,NFLD,0,ICMD,IERR)
      IF (ICMD.EQ.1) THEN
         CALL SBDBUG (NFLD,ISTRT,IERR)
         LDEBUG=ISBUG('TEMP')
         GO TO 130
         ENDIF
C
      IF (NXTFLD.GT.0) GO TO 190
C
C  CHECK FOR PAIRED PARENTHESES
180   CALL SUPFND (ILPFND,IRPFND,NPIFLD,NPCFLD)
C
190   IF (IENDIN.EQ.1) GO TO 270
C
C  CHECK IF DISP IS NEW AND ALL FIELDS FOUND
200   IF (INWIND.EQ.0) GO TO 210
         IF (NUMFLD.NE.MINFLD) GO TO 290
            INWIND=0
            IF (IENDIN.EQ.1) GO TO 1200
            GO TO 120
C
C  CHECK FOR REPEATED NULL FIELD
210   IF (CHAR.EQ.',,'.OR.CHAR.EQ.'NULL') THEN
         IF (LDEBUG.GT.0) THEN
            WRITE (IOSDBG,*) 'NREP=',NREP
            CALL SULINE (IOSDBG,1)
            ENDIF
         IF (NREP.GT.0.AND.NREP+NUMFLD.LE.MINFLD) GO TO 220
            WRITE (LP,1520) NREP,NUMFLD,MINFLD
            CALL SUERRS (LP,2,NUMERR)
            NREP=MAXFLD-NUMFLD
220      NULREP=NREP
         INWIND=1
         NOPFLD=0
         NXTFLD=0
         INULL=1
         GO TO 290
         ENDIF
C
C  CHECK FOR COMMAND
      IF (LATSGN.EQ.1) THEN
         IENDIN=1
         GO TO 180
         ENDIF
C
C  CHECK FOR PARENTHESIS IN FIELD
      IF (CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 290
      IF (CHAR.EQ.')'.AND.LENGTH.EQ.1) GO TO 290
      IF (LLPAR.GT.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LLPAR-1,IERR)
      IF (LLPAR.EQ.0) CALL UFPACK (LCHK,CHK,ISTRT,1,LENGTH,IERR)
C
C  CHECK FOR END OF INPUT
      IF (CHK.EQ.'/') THEN
         IENDIN=1
         GO TO 180
         ENDIF
C
C  IF FIRST FIELD, CONTENTS HAS BEEN CHECKED FOR KEYWORD
      IF (NUMFLD.EQ.0) GO TO 290
C
C  CHECK FOR KEYWORD
      CALL SUIDCK ('DEFN',CHK,NFLD,0,IKEYWD,IERR)
      IF (IERR.NE.2) GO TO 290
270      CALL SUPFND (ILPFND,IRPFND,NPIFLD,NPCFLD)
         IF (NUMFLD.LT.MINFLD) THEN
            INWIND=1
            NOPFLD=0
            NXTFLD=0
            IENDIN=1
            IF (PRNOTE.EQ.'YES') THEN
               WRITE (LP,1580)
               CALL SULINE (LP,2)
               ENDIF
            GO TO 120
            ENDIF
         GO TO 1200
C
C  PRINT CARD
290   IF (NFLD.EQ.1.AND.NUMFLD.GT.0.AND.INWIND.EQ.0) CALL SUPCRD
C
300   IF (NUMFLD+1.LE.MINFLD) GO TO 340
C
C  CHECK FOR OPTIONAL FIELDS
      IF (NUMFLD.GT.MAXFLD) GO TO 330
         IF (NOPFLD.GT.0.AND.CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 340
         IF (NOPFLD.GT.0.AND.CHAR.EQ.')'.AND.LENGTH.EQ.1) GO TO 340
            DO 310 IOPTN=1,MOPTN
               IF (CHK.EQ.OPTN(IOPTN)) GO TO 320
310            CONTINUE
         IF (NXTFLD.GT.0) GO TO 340
         IF (ITYFLG.EQ.1) GO TO 790
            WRITE (LP,1470) NUMFLD,NFLD,CHAR
            CALL SUERRS (LP,2,NUMERR)
            GO TO 120
320      NOPFLD=0
         NXTFLD=0
         CALL SUPFND (ILPFND,IRPFND,NPIFLD,NPCFLD)
         GO TO (390,570,830,990,990,1030),IOPTN
         WRITE (LP,1650) IOPTN
         CALL SUERRS (LP,2,NUMERR)
         GO TO 120
C
330      WRITE (LP,1500) NUMFLD,MAXFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 120
C
C  CHECK FOR PARENTHESES IN FIELD
340   IF (NOPFLD.EQ.0) CALL SUPFND (ILPFND,IRPFND,NPIFLD,NPCFLD)
      IF (LLPAR.GT.0) ILPFND=1
      IF (LRPAR.GT.0) IRPFND=1
C
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1360) NUMFLD,MINFLD,MAXFLD,NUMERR,
     *      NOPFLD,NXTFLD,CHK
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK IF FIELD WITH MORE THAN ONE POSSIBLE PARAMETER
      IF (NOPFLD.GT.0) GO TO (390,570,830,1030),NOPFLD
C
C  CHECK IF MAXIMUM NUMBER OF FIELDS EXPECTED EXCEEDED
350   NUMFLD=NUMFLD+1
      IF (TDISP.EQ.'OLD'.AND.INULL.EQ.1) GO TO 120
C
      GO TO (360,390,570,750,790),NUMFLD
         WRITE (LP,1480) CHAR
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C    CHECK PARAMETER TYPE
360   IF (CHK.EQ.'TEMP') GO TO 370
         WRITE (LP,1490) 'TEMP',NFLD,CHK(1:LENSTR(CHK))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 120
370   TYPE=CHK
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,*) 'TYPE=',TYPE
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK IF UNITS SPECIFIED
      IF (LLPAR.EQ.0) GO TO 120
      IEND=LRPAR-1
      IF (LRPAR.GT.0) GO TO 380
         WRITE (LP,1560) NUMFLD,NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH-1
380   CALL UFPACK (LCHK,CHK,ISTRT,LLPAR+1,IEND,IERR)
      WRITE (LP,1540) CHK(1:LENSTR(CHK)),NFLD
      CALL SULINE (LP,2)
      GO TO 120
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK IF MIN TEMP INDICATOR FOUND
390   IF (CHK.EQ.OPTN(2)) THEN
         IF (NOPFLD.GT.0) NUMFLD=NUMFLD+1
         NOPFLD=0
         NXTFLD=0
         GO TO 580
         ENDIF
C
C  MEAN MONTHLY MAXIMUM TEMPERATURES
C
C  CHECK WHICH FIELD TO BE PROCESSED
400   NGOTO=NXTFLD+1
      GO TO (410,470),NGOTO
C
C  CHECK IF OPTIONAL FIELD ALREADY SPECIFIED
410   IF (IOFLD1.EQ.0) GO TO 420
         WRITE (LP,1800)
         CALL SUWRNS (LP,2,NUMWRN)
         NUMMAX=0
C
420   IOFLD1=1
C
C  CHECK FOR NULL FIELD
      IF (INULL.EQ.0) GO TO 430
         WRITE (LP,1590) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK IF CHARACTER DATA
430   IF (ITYPE.EQ.2) GO TO 440
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR PARENTHESES IN FIELD
440   IF (CHAR.EQ.')') THEN
         NOPFLD=0
         NXTFLD=0
         WRITE (LP,1810) 'MAX',NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
      IF (LLPAR.EQ.0) CHK=CHAR
      IF (LLPAR.GT.0) CALL SUBSTR (CHAR,1,LLPAR-1,CHK,1)
      IF (CHK.NE.OPTN(1)) THEN
         WRITE (LP,1830) 'MAX',CHK(1:LENSTR(CHK)),NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)         
         GO TO 1180
         ENDIF
      NOPFLD=1
      NXTFLD=1
      IF (LLPAR.EQ.0.OR.LLPAR.EQ.LENGTH) GO TO 1180
C
C  CHECK FOR SPECIAL CHARACTERS
470   IF (CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 1180
      IF (ITYPE.NE.2) GO TO 500
         IF (LRPAR.NE.1) GO TO 490
            IF (NUMMAX.EQ.0) GO TO 480
               NOPFLD=0
               NXTFLD=0
               GO TO 1180
480         WRITE (LP,1860) 'MAX'
            CALL SUERRS (LP,2,NUMERR)
            NOPFLD=0
            NXTFLD=0
            GO TO 1180
490      IF (LRPAR.EQ.0.OR.LRPAR.EQ.LENGTH) GO TO 500
            WRITE (LP,1630) NUMFLD,NFLD
            CALL SUERRS (LP,2,NUMERR)
            NXTFLD=1
            GO TO 1180
500   IF (LLPAR.EQ.0) IBEG=1
      IF (LLPAR.GT.0) IBEG=LLPAR+1
      IF (LASK.GT.0) IBEG=LASK+1
      IEND=LENGTH
      IF (LRPAR.EQ.0) GO TO 510
         IEND=LRPAR-1
         NOPFLD=0
         NXTFLD=0
510   CALL UFRLFX (TMAX,ISTRT,IBEG,IEND,0,IERR)
      IF (IERR.NE.0) THEN
         WRITE (LP,1840) NFLD
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  CHECK FOR MAXIMUM NUMBER OF VALUES
520   NUMMAX=NUMMAX+1
      IF (NUMMAX.EQ.MAXTMP) CALL SUPFND (ILPFND,IRPFND,NUMFLD,0)
      IF (NUMMAX.LE.MAXTMP) GO TO 530
         WRITE (LP,1850) 'MAX',MAXTMP,NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 550
530   IF (TMAX.GT.-99.AND.TMAX.LE.999) GO TO 540
         WRITE (LP,1870) 'MAX',NUMMAX,TMAX
         CALL SUERRS (LP,2,NUMERR)
         GO TO 550
C
C  SET MEAN MAX TEMP
540   TMPMAX(NUMMAX)=TMAX
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1970) 'MAX',NUMMAX,TMPMAX(NUMMAX)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK FOR REPEATED VALUES
550   IF (NREP.GT.1) THEN
         NREP=NREP-1
         GO TO 520
         ENDIF
C
      NXTFLD=1
      IF (LRPAR.EQ.0) GO TO 1180
         NOPFLD=0
         NXTFLD=0
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK IF MAX TEMP INDICATOR FOUND
570   IF (CHK.EQ.OPTN(1)) THEN
         IF (NOPFLD.GT.0) NUMFLD=NUMFLD+1
         NOPFLD=0
         NXTFLD=0
         GO TO 400
         ENDIF
C
C  MEAN MONTHLY MINIMUM TEMPERATURES
C
C  CHECK WHICH FIELD TO BE PROCESSED
580   NGOTO=NXTFLD+1
      GO TO (590,650),NGOTO
C
C  CHECK IF OPTIONAL FIELD ALREADY SPECIFIED
590   IF (IOFLD2.EQ.0) GO TO 600
         WRITE (LP,1820)
         CALL SUWRNS (LP,2,NUMWRN)
         NUMMAX=0
C
600   IOFLD2=1
C
C  CHECK FOR NULL FIELD
      IF (INULL.EQ.0) GO TO 610
         WRITE (LP,1590) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK IF CHARACTER DATA
610   IF (ITYPE.EQ.2) GO TO 620
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR PARENTHESES IN FIELD
620   IF (CHAR.EQ.')') THEN
         NOPFLD=0
         NXTFLD=0
         WRITE (LP,1810) 'MIN',NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
      IF (LLPAR.EQ.0) CHK=CHAR
      IF (LLPAR.GT.0) CALL SUBSTR (CHAR,1,LLPAR-1,CHK,1)
      IF (CHK.NE.OPTN(2)) THEN
         WRITE (LP,1830) 'MIN',CHK(1:LENSTR(CHK)),NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
      NOPFLD=2
      NXTFLD=1
      IF (LLPAR.EQ.0.OR.LLPAR.EQ.LENGTH) GO TO 1180
C
C  CHECK FOR SPECIAL CHARACTERS
650   IF (CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 1180
      IF (ITYPE.NE.2) GO TO 680
         IF (LRPAR.NE.1) GO TO 670
            IF (NUMMIN.EQ.0) GO TO 660
               NOPFLD=0
               NXTFLD=0
               GO TO 1180
660         WRITE (LP,1860) 'MIN'
            CALL SUERRS (LP,2,NUMERR)
            NOPFLD=0
            NXTFLD=0
            GO TO 1180
670      IF (LRPAR.EQ.0.OR.LRPAR.EQ.LENGTH) GO TO 680
            WRITE (LP,1630) NUMFLD,NFLD
            CALL SUERRS (LP,2,NUMERR)
            NXTFLD=1
            GO TO 1180
680   IF (LLPAR.EQ.0) IBEG=1
      IF (LLPAR.GT.0) IBEG=LLPAR+1
      IF (LASK.GT.0) IBEG=LASK+1
      IEND=LENGTH
      IF (LRPAR.EQ.0) GO TO 690
         IEND=LRPAR-1
         NOPFLD=0
         NXTFLD=0
690   CALL UFRLFX (TMIN,ISTRT,IBEG,IEND,0,IERR)
      IF (IERR.NE.0) THEN
         WRITE (LP,1840) NFLD
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  CHECK FOR MAXIMUM NUMBER OF VALUES
700   NUMMIN=NUMMIN+1
      IF (NUMMIN.EQ.MAXTMP) CALL SUPFND (ILPFND,IRPFND,NUMFLD,0)
      IF (NUMMIN.LE.MAXTMP) GO TO 710
         WRITE (LP,1850) 'MIN',MAXTMP,NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 730
710   IF (TMIN.GT.-99.AND.TMIN.LE.999) GO TO 720
         WRITE (LP,1870) 'MIN',NUMMIN,TMIN
         CALL SUERRS (LP,2,NUMERR)
         GO TO 730
C
C  SET MEAN MAX TEMP
720   TMPMIN(NUMMIN)=TMIN
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1970) 'MIN',NUMMIN,TMPMIN(NUMMIN)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK FOR REPEATED VALUES
730   IF (NREP.GT.1) THEN
         NREP=NREP-1
         GO TO 700
         ENDIF
C
      NXTFLD=1
      IF (LRPAR.EQ.0) GO TO 1180
         NOPFLD=0
         NXTFLD=0
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  TYPE OF DATA OBSERVED
C
C  CHECK FOR NULL FIELD
750   IF (INULL.EQ.1) THEN
         CHAR='MXMN'
         IF (PRNOTE.EQ.'YES') THEN
            WRITE (LP,1620) NUMFLD,NPCFLD,CHAR(1:LENSTR(CHAR))
            CALL SULINE (LP,2)
            ENDIF
         GO TO 770
         ENDIF
C
C  CHECK IF CHARACTER DATA
      IF (ITYPE.NE.2) THEN
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
C         
C  CHECK IF VALID VALUE
770   IF (CHAR.EQ.'MXMN'.OR.
     *    CHAR.EQ.'INST'.OR.
     *    CHAR.EQ.'BOTH'.OR.
     *    CHAR.EQ.'SYN') GO TO 780
         WRITE (LP,1680) NUMFLD,NFLD,CHAR(1:LENSTR(CHAR))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  SET TYPE OF DATA OBSERVED
780   IF (CHAR.EQ.'MXMN') ITYOBS=1
      IF (CHAR.EQ.'INST') ITYOBS=2
      IF (CHAR.EQ.'BOTH') ITYOBS=3
      IF (CHAR.EQ.'SYN') ITYOBS=4
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1930) ITYOBS,CHAR(1:LENSTR(CHAR))
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      IF (ITYOBS.EQ.1.OR.ITYOBS.EQ.4) GO TO 1180
      ITYFLG=1
C
      GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  REPORTING TIME INTERVAL
C
C  USE DEFAULT IF NULL FIELD
790   IF (INULL.EQ.1) THEN
         IF (ITYOBS.EQ.1.OR.ITYOBS.EQ.4) GO TO 1180
         INTEGR=IDTIME
         IF (PRNOTE.EQ.'YES') THEN
            WRITE (LP,1610) NUMFLD,NFLD,INTEGR
            CALL SULINE (LP,2)
            ENDIF
         GO TO 820
         ENDIF
C
C  CHECK IF INTEGER VALUE
      IF (ITYPE.NE.0) THEN
         WRITE (LP,1640) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
C
C  CHECK FOR VALID VALUE
      IF (INTEGR.EQ.1.OR.INTEGR.EQ.3.OR.INTEGR.EQ.6) GO TO 820
         WRITE (LP,1660) INTEGR
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  SET REPORTING TIME INTERVAL
820   ITTAVR=INTEGR
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1920) ITTAVR
         CALL SULINE (IOSDBG,1)
         ENDIF
      ITYFLG=0
C
C  CHECK IF STATION HAS MXMN DATA
      IF (ITYOBS.EQ.2.OR.ITYOBS.EQ.3) GO TO 1180
         WRITE (LP,1670)
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CORRECTION FACTORS
C
C  CHECK WHICH FIELD TO BE PROCESSED
830   NGOTO=NXTFLD+1
      GO TO (840,900),NGOTO
C
C  CHECK IF OPTIONAL FIELD PREVIOUSLY PROCESSED
840   IF (IOFLD3.EQ.0) GO TO 850
         WRITE (LP,1750)
         CALL SUWRNS (LP,2,NUMWRN)
         NUMCF=0
C
850   IOFLD3=1
      CALL SUPFND (ILPFND,IRPFND,NUMFLD,0)
C
C  CHECK FOR NULL FIELD
      IF (INULL.EQ.0) GO TO 860
         WRITE (LP,1600) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR CHARACTER DATA
860   IF (ITYPE.EQ.2) GO TO 870
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR PARENTHESES IN FIELD
870   IF (CHAR.NE.')') GO TO 880
         NOPFLD=0
         NXTFLD=0
         WRITE (LP,1760) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
880   IF (LLPAR.EQ.0) CHK=CHAR
      IF (LLPAR.GT.0) CALL SUBSTR (CHAR,1,LLPAR-1,CHK,1)
      IF (CHK.NE.'CF') THEN
         WRITE (LP,1770) CHK(1:LENSTR(CHK)),NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
      NOPFLD=3
      NXTFLD=1
      IF (LLPAR.EQ.0.OR.LLPAR.EQ.LENGTH) GO TO 1180
C
C  CHECK FOR SPECIAL CHARACTERS
900   IF (CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 1180
      IF (ITYPE.NE.2) GO TO 920
         IF (LRPAR.NE.1) GO TO 910
         IF (NUMCF.GT.0) GO TO 1180
            WRITE (LP,1780)
            CALL SUERRS (LP,2,NUMERR)
            NOPFLD=0
            NXTFLD=0
            GO TO 1180
910      IF (LRPAR.EQ.0.OR.LRPAR.EQ.LENGTH) GO TO 920
            WRITE (LP,1630) NUMFLD,NFLD
            CALL SUERRS (LP,2,NUMERR)
            NXTFLD=1
            GO TO 1180
920   IF (LLPAR.EQ.0) IBEG=1
      IF (LLPAR.GT.0) IBEG=LLPAR+1
      IF (LASK.GT.0) IBEG=LASK+1
      IEND=LENGTH
      IF (LRPAR.EQ.0) GO TO 930
         IEND=LRPAR-1
         NOPFLD=0
         NXTFLD=0
930   CALL UFRLFX (TTMCOR,ISTRT,IBEG,IEND,0,IERR)
      IF (IERR.NE.0) THEN
         WRITE (LP,1840) NFLD
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  CHECK FOR MAXIMUM NUMBER OF VALUES
940   NUMCF=NUMCF+1
      IF (NUMCF.GT.2) THEN
         WRITE (LP,1710) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
C
C  CHECK IF GREATER THAN ZERO
      IF (TTMCOR.GT.-99.AND.TTMCOR.LT.999) GO TO 960
         WRITE (LP,1790) NUMCF,TTMCOR
         CALL SUERRS (LP,2,NUMERR)
         NXTFLD=1
         GO TO 1180
C
C  SET CORRECTION FACTOR
960   TEMPCF(NUMCF)=TTMCOR
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1950) NUMCF,TEMPCF(NUMCF)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK FOR REPEATED VALUES
      IF (NREP.GT.1) THEN
         NREP=NREP-1
         GO TO 940
         ENDIF
C
      NXTFLD=1
      IF (LRPAR.EQ.0) GO TO 1180
         NOPFLD=0
         NXTFLD=0
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  INDICATOR WHETHER FCST MXMN DATA AVAILABLE
C
C  CHECK IF NULL FIELD
990   IF (INULL.EQ.1) THEN
         CHAR='NFMM'
         IF (PRNOTE.EQ.'YES') THEN
            WRITE (LP,1620) NUMFLD,NPCFLD,CHAR(1:LENSTR(CHAR))
            CALL SULINE (LP,2)
            ENDIF
         GO TO 1010
         ENDIF
C
C  CHECK IF CHARACTER DATA
      IF (ITYPE.NE.2) THEN
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
C
C  CHECK FOR VALID VALUE
1010  IF (CHAR.EQ.'FMM'.OR.
     *    CHAR.EQ.'NFMM') GO TO 1020
         WRITE (LP,1690) CHAR(1:LENSTR(CHAR)),NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK IF FMM TO BE USED
1020  ITFMM=0
      IF (CHAR.EQ.'FMM') ITFMM=1
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1940) ITFMM,CHAR(1:LENSTR(CHAR))
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK IF STATION HAS FMM DATA AVAILABLE
      IF (ITFMM.EQ.0) GO TO 1180
C
C  CHECK IF SYNTHETIC STATION
      IF (ITYOBS.NE.4) GO TO 1180
         WRITE (LP,1700)
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  ELEVATION WEIGHTING FACTOR
C
C  CHECK WHICH FIELD TO BE PROCESSED
1030  NGOTO=NXTFLD+1
      GO TO (1040,1100),NGOTO
C
C  CHECK IF OPTIONAL FIELD PREVIOUSLY PROCESSED
1040  IF (IOFLD5.EQ.0) GO TO 1050
         WRITE (LP,1880)
         CALL SUWRNS (LP,2,NUMWRN)
         NUMFE=0
C
1050  IOFLD5=1
      CALL SUPFND (ILPFND,IRPFND,NUMFLD,0)
C
C  CHECK FOR NULL FIELD
      IF (INULL.EQ.0) GO TO 1060
         WRITE (LP,1600) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR CHARACTER DATA
1060  IF (ITYPE.EQ.2) GO TO 1070
         WRITE (LP,1630) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
C
C  CHECK FOR PARENTHESES IN FIELD
1070  IF (CHAR.NE.')') GO TO 1080
         NOPFLD=0
         NXTFLD=0
         WRITE (LP,1760) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
1080  IF (LLPAR.EQ.0) CHK=CHAR
      IF (LLPAR.GT.0) CALL SUBSTR (CHAR,1,LLPAR-1,CHK,1)
      IF (CHK.NE.'FE') THEN
         WRITE (LP,1770) CHK(1:LENSTR(CHK)),NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
      NOPFLD=4
      NXTFLD=1
      IF (LLPAR.EQ.0.OR.LLPAR.EQ.LENGTH) GO TO 1180
C
C  CHECK FOR SPECIAL CHARACTERS
1100  IF (CHAR.EQ.'('.AND.LENGTH.EQ.1) GO TO 1180
      IF (ITYPE.NE.2) GO TO 1120
         IF (LRPAR.NE.1) GO TO 1110
         IF (NUMCF.GT.0) GO TO 1180
            WRITE (LP,1780)
            CALL SUERRS (LP,2,NUMERR)
            NOPFLD=0
            NXTFLD=0
            GO TO 1180
1110     IF (LRPAR.EQ.0.OR.LRPAR.EQ.LENGTH) GO TO 1120
            WRITE (LP,1630) NUMFLD,NFLD
            CALL SUERRS (LP,2,NUMERR)
            NXTFLD=1
            GO TO 1180
1120  IF (LLPAR.EQ.0) IBEG=1
      IF (LLPAR.GT.0) IBEG=LLPAR+1
      IF (LASK.GT.0) IBEG=LASK+1
      IEND=LENGTH
      IF (LRPAR.EQ.0) GO TO 1130
         IEND=LRPAR-1
         NOPFLD=0
         NXTFLD=0
1130  CALL UFRLFX (TFE,ISTRT,IBEG,IEND,0,IERR)
      IF (IERR.NE.0) THEN
         WRITE (LP,1840) NFLD
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  CHECK FOR MAXIMUM NUMBER OF VALUES
1140  NUMFE=NUMFE+1
      IF (NUMFE.GT.1) THEN
         WRITE (LP,1890) NUMFLD,NFLD
         CALL SUERRS (LP,2,NUMERR)
         GO TO 1180
         ENDIF
C
C  CHECK IF GREATER THAN ZERO
      IF (TFE.GE.0.0) GO TO 1160
         WRITE (LP,1900) TFE
         CALL SUERRS (LP,2,NUMERR)
         NXTFLD=1
         GO TO 1180
C
C  SET ELEVATION WEIGHTING FACTOR
1160  TEMPFE=TFE
      IMTN=1
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,1960) TEMPFE,IMTN
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  CHECK FOR REPEATED VALUES
      IF (NREP.GT.1) THEN
         NREP=NREP-1
         GO TO 1140
         ENDIF
C
      NXTFLD=1
      IF (LRPAR.EQ.0) GO TO 1180
         NOPFLD=0
         NXTFLD=0
         GO TO 1180
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK FOR REPEATED NULL FIELDS
C
1180  IF (NULREP.EQ.0) GO TO 1190
         NULREP=NULREP-1
         IF (NULREP.NE.0) GO TO 350
            INWIND=0
C
1190  NPIFLD=NUMFLD
      NPCFLD=NFLD
C
C  CHECK FOR END OF INPUT
      IF (INWIND.EQ.1) GO TO 120
      IF (IENDIN.EQ.1) GO TO 1200
         GO TO 120
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK NUMBER OF FIELDS PROCESSED
1200  IF (NUMFLD.EQ.1) THEN
         WRITE (LP,2090)
         CALL SUWRNS (LP,2,NUMWRN)
         GO TO 1310
         ENDIF
C
C  CHECK NUMBER OF MEAN MONTHLY MAX AND MIN TEMPS PROCESSED
      IF (NUMMAX.NE.MAXTMP) THEN
         WRITE (LP,1720) 'MAX',NUMMAX,MAXTMP
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
      IF (NUMMIN.NE.MAXTMP) THEN
         WRITE (LP,1720) 'MIN',NUMMIN,MAXTMP
         CALL SUERRS (LP,2,NUMERR)
         ENDIF
C
C  CHECK IF MAX TEMPS GREATER THAN MIN TEMPS
      DO 1210 I=1,MAXTMP
         IF (TMPMAX(I).GE.TMPMIN(I)) GO TO 1210
            WRITE (LP,1730) TMPMAX(I),I,TMPMIN(I)
            CALL SUERRS (LP,2,NUMERR)
1210     CONTINUE
C
C  CHECK NUMBER OF CORRECTION FACTORS PROCESSED
      IF (NUMCF.EQ.0.OR.NUMCF.EQ.2) GO TO 1220
         WRITE (LP,1740) NUMCF
         CALL SUERRS (LP,2,NUMERR)
C
C  CHECK IF ERRORS ENCOUNTERED
1220  IF (NUMERR.GT.0) GO TO 1280
C
      IF (TDISP.EQ.'NEW') IPMMMT=0
C
C  CHECK IF UNITS NEED TO BE CONVERTED
      IF (UNITS.EQ.'METR') THEN
         ICONV=1
         CALL UDUCNV ('DEGC','DEGF',ICONV,NUMCF,TEMPCF,TEMPCF,IERR)
         IF (IERR.NE.0) THEN
            WRITE (LP,1980) 'CORRECTION FACTORS',IERR
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
         CALL UDUCNV ('DEGC','DEGF',ICONV,MAXTMP,TMPMAX,TMPMAX,IERR)
         IF (IERR.NE.0) THEN
            WRITE (LP,1980) 'MAX TEMPERATURES',IERR
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
         CALL UDUCNV ('DEGC','DEGF',ICONV,MAXTMP,TMPMIN,TMPMIN,IERR)
         IF (IERR.NE.0) THEN
            WRITE (LP,1980) 'MIN TEMPERATURES',IERR
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
         ENDIF
      IF (UNITS.EQ.'ENGL') THEN
C     GET CONVERSION FACTORS
         ICONV=2
         NVAL=1
         CALL UDUCNV ('MI  ','KM  ',ICONV,NVAL,CONV1,TCONV,IERR)
         CALL UDUCNV ('FT  ','M   ',ICONV,NVAL,CONV2,TCONV,IERR)
C     CONVERT VALUE
         IF (LDEBUG.GT.0) THEN
            WRITE (IOSDBG,*)
     *         ' CONV1=',CONV1,
     *         ' CONV2=',CONV2,
     *         ' CONV1/CONV2=',CONV1/CONV2,
     *         ' '
            CALL SULINE (IOSDBG,1)
            ENDIF
         TEMPFE=TEMPFE*(CONV1/CONV2)
         ENDIF
C
C  CHECK MAGNITUDE OF VALUES
      XMIN=-40.0
      XMAX=120.0
      DO 1250 I=1,MAXTMP
         IF (TMPMAX(I).LT.XMIN) THEN
            WRITE (LP,1990) 'MAX',I,TMPMAX(I),'LESS',XMIN,'DEGF'
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
        IF (TMPMAX(I).GT.XMAX) THEN
            WRITE (LP,1990) 'MAX',I,TMPMAX(I),'GREATER',XMAX,'DEGF'
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
1250     CONTINUE
      DO 1270 I=1,MAXTMP
         IF (TMPMIN(I).LT.XMIN) THEN
            WRITE (LP,1990) 'MIN',I,TMPMIN(I),'LESS',XMIN,'DEGF'
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
         IF (TMPMIN(I).GT.XMAX) THEN
            WRITE (LP,1990) 'MIN',I,TMPMIN(I),'GREATER',XMAX,'DEGF'
            CALL SUERRS (LP,2,NUMERR)
            ENDIF
1270     CONTINUE
C
      IF (IRUNCK.EQ.1) GO TO 1280
      IF (IFSTAN.GT.1) GO TO 1280
      IF (NUMERR.GT.0) GO TO 1280
      IPMMMTN=-1
      IF (IWRITE.EQ.0) GO TO 1280
C
C  WRITE MEAN MONTHLY MXMN TEMPERATURES
      CALL WPP1MT (TMPMAX,TMPMIN,IPMMMT,IERR)
      IF (IERR.EQ.0) THEN
         WRITE (LP,2005) STAID
         CALL SULINE (LP,2)
         IPMMMTN=IPMMMT
         ELSE
            IF (IERR.EQ.1) THEN
               WRITE (LP,2010)
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.EQ.2) THEN
               WRITE (LP,2020)
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.EQ.3) THEN
               WRITE (LP,2025)
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
            IF (IERR.GT.3) THEN
               WRITE (LP,2030) IERR
               CALL SUERRS (LP,2,NUMERR)
               ENDIF
         ENDIF
C
C  CHECK IF RUNCHECK OPTION SET
1280  IF (IRUNCK.EQ.1) THEN
         WRITE (LP,2080) STAID
         CALL SULINE (LP,2)
         GO TO 1310
         ENDIF
C
C  CHECK IF ERRORS ENCOUNTERED
      IF (NUMERR.GT.0) THEN
         IF (IRUNCK.EQ.0) THEN
            WRITE (LP,2040) STAID,NUMERR
            CALL SULINE (LP,2)
            IRUNCK=1
            ELSE
               WRITE (LP,2050) STAID,NUMERR
               CALL SULINE (LP,2)
            ENDIF
         ISTAT=1
         GO TO 1310
         ENDIF
C
C  CHECK IF STATION GENERAL PARAMETERS DEFINED
      IF (IFSTAN.EQ.0.OR.IFSTAN.EQ.1) GO TO 1290
         IF (DISP.EQ.'NEW') THEN
            WRITE (LP,2060) STAID
            CALL SUWRNS (LP,2,NUMWRN)
            ENDIF
         IF (DISP.EQ.'OLD') THEN
            WRITE (LP,2070) STAID
            CALL SUWRNS (LP,2,NUMWRN)
            ENDIF
         ISTAT=1
         GO TO 1310
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  WRITE PARAMETERS
C
1290  IVTEMP=1
C
C  SET REPORTING TIME INTERVAL
      IF (ITTAVR.EQ.0.AND.(ITYOBS.EQ.2.OR.ITYOBS.EQ.3)) ITTAVR=IDTIME
C
C  SET INDICATOR WHETHER NETWORK HAS BEEN RUN
      IF (TDISP.EQ.'NEW') ITNTWK=0
      IF (TDISP.EQ.'OLD') THEN
         IF (ITNTWK.EQ.2) THEN
            IF (ILTLNN.EQ.1) ITNTWK=1
            IF (IELEVN.EQ.1) ITNTWK=1
            ENDIF
         ENDIF
C  
C  WRITE PARAMETERS       
      WDISP=TDISP
      INCLUDE 'scommon/callswtemp'
      IF (IERR.NE.0) THEN
         ISTAT=1
         GO TO 1310
         ENDIF
C
      IF (IWRITE.EQ.0.OR.PRPARM.EQ.'NO') GO TO 1310
C
C  READ TEMP PARAMETERS
      IPTR=0
      IPRERR=1
      IREAD=1
      INCLUDE 'scommon/callsrtemp'
      IF (IERR.GT.0) GO TO 1310
C
C  PRINT TEMP PARAMETERS
      IPRNT=1
      INCLUDE 'scommon/callsptemp'
C
1310  NSTERR=NSTERR+NUMERR
      NSTWRN=NSTWRN+NUMWRN
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,2100)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
1320  FORMAT (' *** ENTER SFTEMP')
1330  FORMAT (' ')
1340  FORMAT ('0*--> DEFINE STATION TEMP PARAMETERS')
1350  FORMAT ('0DEFINE OPTIONS IN EFFECT :  ',
     *   'DISP=',A,3X,
     *   'PRPARM=',A,3X,
     *   'PRNOTE=',A,3X,
     *   'UNITS=',A)
1360  FORMAT (' NUMFLD=',I2,3X,'MINFLD=',I2,3X,'MAXFLD=',I2,3X,
     *   'NUMERR=',I2,3X,'NOPFLD=',I2,3X,'NXTFLD=',I2,3X,'CHK=',A)
1370  FORMAT ('0*** NOTE - DISPOSITION OF NEW WAS SPECIFIED ',
     *   'FOR STATION ',A,' BUT TEMP PARAMETERS ALREADY EXIST.')
1380  FORMAT ('0*** WARNING - TEMP PARAMETERS FOR STATION ',A,
     *   ' DO NOT EXIST. DISP ASSUMED TO BE NEW FOR THIS DATA GROUP.')
1390  FORMAT ('0*** ERROR - STATION IDENTIFIER NOT SPECIFIED. ',
     *   'CHECK FOR MISSING OR INCOMPLETE ''STAN'' INPUT.')
1400  FORMAT ('0*** ERROR - PREPROCESSOR PARAMETRIC DATA BASE FILES ',
     *   'ARE NOT ALLOCATED. INPUT DATA WILL BE CHECKED FOR ERRORS.')
1410  FORMAT ('0MEAN TEMPERATURES:',7X,'JAN    FEB    MAR    APR    ',
     *   'MAY    JUN    JUL    AUG    SEP    OCT    NOV    DEC')
1420  FORMAT (/ 20X,A,2X,12(F5.1,2X),A)
1430  FORMAT ('0*** ERROR - IN SFTEMP - SYSTEM ERROR ACCESSING ',
     *   'MEAN TEMPERATURES FILE.')
1440  FORMAT ('0*** ERROR - IN SFTEMP - INVALID VALUE OF POINTER TO ',
     *   'MEAN TEMPERATURES. IPMMMT=',I5)
1460  FORMAT ('0*** ERROR - IN SFTEMP - STATUS CODE FROM RPP1MT ',
     *   'NOT RECOGNIZED: ',I4)
1470  FORMAT ('0*** ERROR - INVALID DEFINE TEMP STATION OPTION ',
     *   'IN INPUT FIELD ',I2,' (CARD FIELD ',I2,') : ',A)
1480  FORMAT ('0*** ERROR - PROCESSING OPTION : ',A)
1490  FORMAT ('0*** ERROR - IN SFTEMP - THE CHARACTERS ''',A,
     *   ''' WERE EXPECTED IN FIELD ',I2,' BUT ''',A,''' WERE FOUND.')
1500  FORMAT ('0*** ERROR - FIELD ',I2,' EXCEEDS MAXIMUM ALLOWABLE ',
     *   'FIELDS (',I2,').')
1520  FORMAT ('0*** ERROR - ',I3,' IS AN INVALID NUMBER OF NULL ',
     *   'TO BE REPEATED. CURRENT FIELD IS ',I2,'. MAXIMUM REQUIRED ',
     *   'FIELDS ALLOWED IS ',I2,'.')
1540  FORMAT ('0*** NOTE - UNITS CODE (',A,') FOUND IN CARD FIELD ',
     *   I2,' NOT USED FOR DEFINING TEMP PARAMETERS.')
1550  FORMAT (' BLANK STRING FOUND IN FIELD ',I2)
1560  FORMAT ('0*** NOTE - RIGHT PARENTHESES ASSUMED IN INPUT FIELD ',
     *   I2,' (CARD FIELD ' ,I2,').')
1580  FORMAT ('0*** NOTE - REMAINING STATION TEMP PARAMETERS WILL ',
     *   'BE SET TO DEFAULT VALUES.')
1590  FORMAT ('0*** ERROR - NO VALUE FOUND FOR REQUIRED INPUT FIELD ',
     *   I2,' (CARD FIELD ',I2,').')
1600  FORMAT ('0*** ERROR - NO VALUE FOUND FOR OPTIONAL INPUT FIELD ',
     *   I2,' (CARD FIELD ',I2,').')
1610  FORMAT ('0*** NOTE - NO VALUE FOUND FOR REQUIRED INPUT FIELD ',
     *   I2,' (CARD FIELD ',I2,'). DEFAULT VALUE (',I4,
     *   ') WILL BE USED.')
1620  FORMAT ('0*** NOTE - NO VALUE FOUND FOR REQUIRED INPUT FIELD ',
     *   I2,' (CARD FIELD ',I2,'). DEFAULT VALUE (',A,
     *   ') WILL BE USED.')
1630  FORMAT ('0*** ERROR - NON-CHARACTER DATA EXPECTED IN INPUT ',
     *   'FIELD ',I2,' (CARD FIELD ',I2,').')
1640  FORMAT ('0*** ERROR - INTEGER DATA EXPECTED IN INPUT ',
     *   'FIELD ',I2,' (CARD FIELD ',I2,').')
1650  FORMAT ('0*** ERROR - PROCESSING DEFINE STATION TEMP OPTION ',
     *   'NUMBER ',I2,'.')
1660  FORMAT ('0*** ERROR - REPORTING TIME INTERVAL (',I2,
     *   ') IS INVALID. VALID VALUES ARE 1, 3, OR 6.')
1670  FORMAT ('0*** ERROR - REPORTING TIME INTERVAL CAN ONLY BE ',
     *   'SPECIFIED FOR TEMP STATIONS WITH MXMN DATA.')
1680  FORMAT ('0*** ERROR - INVALID TYPE OF DATA OBSERVED IN ',
     *   'INPUT FIELD ',I2,' (CARD FIELD ',I2,') : ',A)
1690  FORMAT ('0*** ERROR - INVALID FCST TEMPERATURE AVAILABLE ',
     *   'OPTION (',A,') IN INPUT FIELD ',I2,' (CARD FIELD ',I2,').')
1700  FORMAT ('0*** ERROR - SYNTHETIC TEMP STATION CANNOT HAVE ',
     *   'FORECAST MAX/MIN DATA AVAILABLE.')
1710  FORMAT ('0*** ERROR - MAXIMUM NUMBER OF CORRECTION FACTORS ',
     *   '(2) EXCEEDED IN INPUT FIELD ',I2,'+ (CARD FIELD ',I2,').')
1720  FORMAT ('0*** ERROR - NUMBER OF MEAN MONTHLY ',A,
     *   'TEMPERATURES (',I2,') DOES NOT EQUAL ',I2,'.')
1730  FORMAT ('0*** ERROR - MAX MONTHLY MEAN TEMP (',F5.2,') FOR ',
     *   'MONTH ',I2,' IS NOT GREATER THAN OR EQUAL TO MIN MONTHLY ',
     *   'MEAN TEMP (',F5.2,').')
1740  FORMAT ('0*** ERROR - NUMBER OF CORRECTION FACTORS ',
     *   '(',I2,') DOES NOT EQUAL 2.')
1750  FORMAT ('0*** WARNING - TEMPERATURE CORRECTION FACTORS HAVE ',
     *   'ALREADY BEEN DEFINED.')
1760  FORMAT ('0*** ERROR - NO TEMPERATURE CORRECTION FACTORS ',
     *   'FOUND IN INPUT FIELD ',I2,' (CARD FIELD ',I2,').')
1770  FORMAT ('0*** ERROR - PROCESSING TEMPERATURE CORRECTION ',
     *   'FACTOR INDICATOR (',A,') IN INPUT FIELD ',I2,' (CARD FIELD ',
     *   I2,').')
1780  FORMAT ('0*** ERROR - NO TEMPERATURE CORRECTION FACTORS FOUND.')
1790  FORMAT ('0*** ERROR - TEMP CORRECTION FACTOR ',I2,' MUST BE ',
     *   'GREATER THAN -99 AND LESS THAN 999. VALUE INPUT IS ',F9.2,'.')
1800  FORMAT ('0*** WARNING - MEAN MONTHLY MAX TEMPERATURES HAVE ',
     *   'ALREADY BEEN DEFINED.')
1810  FORMAT ('0*** ERROR - NO MEAN MONTHLY ',A,' TEMPERATURES ',
     *   'FOUND IN INPUT FIELD ',I2,' (CARD FIELD ',I2,').')
1820  FORMAT ('0*** WARNING - MEAN MONTHLY MIN TEMPERATURES HAVE ',
     *   'ALREADY BEEN DEFINED.')
1830  FORMAT ('0*** ERROR - PROCESSING MEAN MONTHLY ',A,' TEMP ',
     *   'INDICATOR (',A,') IN INPUT FIELD ',I2,' (CARD FIELD ',
     *   I2,').')
1840  FORMAT ('0*** ERROR - INVALID CHARACTER FOUND IN ',
     *   'CARD FIELD ',I2,'.')
1850  FORMAT ('0*** ERROR - MAXIMUM NUMBER OF MEAN MONTHLY ',A,' ',
     *   'TEMPERATURES (',I2,') EXCEEDED IN INPUT FIELD ',I2,
     *   ' (CARD FIELD ',I2,').')
1860  FORMAT ('0*** ERROR - NO MEAN MONTHLY ',A,' TEMPERATURES FOUND.')
1870  FORMAT ('0*** ERROR - MEAN MONTHLY ',A,' TEMP ',I2,' MUST BE ',
     *   'GREATER THAN -99 AND LESS THAN 999. VALUE INPUT IS ',F9.2,'.')
1880  FORMAT ('0*** WARNING - ELEVATION WEIGHTING FACTOR HAS ',
     *   'ALREADY BEEN DEFINED.')
1890  FORMAT ('0*** ERROR - MAXIMUM NUMBER OF ELEVATION WEIGHTING  ',
     *   'FACTORS (1) EXCEEDED IN INPUT FIELD ',I2,'+ (CARD FIELD ',
     *   I2,').')
1900  FORMAT ('0*** ERROR - ELEVATION WEIGHTING FACTOR MUST BE ',
     *   'GREATER THAN OR EQUAL TO 0. VALUE INPUT IS ',F9.2,'.')
1920  FORMAT (' REPORTING TIME INTERVAL SET TO : ',I2)
1930  FORMAT (' TYPE OF DATA OBSERVED SET TO : ',I2,2X,'(',A,')')
1940  FORMAT (' FCST MXMN INDICATOR SET TO : ',I6,2X,'(',A,')')
1950  FORMAT (' CORRECTION FACTOR ',I1,' SET TO : ',F9.2)
1960  FORMAT (' ELEVATION WEIGHTING FACTOR (FE) SET TO : ',F9.2,
     *   ' AND MOUNTAINOUS INDICATOR (IMTN) SET TO : ',I2)
1970  FORMAT (' MEAN ',A,' TEMP ',I2,' SET TO : ',F9.2)
1980  FORMAT ('0*** ERROR - CONVERTING ',A,
     *   '. UDUCNV STATUS CODE=',I2,'.')
1990  FORMAT ('0*** ERROR - MEAN MONTHLY ',A,' TEMPERATURE NUMBER ',I2,
     *   ' (',F6.2,') IS ',A,' THAN ',F6.2,' ',A,'.')
2005  FORMAT ('0*** NOTE - TEMP MMMT VALUES SUCCESSFULLY WRITTEN ',
     *   'FOR STATION ',A,'.')
2010  FORMAT ('0*** ERROR - SYSTEM ERROR WRITING MEAN TEMPERATURES TO ',
     *   'THE PPPDB.')
2020  FORMAT ('0*** ERROR - MEAN MONTHLY MAX/MIN TEMPERATURE FILE IS ',
     *   'FULL.')
2025  FORMAT ('0*** ERROR - MEAN MONTHLY MAX/MIN TEMPERATURES NOT ',
     *   'DEFINED IN PREPROCESSOR PARAMETRIC DATA BASE.')
2030  FORMAT ('0*** ERROR - IN SFTEMP - STATUS CODE RETURNED FROM ',
     *   'WPP1MT (',I2,') NOT RECOGNIZED.')
2040  FORMAT ('0*** NOTE - TEMP PARAMETERS FOR STATION ',A,
     *   ' NOT WRITTEN BECAUSE ',I2,' ERRORS ENCOUNTERED. ',
     *   'RUNCHECK OPTION SET FOR THIS STATION.')
2050  FORMAT ('0*** NOTE - TEMP PARAMETERS FOR STATION ',A,
     *   ' NOT WRITTEN BECAUSE ',I2,' ERRORS ENCOUNTERED.')
2060  FORMAT ('0*** WARNING - TEMP PARAMETERS FOR STATION ',A,
     *   ' NOT WRITTEN BECAUSE STAN PARAMETERS NOT SUCCESSFULLY ',
     *   'DEFINED.')
2070  FORMAT ('0*** WARNING - TEMP PARAMETERS FOR STATION ',A,
     *   ' NOT WRITTEN BECAUSE STAN PARAMETERS NOT SUCCESSFULLY ',
     *   'REDEFINED.')
2080  FORMAT ('0*** NOTE - TEMP PARAMETERS FOR STATION ',A,
     *   ' NOT WRITTEN BECAUSE RUNCHECK OPTION IS SET.')
2090  FORMAT ('0*** WARNING - NO TEMP PARAMETER VALUES FOUND.')
2100  FORMAT (' *** EXIT SFTEMP')
C
      END
