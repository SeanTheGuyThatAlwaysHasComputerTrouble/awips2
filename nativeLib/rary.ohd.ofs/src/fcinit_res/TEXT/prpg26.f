C MEMBER PRPG26
C  (from old member FCPRPG26)
C
      SUBROUTINE PRPG26(PO,LP,LT)
C
C***********************************************************************
C
C     POWER GENERATION COMPUTATIONAL SCHEME
C
      DIMENSION PO(*),X(365),Y(365),IDAY(365),ANAME(5)
C
      COMMON/IONUM/IN,IPR,IPU
      COMMON/CNVP26/CONV1,CONV2,CONV3,CONV4,CONV5,UNT1,UNT2,UNT3,UNT4,
     .      UNT5
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_res/RCS/prpg26.f,v $
     . $',                                                             '
     .$Id: prpg26.f,v 1.4 1999/04/22 15:09:43 page Exp $
     . $' /
C    ===================================================================
C
C
      MINODT=PO(7)
      NTOD=PO(LP)
      LO=LP
      IF(NTOD.GE.0) WRITE(IPR,6062)NTOD
 6062 FORMAT(1H0,20X,50HTIME TO BRING POOL TO RULE CURVE
     1 =,I8,6H HOURS)
      NDA=24/MINODT
      DO 9000 J=1,NDA
 9000 X(J)=PO(LO+J)
      WRITE(IPR,6064)
 6064 FORMAT(1H0,20X,27HDAILY DISTRIBUTION FUNCTION)
      WRITE(IPR,6066) (X(J),J=1,NDA)
 6066 FORMAT(1H0,25X,20F5.2)
      LO=LO+NDA+1
      NDOW=PO(LO)
      IF(NDOW.LT.0)GO TO 9002
      WRITE(IPR,6068)NDOW
 6068 FORMAT(1H0,20X,50HDAY OF WEEK TO RETURN POOL TO RULE CURVE
     1 =,I8)
      WRITE(IPR,6069)
 6069 FORMAT(1H0,20X,26HWEEKLY DISTRIBUTION FACTOR)
      WRITE(IPR,6070) (PO(LO+J),J=1,7)
 6070 FORMAT(1H0,25X,7F5.2)
      LO=LO+7
C
 9002 LO=LO+1
      DMIN=PO(LO)
      IF(DMIN.LT.0.)GO TO 9004
      DMIN=DMIN*CONV2
      WRITE(IPR,6072)DMIN,UNT2
 6072 FORMAT(1H0,20X,50HDAILY MINIMUM FLOW
     1 =,F11.2,1X,A4)
 9004 LO=LO+1
      WMIN=PO(LO)
      IF(WMIN.LT.0.)GO TO 9006
      WMIN=WMIN*CONV2
      WRITE(IPR,6074)WMIN,UNT2
 6074 FORMAT(1H0,20X,50HWEEKLY MINIMUM FLOW
     1 =,F11.2,1X,A4)
 9006 LO=LO+1
      NVAL=PO(LO)
      IF(NVAL.EQ.0)GO TO 9014
      IF(NVAL.EQ.1)GO TO 9012
      DO 9008 J=1,NVAL
 9008 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 9010 J=1,NVAL
 9010 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL
      WRITE(IPR,6076)
 6076 FORMAT(1H0,20X,32HMINIMUM INSTANTANEOUS FLOW CURVE)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 9011 WRITE(IPR,6078) (IDAY(J),J=JB,JE)
 6078 FORMAT(1H0,25X,10HJULIAN DAY,8I11)
      WRITE(IPR,6080)UNT2,(Y(J),J=JB,JE)
 6080 FORMAT(1H0,25X,6HDISCH(,A4,1H),8F11.2)
      IF(JE.GE.NVAL)GO TO 9014
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 9011
C
 9012 QMIN=PO(LO+1)*CONV2
      LO=LO+1
      WRITE(IPR,6082)QMIN,UNT2
 6082 FORMAT(1H0,20X,50HMIMNIMUM INSTANTANEOUS FLOW
     1 =,F11.2,1X,A4)
C
 9014 LO=LO+1
      IHUPP=PO(LO)
      IF(IHUPP.GT.1)GO TO 9022
      VAL=PO(LO+1)
      LO=LO+1
      IF(VAL.LT.0.)GO TO 9016
      VAL=VAL*CONV1
      WRITE(IPR,6084)VAL,UNT1
 6084 FORMAT(1H0,20X,50HLIMITING UPPER ELEVATION
     1 =,F11.2,1X,A4)
      GO TO 9027
 9016 IF(VAL.GT.-998.99)GO TO 9018
      WRITE(IPR,6086)
 6086 FORMAT(1H0,20X,50HLIMITING UPPER ELEVATION
     1 =,5X,4HRULE)
      GO TO 9027
 9018 VAL=(VAL+999.)*CONV1
      WRITE(IPR,6088)VAL
 6088 FORMAT(1H0,20X,50HLIMITING UPPER ELEVATION
     1 =,7H RULE +,F4.1)
      GO TO 9027
 9022 WRITE(IPR,6089)
 6089 FORMAT(1H0,20X,30HLIMITING UPPER ELEVATION CURVE)
      DO 9024 J=1,IHUPP
 9024 IDAY(J)=PO(LO+J)
      LO=LO+IHUPP
      DO 9026 J=1,IHUPP
 9026 Y(J)=PO(LO+J)*CONV1
      LO=LO+IHUPP
      JB=1
      JE=IHUPP
      IF(JE.GT.8)JE=8
 9025 WRITE(IPR,6090)(IDAY(J),J=JB,JE)
 6090 FORMAT(1H0,25X,10HJULIAN DAY,8I11)
      WRITE(IPR,6092)UNT1,(Y(J),J=JB,JE)
 6092 FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
      IF(JE.GE.IHUPP)GO TO 9027
      JB=JE+1
      JE=JE+8
      IF(JE.GT.IHUPP)JE=IHUPP
      GO TO 9025
C
 9027 LO=LO+1
      IHLOW=PO(LO)
      IF(IHLOW.GT.1)GO TO 9032
      VAL=PO(LO+1)
      LO=LO+1
      IF(VAL.LE.0.)GO TO 9028
      VAL=VAL*CONV1
      WRITE(IPR,6094)VAL,UNT1
 6094 FORMAT(1H0,20X,50HLIMITING LOWER ELEVATION
     1 =,F11.2,1X,A4)
      GO TO 9036
 9028 IF(VAL.LT.-999.)GO TO 9030
      WRITE(IPR,6096)
 6096 FORMAT(1H0,20X,50HLIMITING LOWER ELEVATION
     1 =,5X,4HRULE)
      GO TO 9036
 9030 VAL=(VAL+999.)*CONV1
      WRITE(IPR,6097)VAL
 6097 FORMAT(1H0,20X,50HLIMITING LOWER ELEVATION
     1 =,6H RULE ,F5.1)
      GO TO 9036
C
 9032 WRITE(IPR,7000)
 7000 FORMAT(1H0,20X,30HLIMITING LOWER ELEVATION CURVE)
      DO 9034 J=1,IHLOW
 9034 IDAY(J)=PO(LO+J)
      LO=LO+IHLOW
      DO 9033 J=1,IHLOW
 9033 Y(J)=PO(LO+J)*CONV1
      LO=LO+IHLOW
      JB=1
      JE=IHLOW
      IF(JE.GT.8)JE=8
 9035 WRITE(IPR,6090)(IDAY(J),J=JB,JE)
      WRITE(IPR,6092)UNT1,(Y(J),J=JB,JE)
      IF(JE.GE.IHLOW)GO TO 9036
      JB=JE+1
      JE=JE+8
      IF(JE.GT.IHLOW)JE=IHLOW
      GO TO 9035
C
 9036 LO=LO+1
      DSM=PO(LO)
      IF(DSM.LT.0.)GO TO 9038
      DSM=DSM*CONV2
      WRITE(IPR,7002)DSM,UNT2
 7002 FORMAT(1H0,20X,50HDOWNSTREAM DAM LIMITING DISCHARGE
     1 =,F11.2,1X,A4)
 9038 QGEN=PO(LO+1)*CONV2
      LO=LO+2
      WRITE(IPR,7004)QGEN,UNT2
 7004 FORMAT(1H0,20X,50HMAXIMUM CONSTANT DISCHARGE
     1 =,F11.2,1X,A4)
      IWHICH=PO(LO)
      IF(IWHICH.EQ.0)GO TO 9054
      IF(IWHICH.GT.0)GO TO 9044
      NEL=PO(LO+1)
      LO=LO+1
      DO 9040 J=1,NEL
 9040 X(J)=PO(LO+J)*CONV1
      LO=LO+NEL
      DO 9042 J=1,NEL
 9042 Y(J)=PO(LO+J)*CONV2
      LO=LO+NEL
      WRITE(IPR,7006)
 7006 FORMAT(1H0,20X,36HELEVATION VS MAXIMUM DISCHARGE CURVE)
      JB=1
      JE=NEL
      IF(JE.GT.8)JE=8
 9043 WRITE(IPR,7008)UNT1,(X(J),J=JB,JE)
 7008 FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
      WRITE(IPR,7010)UNT2,(Y(J),J=JB,JE)
 7010 FORMAT(1H0,25X,6HDISCH(,A4,1H),8F11.2)
      IF(JE.GE.NEL)GO TO 9054
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NEL)JE=NEL
      GO TO 9043
C
 9044 LO=LO+1
      MOVE=0
      NVAL=PO(LO)
      NLOC=LO
      IF(NVAL.GT.0)GO TO 9046
      LO=-1*NVAL+PO(10)-1
      MOVE=1
      NVAL=PO(LO)
 9046 DO 9048 J=1,NVAL
 9048 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 9050 J=1,NVAL
 9050 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      WRITE(IPR,874)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 9051 WRITE(IPR,876)UNT1,(X(J),J=JB,JE)
      WRITE(IPR,877)UNT2,(Y(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 9052
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 9051
 9052 ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONV=PO(LO+2)
      WRITE(IPR,872)ANAME(1),ANAME(2)
      WRITE(IPR,878)CONV
 878  FORMAT(1H0,20X,50HCONVERGENCE CRITERION
     1 =,F10.3)
C
 9054 LO=LO+1
      NR=PO(LO)
      IF(NR.GT.0)GO TO 9056
      LO=-1*NR+PO(10)-1
      NR=PO(LO)
 9056 DO 9058 J=1,NR
 9058 IDAY(J)=PO(LO+J)
      LO=LO+NR
      DO 9060 J=1,NR
 9060 Y(J)=PO(LO+J)*CONV1
      WRITE(IPR,820)
      JB=1
      JE=NR
      IF(JE.GT.8)JE=8
 9062 WRITE(IPR,825)(IDAY(J),J=JB,JE)
      WRITE(IPR,830)UNT1,(Y(J),J=JB,JE)
      IF(JE.GE.NR)GO TO 9064
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NR)JE=NR
      GO TO 9062
 9064 LO=LO+NR+1
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPR,832) ITIME
C
 500  CONTINUE
 740  FORMAT(1H0,10X,37HLINEAR INTERPOLATION IS USED IN CURVE)
 742  FORMAT(1H0,10X,42HLOGARITHMIC INTERPOLATION IS USED IN CURVE)
 795  FORMAT(1H0,20X,64HADDITIONAL TIME SERIES:         ID         TYPE
     1        TIME(HR)/)
  798 FORMAT(1H ,52X,2A4,3X,A4,11X,I2)
 820  FORMAT(1H0,20X,16HRULECURVE VALUES)
 825  FORMAT(1H0,25X,10HJULIAN DAY,8I11)
 830  FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
 832  FORMAT(1H0,20X,50HTIME OF DAY RULE CURVE IS SET
     1 -,I8)
 862  FORMAT(1H0,20X,21HSPILLWAY RATING CURVE)
 864  FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
 866  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 874  FORMAT(1H0,20X,23HHEAD VS DISCHARGE CURVE)
 876  FORMAT(1H0,25X,5HHEAD(,A4,1H),1X,8F11.2)
 877  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 872  FORMAT(1H0,20X,30HTAILWATER RATING CURVE NAME - ,2A4)
      RETURN
      END
