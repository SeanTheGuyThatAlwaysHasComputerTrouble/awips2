C MEMBER PRPF26
C  (from old member FCPRPF26)
C
      SUBROUTINE PRPF26(PO,LP,LT)
C
C***********************************************************************
C
C     FLASHBOARDS COMPUTATIONAL SCHEME
C
      DIMENSION PO(1),X(365),Y(365),IDAY(365),ANAME(5)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/CNVP26/CONV1,CONV2,CONV3,CONV4,CONV5,UNT1,UNT2,UNT3,UNT4,
     .       UNT5
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_res/RCS/prpf26.f,v $
     . $',                                                             '
     .$Id: prpf26.f,v 1.2 1999/04/22 15:09:15 page Exp $
     . $' /
C    ===================================================================
C
C
      DATA BLANK/4H    /
C
      NBL=PO(LP)
      LO=LP+1
      NBS=PO(LO)
      WRITE(IPR,6022)NBL
 6022 FORMAT(1H0,20X,50HNUMBER OF LARGE BOARDS
     1 =,I8)
      LO=LO+1
      IFIRST=0
 212  X(1)=PO(LO)*CONV1
      X(2)=PO(LO+1)*CONV1
      X(3)=PO(LO+2)*CONV1
      X(4)=PO(LO+3)*CONV1
      X(5)=PO(LO+4)*CONV1
      LO=LO+5
      WRITE(IPR,6024)X(1),UNT1
 6024 FORMAT(1H0,25X,20HCREST ELEVATION    =,F11.2,1X,A4)
      WRITE(IPR,6025)X(2),UNT1
 6025 FORMAT(1H ,25X,20HHINGE ELEVATION    =,F11.2,1X,A4)
      WRITE(IPR,6026)X(3),UNT1
 6026 FORMAT(1H ,25X,20HTOP ELEVATION      =,F11.2,1X,A4)
      WRITE(IPR,6027)X(4),UNT1
 6027 FORMAT(1H ,25X,20HFLIP ELEVATION     =,F11.2,1X,A4)
      WRITE(IPR,6028)X(5),UNT1
 6028 FORMAT(1H ,25X,20HLENGTH OF SPILLWAY =,F11.2,1X,A4)
C
 213  NRATE=PO(LO)
      DO 214 J=1,NRATE
 214  X(J)=PO(LO+J)*CONV1
      LO=LO+NRATE
      DO 216 J=1,NRATE
 216  Y(J)=PO(LO+J)*CONV2
      WRITE(IPR,6030)
 6030 FORMAT(1H0,24X,22HSPILLWAY RATING CURVE:)
      JB=1
      JE=NRATE
      IF(JE.GT.8)JE=8
 218  WRITE(IPR,6032)UNT1,(X(J),J=JB,JE)
 6032 FORMAT(1H0,25X,5HELEV(,A4,1H),8F11.2)
      WRITE(IPR,6034)UNT2,(Y(J),J=JB,JE)
 6034 FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
      IF(JE.GE.NRATE)GO TO 219
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NRATE)GO TO 219
      GO TO 218
 219  LO=LO+NRATE +1
      IF(IFIRST.EQ.2)GO TO 8075
      IF(IFIRST.EQ.1)GO TO 8070
      IF(NBS.LE.0)GO TO 8070
      WRITE(IPR,6036)NBS
 6036 FORMAT(1H0,20X,50HNUMBER OF SMALL BOARDS
     1 =,I8)
      IFIRST = 1
      GO TO 212
C
 8070 IWHICH=PO(LO)
      LO=LO+1
      IF(IWHICH.EQ.0)GO TO 8075
      X(1)=PO(LO)*CONV1
      X(2)=PO(LO+1)*CONV1
      X(3)=PO(LO+2)*CONV1
      NFP=PO(LO+3)
      LO=LO+4
      WRITE(IPR,6038)
 6038 FORMAT(1H0,20X,17HGATE INFORMATION:)
      WRITE(IPR,6040)X(1),UNT1
 6040 FORMAT(1H ,25X,20HCREST ELEVATION    =,F11.2,1X,A4)
      WRITE(IPR,6041)X(2),UNT1
 6041 FORMAT(1H ,25X,20HPOOL ELEVATION     =,F11.2,1X,A4)
      WRITE(IPR,6042)X(3),UNT1
 6042 FORMAT(1H ,25X,20HMAX GATE OPENING   =,F11.2,1X,A4)
      WRITE(IPR,6043)NFP
 6043 FORMAT(1H ,25X,23HFUTURE PERIODS TO SCAN=,I3)
      IFIRST=2
      GO TO 213
C
 8075 REPLQ=PO(LO) * CONV2
      LO=LO+1
      IF(REPLQ.LT.0. .OR. REPLQ.GT.1E06)GO TO 8077
      WRITE(IPR,6045)REPLQ,UNT2
 6045 FORMAT(1H0,20X,50HPEAK REPLACING DISCHARGE
     1 =,G14.6,1X,A4)
 8077 NHEAD=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NHEAD.GT.0)GO TO 8080
      IF(NHEAD.EQ.0)GO TO 8090
      MOVE=1
      LO=-1*NHEAD+PO(10)-1
      NHEAD=PO(LO)
 8080 DO 8082 J=1,NHEAD
 8082 X(J)=PO(LO+J)*CONV1
      LO=LO+NHEAD
      DO 8084 J=1,NHEAD
 8084 Y(J)=PO(LO+J)*CONV2
      WRITE(IPR,874)
      JB=1
      JE=NHEAD
      IF(JE.GT.8)JE=8
 8086 WRITE(IPR,876)UNT1,(X(J),J=JB,JE)
      WRITE(IPR,877)UNT2,(Y(J),J=JB,JE)
      IF(JE.GE.NHEAD)GO TO 8088
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NHEAD)JE=NHEAD
      GO TO 8086
 8088 LO=LO+NHEAD+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(MOVE.EQ.1)GO TO 8092
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      CONV=PO(LO+2)
      LO=LO+3
      WRITE(IPR,6048)ANAME(1),ANAME(2)
 6048 FORMAT(1H0,20X,50HTAILWATER CURVE NAME
     1 =,2A4)
      WRITE(IPR,6050)CONV
 6050 FORMAT(1H0,20X,50HCONVERGENCE CRITERION
     1 =,F11.2)
      GO TO 8092
 8090 LO=LO+1
      GENQ=PO(LO)*CONV2
      WRITE(IPR,6052)GENQ,UNT2
 6052 FORMAT(1H0,20X,50HCONSTANT GENERATION DISCHARGE
     1 =,F11.2,1X,A4)
      LO=LO+1
 8092 SLU=PO(LO)*CONV2
      WRITE(IPR,6054)SLU,UNT2
 6054 FORMAT(1H0,20X,50HCONSTANT NON-SPILLWAY, NON-GENERATION DISCHARGE
     1 =,F11.2,1X,A4)
C
C     PRINT TIME SERIES
      LO=LT
      NFIRST=0
      DO 8095 J=1,5
      IF(PO(LO).EQ.BLANK)GO TO 8094
      IF(NFIRST.EQ.0)WRITE(IPR,795)
      NFIRST=1
      IT=PO(LO+3)
      WRITE(IPR,798)PO(LO),PO(LO+1),PO(LO+2),IT
      LO=LO+5
      GO TO 8095
 8094 LO=LO+2
 8095 CONTINUE
C
 500  CONTINUE
 740  FORMAT(1H0,10X,37HLINEAR INTERPOLATION IS USED IN CURVE)
 742  FORMAT(1H0,10X,42HLOGARITHMIC INTERPOLATION IS USED IN CURVE)
 795  FORMAT(1H0,20X,64HADDITIONAL TIME SERIES:         ID         TYPE
     1        TIME(HR)/)
  798 FORMAT(1H ,52X,2A4,3X,A4,11X,I2)
 820  FORMAT(1H0,20X,16HRULECURVE VALUES)
 825  FORMAT(1H0,25X,10HJULIAN DAY,8I11)
 830  FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
 832  FORMAT(1H0,20X,50HTIME OF DAY RULE CURVE IS SET
     1 -,I8)
 862  FORMAT(1H0,20X,21HSPILLWAY RATING CURVE)
 864  FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
 866  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 874  FORMAT(1H0,20X,23HHEAD VS DISCHARGE CURVE)
 876  FORMAT(1H0,25X,5HHEAD(,A4,1H),1X,8F11.2)
 877  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 872  FORMAT(1H0,20X,30HTAILWATER RATING CURVE NAME - ,2A4)
      RETURN
      END
