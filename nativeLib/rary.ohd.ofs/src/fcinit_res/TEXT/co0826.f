C MODULE CO0826
C
      SUBROUTINE CO0826(NC08,GOTTS,GETTWO,STAGEQ,VALUE,RCCO,
     .                  LENDSU,JDEST,IERR)
C---------------------------------------------------------------------
C  SUBROUTINE TO READ AND INTERPRET PARAMETER INPUT FOR S/U #08
C   DOWNSTREAM STAGE AND POOL CONTROLLED RELEASE SCHEME
C---------------------------------------------------------------------
C  JTOSTROWSKI - HRL - DECEMBER 1983
C----------------------------------------------------------------
C
      INCLUDE 'common/comn26'
C
C
      INCLUDE 'common/err26'
C
C
      INCLUDE 'common/fld26'
C
C
      INCLUDE 'common/read26'
C
C
      INCLUDE 'common/suid26'
C
C
      INCLUDE 'common/suin26'
C
C
      INCLUDE 'common/suky26'
C
C
      INCLUDE 'common/warn26'
C
      DIMENSION INPUT(2,3),LINPUT(3),IC(3),RCCO(8),
     . WORK(1),OK(3)
      LOGICAL ENDFND,ALLOK,OK,GETTWO,STAGEQ,GOTTS
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_res/RCS/co0826.f,v $
     . $',                                                             '
     .$Id: co0826.f,v 1.3 1998/07/02 16:53:59 page Exp $
     . $' /
C    ===================================================================
C
C
      DATA INPUT/4HGAGE,4H1   ,4HRATI,4HNG1 ,4HRATI,4HNG2 /
      DATA LINPUT/2,2,2/
      DATA NINPUT/3/
      DATA NDINPU/2/
C
C
C  INITIALIZE LOCAL VARIABLES AND COUNTERS
C
      NC08 = 0
      ALLOK = .TRUE.
      TSCO = 0.01
C
      DO 1 I=1,NINPUT
      OK(I) = .TRUE.
      IC(I) = 0
    1 CONTINUE
C
C  NOW PROCESS INPUT UP TO 'ENDC'.
C
      IERR = 0
C
C  CO FOUND, LOOKING FOR ENDC
C
      LPOS = LSPEC + NCARD + 1
      LASTCD = LENDSU
      IBLOCK = 1
C
    5 IF (NCARD .LT. LASTCD) GO TO 8
           CALL STRN26(59,1,SUKYWD(1,11),3)
           IERR = 99
           GO TO 9
    8 NUMFLD = 0
      CALL UFLD26(NUMFLD,IERF)
      IF(IERF .GT. 0 ) GO TO 9000
      NUMWD = (LEN -1)/4 + 1
      IDEST = IKEY26(CHAR,NUMWD,SUKYWD,LSUKEY,NSUKEY,NDSUKY)
      IF (IDEST.EQ.0) GO TO 5
C
C  IDEST = 11 IS FOR ENDC
C
      IF (IDEST.EQ.11.OR.IDEST.EQ.12) GO TO 9
          CALL STRN26(59,1,SUKYWD(1,11),3)
          JDEST = IDEST
          IERR = 89
    9 LENDC = NCARD
C
C  ENDC CARD OR TS OR PARMS FOUND AT LENDC,
C  ALSO ERR RECOVERY IF NEITHER ONE OF THEM FOUND.
C
C
      IBLOCK = 2
      CALL POSN26(MUNI26,LPOS)
      NCARD = LPOS - LSPEC -1
C
   10 CONTINUE
      NUMFLD = 0
      CALL UFLD26(NUMFLD,IERF)
      IF(IERF .GT. 0) GO TO 9000
      NUMWD = (LEN -1)/4 + 1
      IDEST = IKEY26(CHAR,NUMWD,INPUT,LINPUT,NINPUT,NDINPU)
      IF(IDEST .GT. 0) GO TO 50
      IF(NCARD .GE. LENDC) GO TO 900
C
C  NO VALID KEYWORD FOUND
C
      CALL STER26(1,1)
      ALLOK = .FALSE.
      GO TO 10
C
C  NOW SEND CONTROL TO PROPER LOCATION FOR PROCESSING EXPECTED INPUT
C
   50 CONTINUE
      GO TO (100,200,300) , IDEST
C
C----------------------------------------------------------------------
C  'GAGE1' FOUND. GET THE CO INFO FROM THE REST OF THE LINE.
C
  100 CONTINUE
C
C  CAN ONLY FIND THIS CARRYOVER IF A TIME-SERIES FOR LOCAL FLOW FOR GAGE
C  1 WAS FOUND.
C
      IF (.NOT.GOTTS) CALL STRN26(60,1,INPUT(1,IDEST),LINPUT(IDEST))
      IC(IDEST) = IC(IDEST) + 1
      IF (IC(IDEST).GT.1) CALL STER26(39,1)
C
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.0) GO TO 9000
C
C  VALUE MUST BE REAL
C
      IF (ITYPE .LE. 1) GO TO 110
      CALL STER26(4,1)
      GO TO 10
C
C  ONLY POSITIVE VALUES ARE ALLOWED
C
  110 CONTINUE
      IF (REAL.GE.0.0) GO TO 120
      CALL STER26(95,1)
      GO TO 10
C
  120 CONTINUE
      VALUE = REAL/CONVLT
C
C  EVERYTHING IS OK
C
      OK(IDEST) = .TRUE.
      GO TO 10
C
C-----------------------------------------------------------------------
C  'RATING1' FOUND.
C
  200 CONTINUE
C
C  ONLY ALLOWED IF WE'RE USING STAGES IN CONTROLLING THE RELEASES
C
cc      IF (.NOT.STAGEQ) CALL STRN26(60,1,INPUT(1,IDEST),LINPUT(IDEST))
      IC(IDEST) = IC(IDEST) + 1
      IF (IC(IDEST).GT.1) CALL STER26(39,1)
C
      OK(IDEST) = .FALSE.
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 215
C
C  MUST BE REAL VALUE FOR PREVIOUS PERIOD STAGE.
C
      IF (ITYPE.LE.1) GO TO 210
C
      CALL STER26(4,1)
      GO TO 215
C
  210 CONTINUE
      RCCO(1) = REAL/CONVL
C
C  GET REAL POSITIVE VALUE FOR PREVIOUS PERIOD DISCHARGE.
C
  215 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 235
C
C  MUST BE REAL VALUE
C
      IF (ITYPE.LE.1) GO TO 220
      CALL STER26(4,1)
      GO TO 235
C
C  MUST BE POSITIVE VALUE
C
  220 CONTINUE
      IF (REAL .GE. 0.0) GO TO 230
C
      CALL STER26(61,1)
      GO TO 235
C
  230 CONTINUE
      RCCO(2) = REAL/CONVLT
C
C  GET REAL VALUE FOR PREVIOUS PERIOD RATE OF CHANGE IN STAGE
C
  235 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 255
C
C  MUST BE REAL VALUE
C
      IF (ITYPE.LE.1) GO TO 250
C
      CALL STER26(4,1)
      GO TO 255
C
  250 CONTINUE
      RCCO(3) = REAL/CONVL
C
C  GET # OF MISSING VALUES (POSITIVE INTEGER)
C
  255 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 275
C
C  NEED POSITIVE INTEGER
C
      IF (ITYPE.LE.0) GO TO 260
      CALL STER26(5,1)
      GO TO 275
C
  260 CONTINUE
      IF (INTEGR .GE. 0) GO TO 270
      CALL STER26(61,1)
      GO TO 275
C
  270 CONTINUE
      RCCO(4) = INTEGR + 0.01
C
C  FINISHED WITH 'RATING1'
C
  275 CONTINUE
      OK(IDEST) = .TRUE.
      GO TO 10
C
C-----------------------------------------------------------------------
C  'RATING2' FOUND.
C
  300 CONTINUE
C
C  ONLY ALLOWED IF WE'RE USING STAGES IN CONTROLLING THE RELEASES
C  AND WE HAVE TWO GAGES.
C
cc      IF (.NOT.STAGEQ .OR. .NOT.GETTWO)
      IF (.NOT.GETTWO)
     .   CALL STRN26(60,1,INPUT(1,IDEST),LINPUT(IDEST))
      IC(IDEST) = IC(IDEST) + 1
      IF (IC(IDEST).GT.1) CALL STER26(39,1)
C
      OK(IDEST) = .FALSE.
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 315
C
C  MUST BE REAL VALUE FOR PREVIOUS PERIOD STAGE.
C
      IF (ITYPE.LE.1) GO TO 310
C
      CALL STER26(4,1)
      GO TO 315
C
  310 CONTINUE
      RCCO(5) = REAL/CONVL
C
C  GET REAL POSITIVE VALUE FOR PREVIOUS PERIOD DISCHARGE.
C
  315 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 335
C
C  MUST BE REAL VALUE
C
      IF (ITYPE.LE.1) GO TO 320
      CALL STER26(4,1)
      GO TO 335
C
C  MUST BE POSITIVE VALUE
C
  320 CONTINUE
      IF (REAL .GE. 0.0) GO TO 330
C
      CALL STER26(61,1)
      GO TO 335
C
  330 CONTINUE
      RCCO(6) = REAL/CONVLT
C
C  GET REAL VALUE FOR PREVIOUS PERIOD RATE OF CHANGE IN STAGE
C
  335 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 355
C
C  MUST BE REAL VALUE
C
      IF (ITYPE.LE.1) GO TO 350
C
      CALL STER26(4,1)
      GO TO 355
C
  350 CONTINUE
      RCCO(7) = REAL/CONVL
C
C  GET # OF MISSING VALUES (POSITIVE INTEGER)
C
  355 CONTINUE
      NUMFLD = -2
      CALL UFLD26(NUMFLD,IERF)
      IF (IERF.GT.1) GO TO 9000
      IF (IERF.EQ.1) GO TO 375
C
C  NEED POSITIVE INTEGER
C
      IF (ITYPE.LE.0) GO TO 360
      CALL STER26(5,1)
      GO TO 375
C
  360 CONTINUE
      IF (INTEGR .GE. 0) GO TO 370
      CALL STER26(61,1)
      GO TO 375
C
  370 CONTINUE
      RCCO(8) = INTEGR + 0.01
C
C  FINISHED WITH 'RATING1'
C
  375 CONTINUE
      OK(IDEST) = .TRUE.
      GO TO 10
C--------------------------------------------------------------------
C  END OF INPUT. ALL CARRYOVER WILL BE STORED IN SU0826 AS THIS
C  CARRYOVER WILL BE TACKED ON THE END OF THE LAG&K CARRYOVER
C  INPUT IN PM0826
C
  900 CONTINUE
C
      GO TO 9999
C
C-----------------------------------------------------------------
C
C  ERROR IN UFLD26
C
 9000 CONTINUE
      IF (IERF.EQ.1) CALL STER26(19,1)
      IF (IERF.EQ.2) CALL STER26(20,1)
      IF (IERF.EQ.3) CALL STER26(21,1)
      IF (IERF.EQ.4) CALL STER26( 1,1)
C
      IF (NCARD.GE.LASTCD) GO TO 9100
      IF (IBLOCK.EQ.1)  GO TO 5
      IF (IBLOCK.EQ.2)  GO TO 10
C
 9100 USEDUP = .TRUE.
C
 9999 CONTINUE
      RETURN
      END
