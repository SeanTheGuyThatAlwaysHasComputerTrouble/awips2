C MEMBER PRPD26
C  (from old member FCPRPD26)
C
      SUBROUTINE PRPD26(PO,LP,LT)
C
C***********************************************************************
C
C     UPSTREAM STAGE MINIMIZATION COMPUTATIONAL SCHEME
C
      REAL NORMP,NORMQ
      DIMENSION PO(1),X(365),Y(365),IDAY(365),ANAME(5)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/CNVP26/CONV1,CONV2,CONV3,CONV4,CONV5,UNT1,UNT2,UNT3,UNT4,
     .        UNT5
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_res/RCS/prpd26.f,v $
     . $',                                                             '
     .$Id: prpd26.f,v 1.2 1999/04/22 15:08:23 page Exp $
     . $' /
C    ===================================================================
C
C
      DATA BLANK/4H    /
C
      NUPST=PO(LP)
      LO=LP
      DO 192 J=1,NUPST
 192  X(J)=PO(LO+J)*CONV1
      LO=LO+NUPST+1
      NUPP=PO(LO)
      DO 194 J=1,NUPP
 194  Y(J)=PO(LO+J)*CONV1
      LO=LO+NUPP
      WRITE(IPR,932)
 932  FORMAT(1H0,20X,47HUPSTREAM RATING CURVE(POOL ELEVATION DEPENDENT))
      WRITE(IPR,934)UNT1,(X(J),J=1,NUPST)
 934  FORMAT(1H0,25X,16HUPSTREAM STAGES(,A4,1H),7F11.2,(/47X,7F11.2))
      WRITE(IPR,936)UNT1,UNT2
 936  FORMAT(1H0,25X,16HPOOL ELEVATIONS(,A4,1H),25X,11HDISCHARGES(,A4,
     1 1H))
      DO 195 J=1,NUPP
      DO 193 K=1,NUPST
 193  X(K)=PO(LO+K)*CONV2
      WRITE(IPR,938)Y(J),(X(K),K=1,NUPST)
 938  FORMAT(1H0,25X,F8.2,13X,7F11.2,(/47X,7F11.2))
      LO=LO+NUPST
 195  CONTINUE
C
      LO=LO+1
      WRITE(IPR,699)
      WRITE(IPR,940)
 940  FORMAT(1H0,20X,14HDECISION TABLE)
      WRITE(IPR,942)
 942  FORMAT(1H0,91X,8HUPSTREAM,11X,8HUPSTREAM)
      WRITE(IPR,944)
 944  FORMAT(1H ,25X,8X,4HPEAK,13X,8HDRAWDOWN,13X,8HDRAWDOWN,8X,
     1 14HLIMITING STAGE,6X,14HLIMITING STAGE)
      WRITE(IPR,946)
 946  FORMAT(1H ,30X,9HDISCHARGE,11X,9HELEVATION,14X,4HRATE,10X,
     1 15H(STARTING EVAC),5X,15H(STOPPING EVAC))
      WRITE(IPR,948)UNT2,UNT1,UNT4,UNT1,UNT1
 948  FORMAT(1H ,25X,5(7X,1H(,A4,1H),7X))
C
      NLINES=PO(LO)
      ANAME(1)=CONV2
      ANAME(2)=CONV1
      ANAME(3)=CONV4
      ANAME(4)=CONV1
      ANAME(5)=CONV1
      DO 198 J=1,NLINES
      NLOC=LO+J
      DO 196 K=1,5
      X(K)=PO(NLOC)*ANAME(K)
      NLOC=NLOC+NLINES
 196  CONTINUE
      WRITE(IPR,950)(X(K),K=1,5)
 950  FORMAT(1H0,25X,5(F14.2,5X))
 198  CONTINUE
C
      NVAL=5*NLINES
      LO=LO+NVAL+1
      NPER=PO(LO)
      FACT=PO(LO+1)
      REFILL=PO(LO+2)*CONV1
      FLOODQ=PO(LO+3)*CONV2
      NORMQ=PO(LO+4)*CONV2
      NORMP=PO(LO+5)*CONV1
      LO=LO+5
      WRITE(IPR,699)
      WRITE(IPR,952) NPER
 952  FORMAT(1H0,20X,32HNUMBER OF FUTURE PERIODS TO SCAN/,23X,
     1 48HFOR PEAK UPSTREAM DISCHARGE                    =,I8)
      WRITE(IPR,954)FACT
 954  FORMAT(1H0,20X,39HFACTOR USED TO MULTIPLY BASE EVACUATION/,23X,
     1 48HRATE TO SPECIFY OPTIONAL RATE                  =,F11.2)
      WRITE(IPR,956)REFILL,UNT1
 956  FORMAT(1H0,20X,50HUPSTREAM STAGE INDICATING RESERVOIR REFILL
     1 =,F11.2,1X,A4)
      WRITE(IPR,958)FLOODQ,UNT2
 958  FORMAT(1H0,20X,26HDISCHARGE CAUSING FLOODING,/23X,
     1 48HIMMEDIATELY DOWNSTREAM                         =,F11.2,1X,A4)
      WRITE(IPR,960)NORMQ,UNT2
 960  FORMAT(1H0,20X,50HNORMAL NON-FLOOD SITUATION RELEASE
     1 =,F11.2,1X,A4)
C
      LO=LO+1
      IF(NORMP.GT.0)GO TO 1992
      NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GT.0)GO TO 1982
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      NVAL=PO(LO)
 1982 DO 1984 J=1,NVAL
 1984 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 1986 J=1,NVAL
 1986 X(J)=PO(LO+J)*CONV1
      WRITE(IPR,820)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1988 WRITE(IPR,825)(IDAY(J),J=JB,JE)
      WRITE(IPR,830)UNT1,(X(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1990
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1988
 1990 LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      GO TO 1994
 1992 WRITE(IPR,962)NORMP,UNT1
 962  FORMAT(1H0,20X,50HNORMAL NON-FLOOD POOL ELEVATION
     1 =,F11.2,1X,A4)
C
 1994 NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 1995
      LO=-1*NVAL+PO(10)-1
      MOVE=1
      NVAL=PO(LO)
 1995 DO 1996 J=1,NVAL
 1996 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1997 J=1,NVAL
 1997 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      WRITE(IPR,862)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1998 WRITE(IPR,864)UNT1,(X(J),J=JB,JE)
      WRITE(IPR,866)UNT2,(Y(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1999
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1998
C
 1999 NVAL=PO(LO)
      MOVE=0
      NLOC=LO
      IF(NVAL.GE.0)GO TO 1960
      LO=-1*NVAL+PO(10)-1
      NVAL=PO(LO)
      MOVE=1
      GO TO 1964
 1960 IF(NVAL.NE.0)GO TO 1964
      NHVAL=1
      GO TO 1966
 1964 DO 1968 J=1,NVAL
 1968 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1970 J=1,NVAL
 1970 Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      GO TO 1972
 1966 CONSTQ=PO(LO+1)*CONV2
 1972 INT=PO(LO+2)
C
      IF(NHVAL.EQ.1)GO TO 1977
      WRITE(IPR,874)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1974 WRITE(IPR,876)UNT1,(X(J),J=JB,JE)
      WRITE(IPR,877)UNT2,(Y(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1976
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1974
 1976 WRITE(IPR,872)ANAME(1),ANAME(2)
      GO TO 1978
 1977 WRITE(IPR,964)CONSTQ,UNT2
 964  FORMAT(1H0,20X,50HCONSTANT NON-SPILLWAY DISCHARGE
     1 =,F11.2,1X,A4)
 1978 IF(INT.EQ.0)WRITE(IPR,740)
      IF(INT.GT.0)WRITE(IPR,742)
C
C     PRINT TIME SERIES
      WRITE(IPR,795)
      LO=LT
      DO 1979 J=1,2
      IF(PO(LO).EQ.BLANK)GO TO 1981
      IT=PO(LO+3)
      WRITE(IPR,798)PO(LO),PO(LO+1),PO(LO+2),IT
      LO=LO+5
      GO TO 1979
 1981 LO=LO+2
 1979 CONTINUE
C
 500  CONTINUE
 740  FORMAT(1H0,10X,37HLINEAR INTERPOLATION IS USED IN CURVE)
 742  FORMAT(1H0,10X,42HLOGARITHMIC INTERPOLATION IS USED IN CURVE)
 795  FORMAT(1H0,20X,64HADDITIONAL TIME SERIES:         ID         TYPE
     1        TIME(HR)/)
  798 FORMAT(1H ,52X,2A4,3X,A4,11X,I2)
 820  FORMAT(1H0,20X,16HRULECURVE VALUES)
 825  FORMAT(1H0,25X,10HJULIAN DAY,8I11)
 830  FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
 832  FORMAT(1H0,20X,50HTIME OF DAY RULE CURVE IS SET
     1 -,I8)
 862  FORMAT(1H0,20X,21HSPILLWAY RATING CURVE)
 864  FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
 866  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 874  FORMAT(1H0,20X,23HHEAD VS DISCHARGE CURVE)
 876  FORMAT(1H0,25X,5HHEAD(,A4,1H),1X,8F11.2)
 877  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 872  FORMAT(1H0,20X,30HTAILWATER RATING CURVE NAME - ,2A4)
 699  FORMAT(1H )
      RETURN
      END
