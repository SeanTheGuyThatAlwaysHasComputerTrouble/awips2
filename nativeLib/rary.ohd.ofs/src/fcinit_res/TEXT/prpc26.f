C MODULE PRPC26
C
      SUBROUTINE PRPC26(PO,LP,LT)
C
C*******************************************************************
C     DISCHARGE MINIMIZATION COMPUTATIONAL SCHEME
C
      REAL NORMP,NORMQ
      DIMENSION PO(*),X(365),Y(365),IDAY(365),ANAME(5),FLOPT(2)
      COMMON/IONUM/IN,IPR,IPU
      COMMON/CNVP26/CONV1,CONV2,CONV3,CONV4,CONV5,UNT1,UNT2,UNT3,UNT4,
     .      UNT5
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_res/RCS/prpc26.f,v $
     . $',                                                             '
     .$Id: prpc26.f,v 1.6 1999/04/22 15:07:51 page Exp $
     . $' /
C    ===================================================================
C
      DATA FLOPT/4HNO  ,4HYES /
C
      INCOPT=PO(LP)
      HUPPER=PO(LP+1)*CONV1
      HLOWER=PO(LP+2)*CONV1
      CONV=PO(LP+3)
      WRITE(IPR,902)INCOPT
 902  FORMAT(1H0,20X,50HINCREASING FLOW OPTION
     1 =,I8)
      WRITE(IPR,904)HUPPER,UNT1
 904  FORMAT(1H0,20X,50HLIMITING UPPER ELEVATION
     1 =,F11.2,1X,A4)
      WRITE(IPR,906)HLOWER,UNT1
 906  FORMAT(1H0,20X,50HLIMITING LOWER ELEVATION
     1 =,F11.2,1X,A4)
      WRITE(IPR,908)CONV
 908  FORMAT(1H0,20X,50HTOLERANCE
     1 =,F12.3)
C
      LO=LP+4
      IWHICH=PO(LO)
      LO=LO+1
      IF(IWHICH.NE.0)GO TO 1800
      NORMQ=PO(LO)*CONV2
      WRITE(IPR,909)NORMQ,UNT2
 909  FORMAT(1H0,20X,50HCONSTANT NON-SPILLWAY MAXIMUM DISCHARGE
     1 =,F11.2,1X,A4)
      LO=LO+1
 1800 MOVE=0
      NLOC=LO
      NVAL=PO(LO)
      IF(NVAL.GT.0)GO TO 181
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      NVAL=PO(LO)
 181  DO 182 J=1,NVAL
 182  X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 184 J=1,NVAL
 184  Y(J)=PO(LO+J)*CONV2
      LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF(IWHICH.GE.0)WRITE(IPR,862)
      IF(IWHICH.LT.0)WRITE(IPR,863)
 863  FORMAT(1H0,20X,36HELEVATION VS MAXIMUM DISCHARGE CURVE)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 185  WRITE(IPR,864)UNT1,(X(J),J=JB,JE)
      IF(IWHICH.GE.0)WRITE(IPR,866)UNT2,(Y(J),J=JB,JE)
      IF(IWHICH.LT.0)WRITE(IPR,867)UNT2,(Y(J),J=JB,JE)
 867  FORMAT(1H ,25X,5HMAXQ(,A4,1H),1X,8F11.2)
      IF(JE.GE.NVAL)GO TO 186
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 185
 186  IF(IWHICH.LT.0)GO TO 187
      INTP=PO(LO)
      LO=LO+1
      IF(INTP.EQ.0)WRITE(IPR,740)
      IF(INTP.EQ.1)WRITE(IPR,742)
 187  IF(IWHICH.LE.0)GO TO 1885
      NVAL=PO(LO)
      MOVE=0
      IF(NVAL.EQ.0)GO TO 1882
      NLOC=LO
      MOVE=0
      IF(NVAL.GT.0)GO TO 188
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      NVAL=PO(LO)
 188  DO 1872 J=1,NVAL
 1872 X(J)=PO(LO+J)*CONV1
      LO=LO+NVAL
      DO 1874 J=1,NVAL
 1874 Y(J)=PO(LO+J)*CONV2
      WRITE(IPR,874)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 189  WRITE(IPR,876)UNT1,(X(J),J=JB,JE)
      WRITE(IPR,877)UNT2,(Y(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1882
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 189
C
 1882 LO=LO+NVAL+1
      IF(MOVE.EQ.1)LO=NLOC+1
      ANAME(1)=PO(LO)
      ANAME(2)=PO(LO+1)
      WRITE(IPR,872)ANAME(1),ANAME(2)
      LO=LO+2
      CONV=PO(LO)
      WRITE(IPR,910)CONV
 910  FORMAT(1H0,20X,50HCONVERGENCE CRITERION
     1 =,F11.2)
 1885 LO=LO+1
C
cc 1885 REPLQ=PO(LO)
      REPLQ=PO(LO)*CONV2
      NPERR=PO(LO+1)
      INCQ=PO(LO+2)
      LO=LO+3
      IF(INCQ.NE.1)GO TO 1887
      FLOODQ=PO(LO)*CONV2
      LO=LO+1
 1887 IEVOPT=PO(LO)
      NPERF=PO(LO+1)
      HTARG=PO(LO+2)*CONV1
      LO=LO+3
      WRITE(IPR,912)REPLQ,UNT2
 912  FORMAT(1H0,20X,50HPEAK REPOSITIONING THRESHHOLD
     1 =,G14.6,1X,A4)
      WRITE(IPR,914)NPERR
 914  FORMAT(1H0,20X,38HNUMBER OF PERIODS TO LINEARLY INCREASE,/23X,
     1 48HDISCHARGE TO PEAK                              =,I8)
      IF(INCQ.EQ.0)WRITE(IPR,915)FLOPT(1)
      IF(INCQ.GT.0)WRITE(IPR,915)FLOPT(2)
 915  FORMAT(1H0,20X,39HOPTION FOR INCREASING MAXIMUM DISCHARGE/,23X,
     1 48HTO FLOOD DISCHARGE IF MAX < FLOOD              =,7X,A4)
      IF(INCQ.GT.0)WRITE(IPR,917)FLOODQ,UNT2
 917  FORMAT(1H0,20X,50HFLOOD DISCHARGE
     1 =,F11.2,1X,A4)
      WRITE(IPR,916)IEVOPT
 916  FORMAT(1H0,20X,50HEVACUATION OPTION
     1 =,I8)
      WRITE(IPR,920)NPERF
 920  FORMAT(1H0,20X,30HNUMBER OF PERIODS FOR LINEARLY/,23X,
     1 48HDECREASING OUTFLOW                             =,I8)
      IF(HTARG.GT.0)WRITE(IPR,922)HTARG,UNT1
 922  FORMAT(1H0,20X,50HTARGET ELEVATION
     1 =,F11.2,1X,A4)
      IF(HTARG.LT.0)WRITE(IPR,923)
 923  FORMAT(1H0,20X,23HUSE RULECURVE ELEVATION)
C
      NRULE=PO(LO)
      NVAL=NRULE
      NLOC=LO
      MOVE=0
      IF(NRULE.EQ.0) GO TO 1898
      IF(NVAL.GT.0)GO TO 1890
      MOVE=1
      LO=-1*NVAL+PO(10)-1
      NVAL=PO(LO)
 1890 DO 1892 J=1,NVAL
 1892 IDAY(J)=PO(LO+J)
      LO=LO+NVAL
      DO 1894 J=1,NVAL
 1894 X(J)=PO(LO+J)*CONV1
      WRITE(IPR,820)
      JB=1
      JE=NVAL
      IF(JE.GT.8)JE=8
 1895 WRITE(IPR,825)(IDAY(J),J=JB,JE)
      WRITE(IPR,830)UNT1,(X(J),J=JB,JE)
      IF(JE.GE.NVAL)GO TO 1897
      JB=JE+1
      JE=JE+8
      IF(JE.GT.NVAL)JE=NVAL
      GO TO 1895
C
 1897 LO=LO+NVAL+1
      ITIME=PO(LO)
      IF(ITIME.GE.0) WRITE(IPR,832)ITIME
 1898 LO=LO+1
      IF(MOVE.EQ.1)LO=NLOC+1
      IF((INCQ.NE.1).AND.(IEVOPT.NE.2))GO TO 500
      QLOW=PO(LO)*CONV2
      WRITE(IPR,925)QLOW,UNT2
 925  FORMAT(1H0,20X,50HLOWER LIMITING DISCHARGE
     1 =,F11.2,1X,A4)
C
 500  CONTINUE
 740  FORMAT(1H0,10X,37HLINEAR INTERPOLATION IS USED IN CURVE)
 742  FORMAT(1H0,10X,42HLOGARITHMIC INTERPOLATION IS USED IN CURVE)
 795  FORMAT(1H0,20X,64HADDITIONAL TIME SERIES:         ID         TYPE
     1        TIME(HR)/)
  798 FORMAT(1H ,52X,2A4,3X,A4,11X,I2)
 820  FORMAT(1H0,20X,16HRULECURVE VALUES)
 825  FORMAT(1H0,25X,10HJULIAN DAY,8I11)
 830  FORMAT(1H ,25X,5HELEV(,A4,1H),8F11.2)
 832  FORMAT(1H0,20X,50HTIME OF DAY RULE CURVE IS SET
     1 -,I8)
 862  FORMAT(1H0,20X,21HSPILLWAY RATING CURVE)
 864  FORMAT(1H0,25X,5HELEV(,A4,1H),1X,8F11.2)
 866  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 874  FORMAT(1H0,20X,23HHEAD VS DISCHARGE CURVE)
 876  FORMAT(1H0,25X,5HHEAD(,A4,1H),1X,8F11.2)
 877  FORMAT(1H ,25X,6HDISCH(,A4,1H),8F11.2)
 872  FORMAT(1H0,20X,30HTAILWATER RATING CURVE NAME - ,2A4)
 699  FORMAT(1H )
      RETURN
      END
