C MEMBER SRMAPE
C-----------------------------------------------------------------------
C
C DESC READ AREA MAPE PARAMETER RECORD
C
      SUBROUTINE SRMAPE (IVMAPE,XMAPEI,DESCRP,CENTRD,ISTWT,POWER,
     *   PEMEAN,PECHNG,MPE,NPE,STAID,IPDPTR,STAWT,UNUSED,
     *   LARRAY,ARRAY,IPTR,IPRERR,IPTRNX,ISTAT)
C
      DIMENSION ARRAY(LARRAY)
      DIMENSION XMAPEI(1),DESCRP(1),CENTRD(1)
      DIMENSION PEMEAN(1),PECHNG(1),STAID(2,1),IPDPTR(1),STAWT(1)
      DIMENSION UNUSED(1)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_read/RCS/srmape.f,v $
     . $',                                                             '
     .$Id: srmape.f,v 1.1 1995/09/17 19:14:52 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.1) WRITE (IOSDBG,130)
      IF (ISTRCE.GT.1) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG(4HMAPE)
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,140) LARRAY
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      ISTAT=0
C
C  READ PARAMETER RECORD
      CALL SUDOPN (1,4HPPP ,IERR)
      CALL RPPREC (XMAPEI,4HMAPE,IPTR,LARRAY,ARRAY,NFILL,IPTRNX,
     *     IERR)
      IF (IERR.EQ.0) GO TO 10
      ISTAT=IERR
      IF (ISTAT.EQ.6) GO TO 120
      IF (IPRERR.EQ.0) GO TO 120
         CALL SRPPST (XMAPEI,4HMAPE,IPTR,LARRAY,NFILL,IPTRNX,IERR)
         CALL SUERRS (LP,0,-1)
         WRITE (LP,190)
         CALL SULINE (LP,2)
         GO TO 120
C
C  SET PARAMETER ARRAY VERSION NUMBER
10    IVMAPE=ARRAY(1)
C
C  SET MAPE AREA IDENTIFIER
      XMAPEI(1)=ARRAY(2)
      XMAPEI(2)=ARRAY(3)
C
      NPOS=3
C
C  SET DESCRIPTIVE INFORMATION
      DO 20 I=1,5
         NPOS=NPOS+1
20       DESCRP(I)=ARRAY(NPOS)
C
C  SET CENTROID OF AREA (NWSRFS/HRAP COORDINATES)
      DO 30 I=1,2
        NPOS=NPOS+1
30      CENTRD(I)=ARRAY(NPOS)
C
C  SET TYPE OF STATION WEIGHTS
      NPOS=NPOS+1
      ISTWT=ARRAY(NPOS)
C
C  SET EXPONENT IN 1/D**POWER
      NPOS=NPOS+1
      POWER=ARRAY(NPOS)
C
C  SET MEAN PE FOR 16TH OF EACH MONTH (MM)
      DO 40 I=1,12
         NPOS=NPOS+1
40       PEMEAN(I)=ARRAY(NPOS)
C
C  SET DAILY CHANGE IN MEAN PE (MM)
      DO 50 I=1,12
         NPOS=NPOS+1
50       PECHNG(I)=ARRAY(NPOS)
C
C  THE NEXT TWO POSITIONS ARE UNUSED
      DO 60 I=1,2
        NPOS=NPOS+1
60      UNUSED(I)=ARRAY(NPOS)
C
C  SET NUMBER OF PE STATIONS USED TO COMPUTE MAPE
      NPOS=NPOS+1
      NPE=ARRAY(NPOS)
C
C  SET PE STATION IDENTIFIERS
      IF (NPE.LE.MPE) GO TO 70
         WRITE (LP,160) NBOX,MBOX
         CALL SUERRS (LP,2,-1)
         ISTAT=1
         GO TO 110
70    DO 80 J=1,NPE
         DO 80 I=1,2
            NPOS=NPOS+1
80          STAID(I,J)=ARRAY(NPOS)
C
C  SET ARRAY LOCATION OF POINTERS FOR PE DATA FOR THIS STATION
      DO 90 I=1,NPE
         NPOS=NPOS+1
90       IPDPTR(I)=ARRAY(NPOS)
C
C  SET PE STATION WEIGHTS
      DO 100 I=1,NPE
         NPOS=NPOS+1
100      STAWT(I)=ARRAY(NPOS)
C
      IF (LDEBUG.EQ.0) GO TO 110
         WRITE (IOSDBG,150) NPOS,NFILL,IPTRNX,IVMAPE
         CALL SULINE (IOSDBG,1)
         CALL SUPDMP (4HMAPE,4HREAL,0,NPOS,ARRAY,ARRAY)
C
110   IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) WRITE (IOSDBG,180)
      IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) CALL SULINE (IOSDBG,1)
      IF (LDEBUG.GT.0.AND.ISTAT.GT.0) WRITE (IOSDBG,190)
      IF (LDEBUG.GT.0.AND.ISTAT.GT.0) CALL SULINE (IOSDBG,1)
C
120   IF (ISTRCE.GT.1) WRITE (IOSDBG,200) ISTAT
      IF (ISTRCE.GT.1) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
130   FORMAT (' *** ENTER SRMAPE')
140   FORMAT (' LARRAY=',I5)
150   FORMAT (' NPOS=',I3,3X,'NFILL=',I3,3X,'IPTRNX=',I3,3X,
     *   'IVMAPE=',I3)
160   FORMAT ('0*** ERROR - IN SRMAPE - NUMBER OF STATIONS TO ',
     *   'BE PROCESSED (',I3,') EXCEEDS MAXIMUM ARRAY DIMENSIONS (',
     *   I3,').')
180   FORMAT ('0*** NOTE - MAPE PARAMETERS SUCCESSFULLY ',
     *     'READ.')
190   FORMAT ('0*** NOTE - MAPE PARAMETERS NOT SUCCESSFULLY ',
     *     'READ.')
200   FORMAT (' *** EXIT SRMAPE : STATUS CODE=',I2)
C
      END
