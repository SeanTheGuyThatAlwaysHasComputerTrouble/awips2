C MEMBER SRMARO
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 03/01/94.14:02:33 BY $WC20SV
C
C @PROCESS LVL(77)
C
C DESC READ MEAN AREAL RUNOFF (MARO) PARAMETERS
C
      SUBROUTINE SRMARO (IVMARO,XMAROI,XDESCR,CENTRD,NGRID,
     *   ITSREC,NMSGPA,XSTAID,MMDRBX,MDRGPA,NMGPA,NMRFRO,UNUSED,
     *   LARRAY,ARRAY,IPTR,IPRERR,IPTRNX,ISTAT)
C
      DIMENSION ARRAY(LARRAY)
      INCLUDE 'scommon/dimmaro'
      DIMENSION UNUSED(*)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_read/RCS/srmaro.f,v $
     . $',                                                             '
     .$Id: srmaro.f,v 1.1 1995/09/17 19:14:54 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,130)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('MARO')
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,140) LARRAY
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      ISTAT=0
C
C  READ PARAMETER RECORD
      CALL SUDOPN (1,'PPP ',IERR)
      CALL RPPREC (XMAROI,'MARO',IPTR,LARRAY,ARRAY,NFILL,IPTRNX,
     *     IERR)
      IF (IERR.EQ.0) GO TO 10
      ISTAT=IERR
      IF (ISTAT.EQ.6) GO TO 120
      IF (IPRERR.EQ.0) GO TO 120
         CALL SRPPST (XMAROI,'MARO',IPTR,LARRAY,NFILL,IPTRNX,IERR)
         WRITE (LP,190) XMAROI
         CALL SUERRS (LP,2,-1)
         GO TO 120
C
C  SET PARAMETER ARRAY VERSION NUMBER
10    IVMARO=ARRAY(1)
C
C  SET MARO AREA IDENTIFIER
      XMAROI(1)=ARRAY(2)
      XMAROI(2)=ARRAY(3)
C
      NPOS=3
C
C  SET DESCRIPTIVE INFORMATION
      DO 20 I=1,5
         NPOS=NPOS+1
         XDESCR(I)=ARRAY(NPOS)
20       CONTINUE
C
C  SET CENTROID OF AREA (LAT/LON IN DECIMAL DEGREES)
      DO 30 I=1,2
         NPOS=NPOS+1
         CENTRD(I)=ARRAY(NPOS)
30       CONTINUE
C
C  SET NUMBER OF GRID POINTS IN MARO AREA
      NPOS=NPOS+1
      NGRID=ARRAY(NPOS)
C
C
C  SET RECORD NUMBER OF MAPG AND MAPI TIME SERIES HEADERS
      DO 40 I=1,2
         NPOS=NPOS+1
         ITSREC(I)=ARRAY(NPOS)
40       CONTINUE
C
C  SET GRID POINT ADDRESS OF FIRST OFDER STATION ASSIGNED TO THE MARO
      NPOS=NPOS+1
      NMSGPA=ARRAY(NPOS)
C
C  SET FIRST ORDER STATION IDENTIFIER
      DO 50 I=1,2
         NPOS=NPOS+1
         XSTAID(I)=ARRAY(NPOS)
50       CONTINUE
C
C  SET MDR BOX NUMBER OF 3 MDR BOXES THAT SURROUND AREA
      DO 60 I=1,3
         NPOS=NPOS+1
         MMDRBX(I)=ARRAY(NPOS)
60       CONTINUE
C
C  SET GRID POINT ADDRESS OF THE CENTROID OF EACH OF THE 3 MDR BOXES
      DO 70 I=1,3
         NPOS=NPOS+1
         MDRGPA(I)=ARRAY(NPOS)
70       CONTINUE
C
C  THE NEXT TWO POSITIONS ARE UNUSED
      DO 80 I=1,2
         NPOS=NPOS+1
         UNUSED(I)=ARRAY(NPOS)
80       CONTINUE
C
C  SET GRID POINT ADDRESS OF EACH GRID POINT IN THE AREA
      DO 90 I=1,NGRID
         NPOS=NPOS+1
         NMGPA(I)=ARRAY(NPOS)
90       CONTINUE
C
C  SET RAINFALL-RUNOFF RELATIONSHIP NUMBER ASSOCIATED WITH EACH GRID
C  POINT
      DO 100 I=1,NGRID
         NPOS=NPOS+1
         NMRFRO(I)=ARRAY(NPOS)
100      CONTINUE
C
      IF (LDEBUG.EQ.0) GO TO 110
         WRITE (IOSDBG,150) NPOS,NFILL,IPTRNX,IVMARO
         CALL SULINE (IOSDBG,1)
         CALL SUPDMP ('MARO','BOTH',0,NPOS,ARRAY,ARRAY)
         WRITE (IOSDBG,160) ITSREC
         CALL SULINE (IOSDBG,1)
         WRITE (IOSDBG,170) MDRGPA
         CALL SULINE (IOSDBG,1)
C
110   IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) WRITE (IOSDBG,180) XMAROI
      IF (LDEBUG.GT.0.AND.ISTAT.EQ.0) CALL SULINE (IOSDBG,1)
      IF (LDEBUG.GT.0.AND.ISTAT.GT.0) WRITE (IOSDBG,190) XMAROI
      IF (LDEBUG.GT.0.AND.ISTAT.GT.0) CALL SULINE (IOSDBG,1)
C
120   IF (ISTRCE.GT.0) WRITE (IOSDBG,200) ISTAT
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
130   FORMAT (' *** ENTER SRMARO')
140   FORMAT (' LARRAY=',I5)
150   FORMAT (' NPOS=',I3,3X,'NFILL=',I3,3X,'IPTRNX=',I3,3X,
     *   'IVMARO=',I3)
160   FORMAT (' ITSREC=',2(I5,1X))
170   FORMAT (' MDRGPA=',3(I5,1X))
180   FORMAT ('0*** NOTE - MARO PARAMETERS FOR AREA ',2A4,
     *   ' SUCCESSFULLY READ.')
190   FORMAT ('0*** NOTE - MARO PARAMETERS FOR AREA ',2A4,
     *   ' NOT SUCCESSFULLY READ.')
200   FORMAT (' *** EXIT SRMARO : STATUS CODE=',I2)
C
      END
