C MEMBER CSAVE
C  (from old member FCCSRSET)
C
C DESC 'IN-CORE SORTING PACKAGE FOR CARRYOVER USED IN CGDEF COMMAND'
C.......................................................................
C                             LAST UPDATE: 07/27/95.12:12:15 BY $WC21DT
C
      SUBROUTINE CSAVE(C,NC,ISLOT,NSAVE,NARAYS,ARAY1,LARAY1,ARAY2,
     .  LARAY2,ARAY3,LARAY3,ARAY4,LARAY4,ARAY5,LARAY5,ARAY6,LARAY6,
     .  ARAY7,LARAY7,ARAY8,LARAY8,ARAY9,LARAY9,ARAY10,LARA10,IER)
C
C  IN-CORE SORTING PACKAGE USED TO SORT C ARRAYS DURING CARRYOVER
C  GROUP DEFINITION.  THE ORIGINAL PACKAGE HAD THREE ROUTINES --
C    1.CSRSET -- MUST BE CALLED FIRST TO SET UP THE BOOKKEEPING
C                ARRAYS FOR LATER CALLS.
C    2.CSAVE  -- USED TO PLACE A C ARRAY INTO A SPECIFIED SLOT IN
C                CORE FOR LATER RETRIEVAL.
C    3.CRETRV -- USED TO RETRIEVE A PREVIOUSLY SAVED C ARRAY.
C
C  ALL ARGUMENTS TO ALL THREE ENTRIES RETAIN THE SAME MEANING.
C
C  ARGUMENT  DESCRIPTION
C  --------  ----------------------------------------------------------
C  C         C ARRAY
C  NC        LENGTH OF C ARRAY. MUST BE UNCHANGED IN CALLS TO CSAVE AND
C            CRESTR AFTER CSRSET IS CALLED TO SET UP BOOKKEEPING FOR A
C            SPECIFIC SIZE C ARRAY.
C  ISLOT     SLOT TO SAVE OR RETRIEVE C ARRAY INTO/FROM.(NOT USED IN
C            ENTRY CSRSET)
C  NSAVE     MAX NUMBER OF SLOTS TO BE SAVED.  MUST NOT BE ALTERED
C            AFTER CSRSET IS CALLED.
C  ARAY*     WORKING STORAGE ARRAY *   THESE ROUTINES ARE WRITTEN TO
C            USE UP TO 10 WORKING STORAGE ARRAYS(IF NEEDED) OF ANY
C            AVAILABLE SIZE.  OF COURSE, THE CALLS TO CSRSET, CSAVE,
C            AND CRESTR MUST HAVE EXACTLY THE SAME WORKING STORAGE
C            ARRAYS IN EXACTLY THE SAME ORDER.
C  LARAY*    LENGTH OF THE *-TH WORKING STORAGE ARRAY.(VALUE OF ZERO
C            IS LEGAL)
C  IER       SET TO 0 FOR NORMAL RETURN, =1 IF ERROR OCCURS.
C
C  ROUTINE ORIGINALLY WRITTEN BY --
C    ED JOHNSON -- HRL -- 14 NOV 1979
C.......................................................................
      DIMENSION C(NC)
      DIMENSION ARAY1(NSAVE,1),ARAY2(NSAVE,1),ARAY3(NSAVE,1)
      DIMENSION ARAY4(NSAVE,1),ARAY5(NSAVE,1),ARAY6(NSAVE,1)
      DIMENSION ARAY7(NSAVE,1),ARAY8(NSAVE,1),ARAY9(NSAVE,1)
      DIMENSION ARAY10(NSAVE,1)
C NUSEAR IS NUMBER OF POSITIONS USED IN EACH ARRAY
CC AV      DIMENSION NUSEAR(10)
C IDEFIN(I)=1 IF CSAVE CALLED WITH ISLOT=I
CC AV      DIMENSION IDEFIN(30)
C
      INCLUDE 'common/fdbug'
      INCLUDE 'common/ionum'
      INCLUDE 'common/crsort'
C
cc AV pgf90 port 7/3/01      COMMON  /CRSORT/ NUSEAR,IDEFIN,MSAVE,MC
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_top/RCS/csave.f,v $
     . $',                                                             '
     .$Id: csave.f,v 1.3 2002/02/11 20:25:55 dws Exp $
     . $' /
C    ===================================================================
C
C
cc AV      DATA NUSEAR/10*0/
cc AV      DATA IDEFIN/30*0/
C VALUES OF MSAVE AND MC SET ON CALL TO CSRSET TO NSAVE AND NC
cc AV      DATA MSAVE/-1/,MC/-1/
C
C  DEBUG FLAG = 'CGDF'
C
      DATA BUGOPT/4HCGDF/
C
      IF(ITRACE.GE.2)WRITE(IODBUG,904)
 904  FORMAT(18H *** CSAVE ENTERED)
      IF(IFBUG(BUGOPT).NE.1)GO TO 210
      WRITE(IODBUG,802)NC,ISLOT,NSAVE
 802  FORMAT(28H --IN CSAVE, NC,ISLOT,NSAVE=,3(1X,I6))
 210  IF(NC.EQ.MC.AND.NSAVE.EQ.MSAVE.AND.ISLOT.GT.0.AND.ISLOT.LE.NSAVE)
     .  GO TO 220
      WRITE(IPR,905)
 905  FORMAT('0** ERROR** IN CSAVE')
      WRITE(IPR,906)NC,MC,NSAVE,MSAVE,ISLOT
 906  FORMAT(1H ,11X,25HEITHER LENGTH OF C ARRAY(,I6,
     .  30H) CHANGED FROM CALL TO CSRSET(,I6,5H), OR,/,
     .  1H ,11X,21HNUMBER OF DAYS SAVED(,I6,19H) CHANGED FROM CALL ,
     .  10HTO CSRSET(,I6,5H), OR,/,
     .  1H ,11X,19HISLOT OUT OF RANGE(,I6,1H))
      IER=1
      CALL ERROR
      RETURN
 220  IDEFIN(ISLOT)=1
      IC1=0
      DO 250 I=1,NARAYS
      N=NUSEAR(I)
      IF(N.LE.0)GO TO 250
      DO 240 J=1,N
      GO TO (221,222,223,224,225,226,227,228,229,230),I
 221  ARAY1(ISLOT,J)=C(IC1+J)
      GO TO 240
 222  ARAY2(ISLOT,J)=C(IC1+J)
      GO TO 240
 223  ARAY3(ISLOT,J)=C(IC1+J)
      GO TO 240
 224  ARAY4(ISLOT,J)=C(IC1+J)
      GO TO 240
 225  ARAY5(ISLOT,J)=C(IC1+J)
      GO TO 240
 226  ARAY6(ISLOT,J)=C(IC1+J)
      GO TO 240
 227  ARAY7(ISLOT,J)=C(IC1+J)
      GO TO 240
 228  ARAY8(ISLOT,J)=C(IC1+J)
      GO TO 240
 229  ARAY9(ISLOT,J)=C(IC1+J)
      GO TO 240
 230  ARAY10(ISLOT,J)=C(IC1+J)
      GO TO 240
 240  CONTINUE
      IC1=IC1+N
 250  CONTINUE
      IER=0
      RETURN
      END
