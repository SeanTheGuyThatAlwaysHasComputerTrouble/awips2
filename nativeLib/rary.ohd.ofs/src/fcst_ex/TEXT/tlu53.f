C MEMBER TLU53
C-----------------------------------------------------------------------
C
C@PROCESS LVL(77)
C
      SUBROUTINE TLU53(A1,A2,TABLE,R)
C
C     GIVEN 1ST INDEPENDENT ARGUMENT (A1), 2ND INDEPENDENT ARGUMENT
C     (A2), AND TABLE OF FAMILY OF CURVES (TABLE ARRAY) AS LOADED FROM
C     CARD CODE CF CARDS, INTERPOLATE FOR DEPENDENT RESULT (R).
C     TABLE (TABLE) IS ARRANGED AS FOLLOWS-
C      TABLE(1) IS LENGTH OF TABLE
C      TABLE(2) 1ST VALUE OF 2ND INDEP VARIABLE (START OF Z SEGMENT)
C      TABLE(3)-TABLE(4),
C      TABLE(5)-TABLE(6),
C      TABLE(7)-TABLE(8), PAIRS OF WORDS CONTAINING 1ST INDEP, DEPENDENT
C       VALUE OF POINT ON SURFACE. FOR INSTANCE, TABLE(2), TABLE(5) AND
C      TABLE(6) ARE 2ND INDEP, 1ST INDEP, DEPENDENT VALUES OF ONE POINT
C       ON THE SURFACE.
C      TABLE(9)-TABLE(15) AND EACH 7 WORD GROUP THEREAFTER ARE SAME AS 
C      TABLE(2)-TABLE(8). (7 WORD GROUP IS CALLED Z SEGMENT IN PROGRAM)
C       EXAMPLE-IF 1ST INDEPENDENT VARIABLE IS X, 2ND IS Z, AND
C      DEPENDENT VARIABLE IS Y, TABLE IS IN FOLLOWING ORDER-
C       L,Z1,X11,Y11,X12,Y12,X13,Y13,Z2,X21,Y21,X22,Y22,X23,Y23,ETC.
      DIMENSION TABLE(2)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_ex/RCS/tlu53.f,v $
     . $',                                                             '
     .$Id: tlu53.f,v 1.1 1996/03/21 14:18:37 page Exp $
     . $' /
C    ===================================================================
C
C        LOCATE SEGMENTS OF CURVES BRACKETING A2 (Z DIRECTION, 2ND
C         INDEPENDENT VARIABLE)
C          PICKUP LENGTH OF TABLE-RECORD
      IE=TABLE(1)
      IZL= 2
      ZL = TABLE(2)
      IZL2 = 0
C        INSURE THAT THERE ARE AT LEAST 2 SEGMENTS
      IF(IE-15) 130, 20, 20
C        SCAN FOR BRACKETING Z SEGMENTS
  20  DO 100 J=9,IE,7
      Z = TABLE(J)
      IF(ZL-Z) 30, 100, 30
C        NEW SEGMENT FOUND, IS IT HIGHER
   30 IZL2 = IZL
      IZL = J
      ZL = Z
      IF (A2-Z)200,120,100
 100  CONTINUE
C       END OF STMT 20 DO. FALL THRU IF A2 TOO HIGH
C        TEST-IS ONLY ONE CURVE IN TABLE
      IF(IZL2) 110, 130, 110
C        NO, SETUP EXTRAPOLATION FOR Z
 110  J = IZL2
      GO TO 200
C        Z EQUAL TO A2
 120  IZL2 = 0
      IJ = IZL
      GO TO 200
C        ONLY 1 Z CURVE IN TABLE
 130  J = IZL
      IJ=J
C
C        Z SEGMENTS FOUND. J POINTS TO 1 Z-SEG. IZL POINTS TO OTHER.
C        IF IZL2 IS ZERO, IZL SEGMENT IS NOT USED BECAUSE A2 = Z ON
C        J SEGMENT, OR THERE IS ONLY ONE SEGMENT IN TABLE.
C
 200  MA = 0
      IF (IZL2.EQ.0) GO TO 210
      IJ = IZL2
C        FIND POINTS BRACKETING A1 (X COORDINATE), INTERPOLATE FOR Y
C         ON THIS Z CURVE. (ENTERED ALSO FROM STMT 420)
 210  IX2=0
      ZX = TABLE(IJ)
      IX = IJ+1
      X = TABLE(IX)
      IXI = IX+2
      DO 260 I=IJ,IE,7
 218  X2 = TABLE(IXI)
      IF(X-X2) 220,242, 260
C        POINTS ARE ASCENDING, ASSUME TABLE(IX2) VALID POINT
 220  IF(X2-A1) 230, 270, 280
C        NOT FAR ENOUGH ON SEGMENT
 230  IF(IXI-I-5) 240, 250, 240
C        INCR TO NEXT POINT ON Z SEG
 240  IX2 = IX
      IX = IXI
      X =X2
 242  IXI=IXI+2
      GO TO 218
C        END OF Z SEGMENT. TRY NEXT ONE.
  250 IF(ZX-TABLE(I+7))300,255,300
C        NEXT SEG SAME Z
  255 IX = IXI
      X = X2
 260  IXI = I+8
C        END 210 DO RANGE.
C        FALL THRU HERE IF A1 LARGER THAN LAST POINT ON Z CURVE.
      GO TO 300
C        A1 EQUALS X OF POINT AT IXI, NO INTERP NEEDED.
 270  Y = TABLE(IXI+1)
      GO TO 400
C        BRACKETING POINTS FOUND AT TABLE(IX) AND TABLE(IXI)
 280  IX2 = IXI
C        INTERPOLATE (OR EXTRAPOLATE) FOR Y ON THIS Z CURVE.
 300  IF(IX2) 320, 310, 320
C        ONLY ONE POINT ON CURVE - TAKE ITS Y VALUE.
 310  Y = TABLE(IX+1)
      GO TO 400
 320  YT = TABLE(IX+1)
      Y =YT+ (A1-X)*((TABLE(IX2+1)-YT)/(TABLE(IX2)-X))
C        Y CONTAINS POINT ON Z CURVE AT A1
 400  IF(MA) 430, 410, 430
C        INTERP COMPLETE ON 1ST Z CURVE (STARTED AT STMT 200)
 410  IF(IZL2) 420, 412, 420
C        1 CURVE ONLY NEEDED
 412  R = Y
      GO TO 450
C        INTERP 2ND CURVE
 420  IJ = IZL
      MA = 1
      Y2 = Y
      Z = ZX
      GO TO 210
C        2ND Z CURVE INTERPOLATED. NOW, INTERP FOR Y AT A2.
 430  IF(Z-ZX) 440, 412, 440
 440  R = Y2+(A2-Z)*((Y-Y2)/(ZX-Z))
 450  CONTINUE
      RETURN
      END
