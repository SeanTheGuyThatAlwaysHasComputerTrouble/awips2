C MEMBER HDNG12
C  (from old member FCEX12)
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 04/27/95.08:22:15 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE HDNG12(P,IDTQ,PSBL,CMO,NDAYS,UNIT,UNITP,NPLOTS,IOPTAB,
     1  SCALE,LOCFS,LOCLL,LOCUL,IBUG)
C
C
C     THIS ROUTINE PRINTS THE HEADING FOR THE INSTANTANEOUS
C     DISCHARGE PLOT OPERATION
C
C
      DIMENSION P(*),IDTQ(1),PSBL(1),CMO(12),NDAYS(12),UNIT(2),STGUNT(2)
      DIMENSION UNITP(2),SCALE(10),QSCL(11),STGSCL(11),CODUM(4)
C
      INCLUDE 'common/ionum'
      INCLUDE 'common/fdbug'
      INCLUDE 'common/fctime'
      INCLUDE 'common/fengmt'
      INCLUDE 'common/fratng'
      INCLUDE 'common/fprog'
      INCLUDE 'common/where'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_insqplot/RCS/hdng12.f,v $
     . $',                                                             '
     .$Id: hdng12.f,v 1.1 1995/09/17 18:58:23 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA BLANK/4H    /,CODUM/0.0,0.0,0.0,0.0/,STGUNT/4H(FT),4H(M) /
C
      CALL MDYH1(IDA,IHR,IMTHST,IDAYST,IYRST,IHRST,NOUTZ,NOUTDS,TZON)
      CALL MDYH1(LDA,LHR,IMTHND,IDAYND,IYRND,IHRND,NOUTZ,NOUTDS,TZON)
      IF(((IYRST/4)*4).EQ.IYRST)NDAYS(2)=29
      IRC=P(11)
      IF(IRC.LE.0 .OR. IFMSNG(FRLOOP).EQ.1) GO TO 205
      WRITE(IPR,826)P(IRC),P(IRC+1)
  826 FORMAT(1H0,10X,'*WARNING* RATING CURVE ',2A4,
     1  ' HAS LOOP RATING OPTION TURNED ON, ',
     2  'A STAGE SCALE CANNOT BE COMPUTED')
      CALL WARN
C
C     PRINT HEADING AND ADDITIONAL INFORMATION
C
C     IF(MAINUM.EQ.1)WRITE(IPR,600)
C 600 FORMAT(////)
C     IF(MAINUM.NE.1)WRITE(IPR,601)
  205 WRITE(IPR,601)
  601 FORMAT(1H1)
      IF(MAINUM.EQ.1)WRITE(IPR,959)(P(I),I=2,6),CMO(IMTHST),IDAYST,IYRST
     1,CMO(IMTHND),IDAYND,IYRND,TZON,ISEG
  959 FORMAT(' ***** ',5A4,' *****   INSTANTANEOUS DISCHARGE ',
     15HFROM ,A3,I3,1H,,I4,4H TO ,A3,I3,1H,,I4,3X,10HTIME ZONE=,A4,
     2  9H   ***** ,2A4,6H *****)
      IF(MAINUM.NE.1)WRITE(IPR,969)(P(I),I=2,6),CMO(IMTHST),IDAYST,IYRST
     1,CMO(IMTHND),IDAYND,IYRND,TZON
  969 FORMAT(' ***** ',5A4,' *****   INSTANTANEOUS DISCHARGE ',
     15HFROM ,A3,I3,1H,,I4,4H TO ,A3,I3,1H,,I4,3X,10HTIME ZONE=,A4)
      WRITE(IPR,906)
  906 FORMAT(1H ,5X,32HTIME SERIES TABULATED OR PLOTTED/1H ,3X,
     18HCONTENTS,8X,4HI.D.,4X,4HTYPE,2X,13HTIME INTERVAL,3X,
     215HPLOTTING SYMBOL,5X,23HTABULATION LABEL(UNITS))
      IRC=P(11)
      IPTR=11
      IF((IOPTAB.NE.1).AND.(IOPTAB.NE.3))GO TO 210
      IDT=P(IPTR+4)
      WRITE(IPR,907)(P(IPTR+J),J=5,7),(P(IPTR+K),K=1,3),IDT,UNITP(METRIC
     1+1)
  907 FORMAT(1H ,3X,3A4,2X,2A4,2X,A4,5X,I2,6H HOURS,11X,3HN/A,18X,6HPCN
     1 (,A2,1H))
      IPTR=IPTR+7
  210 IF((IOPTAB.NE.2).AND.(IOPTAB.NE.3))GO TO 230
      IDT=P(IPTR+4)
      WRITE(IPR,908)(P(IPTR+J),J=5,7),(P(IPTR+K),K=1,3),IDT,UNITP(METRIC
     1+1)
  908 FORMAT(1H ,3X,3A4,2X,2A4,2X,A4,5X,I2,6H HOURS,11X,3HN/A,18X,6HINFW
     1 (,A2,1H))
      IPTR=IPTR+7
  230 DO 231 I=1,NPLOTS
      IF(I.GT.2)GO TO 232
      WRITE(IPR,947)(P(IPTR+J),J=5,7),(P(IPTR+K),K=1,3),IDTQ(I),PSBL(I),
     1I,UNIT(METRIC+1)
  947 FORMAT(1H ,3X,3A4,2X,2A4,2X,A4,5X,I2,6H HOURS,12X,A1,18X,2H Q,I1,
     13H  (,A3,1H))
      IPTR=IPTR+8
      GO TO 231
  232 WRITE(IPR,948)(P(IPTR+J),J=5,7),(P(IPTR+K),K=1,3),IDTQ(I),PSBL(I)
  948 FORMAT(1H ,3X,3A4,2X,2A4,2X,A4,5X,I2,6H HOURS,12X,A1,22X,3HN/A)
      IPTR=IPTR+8
  231 CONTINUE
      IF(IRC.EQ.0)GO TO 850
      IF(IFMSNG(FRLOOP).EQ.1) WRITE(IPR,820)P(IRC),P(IRC+1)
  820 FORMAT(6X,'RATING CURVE ',2A4,' USED TO GENERATE STAGE ',
     1  'SCALE'/)
      CONV=1.
      IF(METRIC.EQ.0)CONV=35.3147
      QSCL(1)=0.0
      DO 830 I=1,10
  830 QSCL(I+1)=SCALE(I)/CONV
      ICONV=2
      LOCSCL=1
      NUMSCL=11
      DELSCL=0.
      IDASTG=IDA
      IHRSTG=IHR
      IPRWRN=0
C
      IF(IBUG.EQ.1)WRITE(IODBUG,840)IRC,P(IRC),P(IRC+1),ICONV,LOCSCL,
     1  NUMSCL,DELSCL,QSCL,CODUM,IDASTG,IHRSTG
  840 FORMAT(1H0,10X,'**ABOUT TO ENTER FSTGQ - ARGUMENTS ARE'/
     1  11X,'IRC= ',I5,', RCID= ',2A4,', ICONV= ',I2,
     2  ', LOCSCL= ',I5,', NUMSCL= ',I3,', DELSCL= ',F5.1/
     3  11X,'QSCL= ',11F10.2/11X,'CODUM= ',4F5.0,
     4  ', IDASTG= ',I10,', IHRSTG= ',I2,', IPRWRN= ',I2)
C
      IF(IFMSNG(FRLOOP).EQ.0) GO TO 835
      CALL FSTGQ(P(IRC),ICONV,LOCSCL,NUMSCL,DELSCL,QSCL,STGSCL,LDUM,
     1  TDUM,RCLL,RCUL,XSECLO,XSECUP,METHOD,FLDSTG,NEEDEX,CODUM,
     2  IDASTG,IHRSTG,IRCHNG,IFSTGQ,IPRWRN)
C
      IF(IBUG.EQ.1)WRITE(IODBUG,841)STGSCL,RCLL,RCUL,METHOD,
     1  FLDSTG,NEEDEX,CODUM,IDASTG,IHRSTG,IRCHNG,IFSTGQ
  841 FORMAT(1H0,10X,'**BACK FROM FSTGQ - ARGUMENTS ARE'/
     1  11X,'STGSCL = ',11F10.3/11X,'RCLL = ',F10.3,
     2  ', RCUL = ',F10.3,', METHOD = ',I3,', FLDSTG = ',F10.3/
     3  11X,'NEEDEX = ',I5,', CODUM = ',4F10.2/
     4  11X,'IDASTG = ',I10,', IHRSTG = ',I2,', IRGHNG = ',I2,
     5  ', IFSTGQ = ',I2)
C
      FLOODH = FLDSTG
      IF(METRIC.EQ.1)GO TO 832
      DO 831 I=1,11
  831 STGSCL(I)=STGSCL(I)/0.3048
  833 IF(IFMSNG(RCLL).EQ.0) RCLL=RCLL/0.3048
      IF(IFMSNG(RCUL).EQ.0) RCUL=RCUL/0.3048
      IF(IFMSNG(FLOODH).EQ.0) FLOODH=FLOODH/0.3048
      IF(P(IRC+2).NE.BLANK)WRITE(IPR,821)P(IRC+2),
     1  FLOODH,STGUNT(1)
  821 FORMAT(4X,'THE SYMBOL FOR FLOOD STAGE IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      IF(P(IRC+3).NE.BLANK)WRITE(IPR,822)P(IRC+3),
     1  RCLL,STGUNT(1)
  822 FORMAT(4X,'THE SYMBOL FOR THE RATING CURVE LOWER LIMIT IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      IF(P(IRC+4).NE.BLANK)WRITE(IPR,823)P(IRC+4),
     1  RCUL,STGUNT(1)
  823 FORMAT(4X,'THE SYMBOL FOR THE RATING CURVE UPPER LIMIT IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      WRITE(IPR,929)
  929 FORMAT(1H )
      WRITE(IPR,825)STGUNT(1),STGSCL
  825 FORMAT(7X,'STAGE SCALE ',A4,1X,F9.1,10F10.1)
      GO TO 834
  832 IF(P(IRC+2).NE.BLANK)WRITE(IPR,1821)P(IRC+2),
     1  FLOODH,STGUNT(2)
 1821 FORMAT(4X,'THE SYMBOL FOR FLOOD STAGE IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      IF(P(IRC+3).NE.BLANK)WRITE(IPR,1822)P(IRC+3),
     1  RCLL,STGUNT(2)
 1822 FORMAT(4X,'THE SYMBOL FOR THE RATING CURVE LOWER LIMIT IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      IF(P(IRC+4).NE.BLANK)WRITE(IPR,1823)P(IRC+4),
     1  RCUL,STGUNT(2)
 1823 FORMAT(4X,'THE SYMBOL FOR THE RATING CURVE UPPER LIMIT IS ',A1,
     1  ' -- ',F10.2,1X,A4)
      WRITE(IPR,929)
      WRITE(IPR,1825)STGUNT(2),STGSCL
 1825 FORMAT(7X,'STAGE SCALE ',A4,1X,F10.2,9F10.2,F9.1)
      GO TO 834
  835 LOCFS=0
      LOCLL=0
      LOCUL=0
      GO TO 850
C
  834 LOCFS=0
      IF(P(IRC+2).NE.BLANK)LOCFS=LPLT12(FLOODH,STGSCL)
      LOCLL=0
      IF(P(IRC+3).NE.BLANK)LOCLL=LPLT12(RCLL,STGSCL)
      LOCUL=0
      IF(P(IRC+4).NE.BLANK)LOCUL=LPLT12(RCUL,STGSCL)
C
  850 IF(IBUG.EQ.1)WRITE(IODBUG,842)LOCFS,LOCLL,LOCUL
  842 FORMAT(1H0,10X,'LOCATIONS OF FLOOD STAGE, AND RATING ',
     1  'CURVE LOWER AND UPPER LIMITS ARE'/11X,3I10)
C
      IF(IOPTAB.GT.0) GO TO 240
      IF(NPLOTS.EQ.1)GO TO 250
      IF(SCALE(10).GT.99999999.)GO TO 401
      WRITE(IPR,909)SCALE
  909 FORMAT(1H ,4HTIME,14X,2HQ1,5X,7HQ2  0.0,9F10.1,F10.1)
 1909 FORMAT(1H ,4HTIME,14X,2HQ1,5X,7HQ2  0.0,9G10.3,G10.3)
      GO TO 300
  401 WRITE(IPR,1909)SCALE
      GO TO 300
  250 IF(SCALE(10).GT.99999999.)GO TO 402
      WRITE(IPR,910)SCALE
  910 FORMAT(1H ,4HTIME,14X,2HQ1,9X,3H0.0,9F10.1,F10.1)
 1910 FORMAT(1H ,4HTIME,14X,2HQ1,9X,3H0.0,9G10.3,G10.3)
      GO TO 300
  402 WRITE(IPR,1910)SCALE
      GO TO 300
  240 GO TO (241,242,243),IOPTAB
  241 IF(NPLOTS.GT.1) GO TO 244
      IF(SCALE(10).GT.99999999.)GO TO 403
      WRITE(IPR,911)SCALE
  911 FORMAT(1H ,9HTIME  PCN,9X,2HQ1,9X,3H0.0,9F10.1,F10.1)
 1911 FORMAT(1H ,9HTIME  PCN,9X,2HQ1,9X,3H0.0,9G10.3,G10.3)
      GO TO 300
  403 WRITE(IPR,1911)SCALE
      GO TO 300
  244 IF(SCALE(10).GT.99999999.)GO TO 404
      WRITE(IPR,912)SCALE
  912 FORMAT(1H ,9HTIME  PCN,9X,14HQ1     Q2  0.0,9F10.1,F10.1)
 1912 FORMAT(1H ,9HTIME  PCN,9X,14HQ1     Q2  0.0,9G10.3,G10.3)
      GO TO 300
  404 WRITE(IPR,1912)SCALE
      GO TO 300
  242 IF(NPLOTS.GT.1) GO TO 245
      IF(SCALE(10).GT.99999999.)GO TO 405
      WRITE(IPR,913)SCALE
  913 FORMAT(1H ,4HTIME,6X,10HINFW    Q1,9X,3H0.0,9F10.1,F10.1)
 1913 FORMAT(1H ,4HTIME,6X,10HINFW    Q1,9X,3H0.0,9G10.3,G10.3)
      GO TO 300
  405 WRITE(IPR,1913)SCALE
      GO TO 300
  245 IF(SCALE(10).GT.99999999.)GO TO 406
      WRITE(IPR,914)SCALE
  914 FORMAT(1H ,4HTIME,6X,22HINFW    Q1     Q2  0.0,9F10.1,F10.1)
 1914 FORMAT(1H ,4HTIME,6X,22HINFW    Q1     Q2  0.0,9G10.3,G10.3)
      GO TO 300
  406 WRITE(IPR,1914)SCALE
      GO TO 300
  243 IF(NPLOTS.EQ.1) GO TO 246
      IF(SCALE(10).GT.99999999.)GO TO 407
      WRITE(IPR,915)SCALE
  915 FORMAT(1H ,32HTIME  PCN INFW    Q1     Q2  0.0,9F10.1,F10.1)
 1915 FORMAT(1H ,32HTIME  PCN INFW    Q1     Q2  0.0,9G10.3,G10.3)
      GO TO 300
  407 WRITE(IPR,1915)SCALE
      GO TO 300
  246 IF(SCALE(10).GT.99999999.)GO TO 408
      WRITE(IPR,916)SCALE
  916 FORMAT(1H ,32HTIME  PCN INFW    Q1         0.0,9F10.1,F10.1)
 1916 FORMAT(1H ,32HTIME  PCN INFW    Q1         0.0,9G10.3,G10.3)
      GO TO 300
  408 WRITE(IPR,1916)SCALE
  300 CONTINUE
C
      RETURN
C
      END
