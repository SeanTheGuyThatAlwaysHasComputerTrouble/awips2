C MEMBER XTITLE
C  (from old member PPXTITLE)
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 06/28/94.14:11:37 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE XTITLE (INPTZC,AREAS,NMAP,NDUPL)
C.......................................
C     THIS ROUTINE PRINTS THE TITLE PAGE FOR THE MAP FUNCTION.
C.......................................
C     WRITTEN BY -- ERIC ANDERSON, HRL -- MARCH 1983
C.......................................
      DIMENSION AREAS(1),UNIT(2),U(2,2)
C
C     COMMON BLOCKS
      COMMON/PUDBUG/IOPDBG,IPTRCE,NDBUG,PDBUG(20),IPALL
      COMMON/IONUM/IN,IPR,IPU
      COMMON/XOPT/IXTYPE,XNAME(2),IESTPX,ICONVC,CNVDIS,CVDISW,
     1 NOEST6,IUSESR,PPUSER(2),IMOSUM,IMOWTR,IWTEST
      COMMON/XOPT2/ICKTIM,ICKMAX,PPMAX,NPLT24,IXFUT(6)
      COMMON/XMDR/MDRSTA,ICTMDR,MDRST6,ICMDR,NCMDR,IRMDR,
     1 NRMDR,NMDR,MDR,MDRNUV
      COMMON/XDISPL/MDRPRT,MDRCOM,IPRT24,IPLT24,IPRT6,IPRSSR,
     1 IPRSRW,MAPPRT,METRIC,LASTDY,IPRDAY,IPLTMP
      COMMON/FCTIME/IZDA,IJHRUN,LZDA,LJHRUN,LZDOBS,LJHOBS,NOW(5),
     1 LOCAL,NOUTZ,NOUTDS,NLSTZ,IDA,IHR,LDA,LHR,IZHHDA
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_map/RCS/xtitle.f,v $
     . $',                                                             '
     .$Id: xtitle.f,v 1.1 1995/09/17 19:00:19 dws Exp $
     . $' /
C    ===================================================================
C
C
C     DATA STATEMENTS
      DATA U/4HINCH,4HES. ,4HMM. ,4H    /
C.......................................
C     CHECK TRACE LEVEL
      IF(IPTRCE.GE.1) WRITE(IOPDBG,10)
10    FORMAT(1H0,17H** XTITLE ENTERED)
C.......................................
C
C     PRINT TITLE LINE
      CALL UPAGE (IPR)
      WRITE(IPR,20)
20    FORMAT(1H0,45X,'MAP FUNCTION')
C
C     PRINT RUN PERIOD
      I=0
      CALL MDYH2(IDA,I,MO1,ID1,IY1,IH1,J,K,INPTZC)
      CALL MDYH2(LDA,LHR,MO2,ID2,IY2,IH2,J,K,INPTZC)
      WRITE(IPR,30)MO1,ID1,IY1,IH1,INPTZC,MO2,ID2,IY2,IH2,INPTZC
30    FORMAT(1H0,30X,'RUN PERIOD',2X,
     *  I2.2,'/',I2.2,'/',I4.4,'-',I2.2,A4,
     *  ' THRU ',I2.2,'/',I2.2,'/',I4.4,'-',I2.2,A4 //
     *  59X,'FOR')
C.......................................
C     PRINT TYPE OF RUN
      IF(IXTYPE-2) 40,60,80
C
C     AREA RUN
40    J=2*NMAP
      WRITE(IPR,50)(AREAS(I),I=1,J)
50    FORMAT(1H0,7X,7HAREAS--,10(2X,2A4))
      GO TO 110
C
C     FGROUP RUN
60    WRITE(IPR,70)XNAME,NMAP
70    FORMAT(1H0,39X,14HFORECAST GROUP,2X,2A4,5X,I3,1X,9HMAP AREAS)
      GO TO 110
C
C     CGROUP RUN
80    WRITE(IPR,90)XNAME,NMAP
90    FORMAT(1H0,38X,15HCARRYOVER GROUP,2X,2A4,5X,I4,1X,9HMAP AREAS)
      IF(NDUPL.GT.0) WRITE(IPR,100)NDUPL
100   FORMAT(1H ,43X,I3,1X,29HOCCUR IN MORE THAN ONE FGROUP)
C..........................................
C     PRINT RUN OPTIONS
110   WRITE(IPR,120)
120   FORMAT(1H0,//40X,41HTHE FOLLOWING RUN OPTIONS ARE TURNED ON--,
     1 //21X,9HTECHNIQUE,23X,11HDESCRIPTION,32X,5HVALUE,/21X,
     2 9H---------,23X,11H-----------,32X,5H-----)
      K=0
      J=0
      IF(IESTPX.EQ.0) GO TO 140
      K=1
      WRITE(IPR,130)
130   FORMAT(1H0,20X,8HESTTULSA,7X,
     1 53HTULSA METHOD USED TO ESTIMATE MISSING 24 HOUR AMOUNTS)
140   IF(ICONVC.EQ.0) GO TO 160
      K=1
      WRITE(IPR,150)CNVDIS
150   FORMAT(1H0,20X,6HCONVEC,9X,42HCONVECTIVE OPTION USED TO LIMIT ESTI
     1MATORS,/41X,26HCONVECTIVE RADIUS(CNVRAD)=,F5.0,1X,5HMILES)
160   IF(NOEST6.EQ.0) GO TO 180
      K=1
      WRITE(IPR,170)
170   FORMAT(1H0,20X,8HNOEST6HR,7X,
     1 52HMISSING 6 HR DATA NOT ESTIMATED FROM NEARBY STATIONS)
180   IF(IUSESR.EQ.0) GO TO 200
      K=1
      WRITE(IPR,190)
190   FORMAT(1H0,20X,7HSREST24,8X,
     1 54HSTRANGER REPORTS USE TO ESTIMATE MISSING 24 HR AMOUNTS)
200   IF (ICKTIM.EQ.1) GO TO 220
      K=1
      WRITE(IPR,210)
210   FORMAT(1H0,20X,8HPP24TIME,7X,51HPARTIAL DAY REPORTS WILL BE USED A
     1S FULL DAY VALUES)
220   IF (ICKMAX.EQ.0) GO TO 240
      IF (PPMAX.EQ.0.0) GO TO 240
      K=1
      WRITE(IPR,230) PPMAX
230   FORMAT(1H0,20X,8HPP24MAX ,7X,29HDAILY PRECIP TOTALS EXCEEDING,
     11X,F5.2,1X,15HINCHES NOT USED)
240   IF(IWTEST.EQ.0) GO TO 260
      K=1
      WRITE(IPR,250)
250   FORMAT(1H0,20X,7HWTEST24,8X,
     144HESTIMATED 24-HOUR VALUES WRITTEN TO THE PPDB)
260   IF(MDRSTA.EQ.0) GO TO 320
      K=1
      IF(MDRSTA.NE.1) GO TO 280
      WRITE(IPR,270)MDRSTA
270   FORMAT(1H0,20X,8HMDREST24,7X,
     1 40HMDR USED TO FILL IN ZERO 24 HOUR AMOUNTS,22X,I1)
      GO TO 320
280   IF(MDRSTA.NE.2) GO TO 300
      AMT=ICTMDR*0.01
      WRITE(IPR,290)AMT,MDRSTA
290   FORMAT(1H0,20X,8HMDREST24,7X,40HMDR USED TO ESTIMATE 24 HR AMOUNTS
     1 UP TO,F6.2,1X,6HINCHES,9X,I1)
      GO TO 320
300   WRITE(IPR,310)MDRSTA
310   FORMAT(1H0,20X,8HMDREST24,7X,46HMDR USED TO ESTIMATE ALL MISSING 2
     14 HR AMOUNTS,14X,I3)
320   IF(MDRST6.EQ.0) GO TO 340
      K=1
      WRITE(IPR,330)
330   FORMAT(1H0,20X,7HMDREST6,8X,51HMDR USED TO ESTIMATE MISSING 6 HR N
     1ORMALIZED VALUES)
340   IF(MDRPRT.EQ.0) GO TO 360
      K=1
      WRITE(IPR,350) MDRPRT
350   FORMAT(1H0,20X,6HPRTMDR,9X,
     1 42HPRINT MDR TO PRECIPITATION CONVERSION DATA,18X,I3)
360   IF(MDRCOM.EQ.0) GO TO 380
      K=1
      WRITE(IPR,370)
370   FORMAT(1H0,20X,7HPRTMDR6,8X,
     1 53HPRINT COMPARISON OF MDR AMTS VERSUS 6 HR STATION AMTS)
380   IF(IPRT24.EQ.0) GO TO 400
      K=1
      J=1
      WRITE(IPR,390) IPRT24
390   FORMAT(1H0,20X,7HPRTPP24,8X,53HPRINT DATA FOR STATIONS WITH ONLY 2
     14 HR PRECIPITATION,7X,I3)
400   IF(IPLT24.EQ.0) GO TO 420
      K=1
      IPLOT=NPLT24
      IF ((LZDOBS-IZDA+1).LT.NPLT24) IPLOT=LZDOBS-IZDA+1
      WRITE(IPR,410) IPLOT,IPLT24
410   FORMAT(1H0,20X,8HPLOTPP24,7X,46HGENERATE AFOS PLOT OF 24 HOUR AMOU
     1NTS FOR LAST,I3,1X,4HDAYS,6X,I3)
420   IF(IPRT6.EQ.0) GO TO 440
      K=1
      J=1
      WRITE(IPR,430)
430   FORMAT(1H0,20X,6HPRTPP6,9X,
     1 54HPRINT DATA FOR STATIONS WITH 6 AND 24 HR PRECIPITATION)
440   IF(IPRSSR.EQ.0) GO TO 460
      K=1
      J=1
      WRITE(IPR,450)
450   FORMAT(1H0,20X,7HPRTPPSR,8X,27HPRINT STRANGER STATION DATA)
460   IF(IPRSRW.EQ.0) GO TO 480
      K=1
      WRITE(IPR,470)
470   FORMAT(1H0,20X,6HPRTWGT,9X,32HPRINT RECOMPUTED STATION WEIGHTS)
480   IF(MAPPRT.EQ.0) GO TO 500
      K=1
      J=1
      WRITE(IPR,490)
490   FORMAT(1H0,20X,6HPRTMAP,9X,25HPRINT COMPUTED MAP VALUES)
500   IF(J.EQ.0) GO TO 530
      I=METRIC+1
      UNIT(1)=U(1,I)
      UNIT(2)=U(2,I)
      WRITE(IPR,510)UNIT
510   FORMAT(1H0,/21X,43HSTATION AND MAP TIME SERIES DISPLAYS ARE IN,
     1  1X,2A4)
      IF (LASTDY.EQ.1) WRITE(IPR,520)
520   FORMAT(1H0,20X,53HPRINTER DISPLAYS ARE ONLY GENERATED FOR THE LAST
     1 DAY.)
530   IF(MDRNUV.EQ.0) GO TO 600
      K=1
      IF (MDRNUV-2) 540,560,580
540   WRITE(IPR,550)
550   FORMAT(1H0,20X,53HTECHNIQUE MDRONLY IS TURNED ON FOR ONE OR MORE A
     1REAS.)
      GO TO 600
560   WRITE(IPR,570)
570   FORMAT(1H0,20X,53HTECHNIQUE MDRDIST IS TURNED ON FOR ONE OR MORE A
     1REAS.)
      GO TO 600
580   WRITE(IPR,590)
590   FORMAT(1H0,20X,67HTECHNIQUES MDRONLY AND MDRDIST ARE TURNED ON FOR
     1 ONE OR MORE AREAS.)
600   IF(K.EQ.1) GO TO 620
      WRITE(IPR,610)
610   FORMAT(1H0,20X,24HNO OPTIONS ARE TURNED ON)
C..........................................
C     CHECK TRACE LEVEL
620   IF(IPTRCE.GE.1) WRITE(IOPDBG,630)
630   FORMAT(1H0,14H** EXIT XTITLE)
C..........................................
      RETURN
      END
