C MEMBER XGTOPT
C  (from old member PPXGTOPT)
C
      SUBROUTINE XGTOPT(IERR)
C.......................................
C     THIS SUBROUTINE OBTAINS MAP FUNCTION CONTROL VALUES AND
C     DISPLAY OPTIONS FROM HCL INTERFACE ROUTINES, CHECKS
C     THE VALUES, AND LOADS THE COMMON BLOCKS.
C.......................................
C     WRITTEN BY --ERIC ANDERSON, HRL-- JUNE 1983
C.......................................
      DIMENSION SNAME(2),IARGS(7)
C
C     COMMON BLOCKS
      COMMON/WHERE/IA(2),IND,SUB(2)
      COMMON/FCTIME/IZDA,IJHRUN,LZDA,LJHRUN,LZDOBS,LJHOBS,NOW(5),
     1   LOCAL,NOUTZ,NOUTDS,NLSTZ,IDA,IHR,LDA,LHR,IZHHDA
      COMMON/PUDBUG/IOPDBG,IPTRCE,NDBUG,PDBUG(20),IPALL
      COMMON/IONUM/IN,IPR,IPU
      COMMON/XOPT/IXTYPE,XNAME(2),IESTPX,ICONVC,CNVDIS,CVDISW,
     1   NOEST6, IUSESR,PPUSER(2),IMOSUM,IMOWTR,IWTEST
      COMMON/XOPT2/ICKTIM,ICKMAX,PPMAX,NPLT24,IXFUT(6)
      COMMON/XMDR/MDRSTA,ICTMDR,MDRST6,ICMDR,NCMDR,IRMDR,NRMDR,
     1   NMDR,MDR,MDRNUV
      COMMON/XDISPL/MDRPRT,MDRCOM,IPRT24,IPLT24,IPRT6,IPRSSR,
     1   IPRSRW,MAPPRT,METRIC,LASTDY,IPRDAY,IPLTMP
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_map/RCS/xgtopt.f,v $
     . $',                                                             '
     .$Id: xgtopt.f,v 1.1 1995/09/17 18:59:38 dws Exp $
     . $' /
C    ===================================================================
C
C
C     DATA STATEMENT
      DATA SNAME/4HXGTO,4HPT  /
C.......................................
C     CHECK TRACE LEVEL
      IF(IPTRCE.GE.1)WRITE(IOPDBG,900)
 900  FORMAT(1H0,17H** XGTOPT ENTERED)
C.......................................
C     SET THE WHERE COMMON BLOCK
      IND=-1
      SUB(1)=SNAME(1)
      SUB(2)=SNAME(2)
C.......................................
C     INITIAL VALUE
      IERR=0
C.......................................
C     GET RUN TIMES
      CALL HPASTA(8HSTARTRUN,7,IVAL,NR,IARGS,ISTAT)
      IF (ISTAT.EQ.0) GO TO 101
      CALL FPHPWN (ISTAT,8HSTARTRUN)
      GO TO 100
 101  IF (NR.EQ.7) GO TO 105
 100  WRITE (IPR,901)
 901  FORMAT(1HO,74H**FATAL ERROR** TECHNIQUE STARTRUN AND/OR LSTCMPDY I
     1S NOT PROPERLY DEFINED)
      CALL KILLFN(8HMAP     )
      IERR=1
      GO TO 199
 105  IJHRUN=IARGS(1)
C
      CALL HPASTA(8HLSTCMPDY,7,IVAL,NR,IARGS,ISTAT)
      IF (ISTAT.EQ.0) GO TO 102
      CALL FPHPWN(ISTAT,8HLSTCMPDY)
      GO TO 100
 102  IF(NR.EQ.7) GO TO 110
      GO TO 100
 110  LJHRUN=IARGS(1)
C.......................................
C     GET VALUES FOR CONTROL VARIABLES-NON/MDR
      CALL HPAST(8HESTTULSA,IESTPX,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HESTTULSA)
      CALL FTEKCK(IESTPX,8HESTTULSA,0,IESTPX,0,1)
C
      CALL HPASTA(8HCONVEC  ,1,ICONVC,NR,CNVDIS,ISTAT)
      IF(ISTAT.EQ.0) GO TO 111
      CALL FPHPWN(ISTAT,8HCONVEC  )
      ICONVC=0
      GO TO 115
 111  CALL FTEKCK(ICONVC,8HCONVEC  ,0,ICONVC,0,1)
      IF (ICONV.NE.1) GO TO 115
      IF(CNVDIS.GE.0.0) GO TO 112
      CNVDIS=0.0
      GO TO 113
 112  IF(CNVDIS.LE.100) GO TO 115
      CNVDIS=100.0
 113  WRITE(IPR,902)
 902  FORMAT(1H0,10X,92H**WARNING** FOR TECHNIQUE CONVEC THE CONVECTIVE
     1DISTANCE WAS NOT IN THE RANGE OF 0-100 MILES,/16X,46HTHE DISTANCE
     2WAS ADJUSTED TO THE CLOSEST LIMIT)
      CALL WARN
C
 115  CALL HPAST(8HNOEST6HR,NOEST6,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HNOEST6HR)
      CALL FTEKCK(NOEST6,8HNOEST6HR,0,NOEST6,0,1)
C
      CALL HPAST(8HSREST24 ,IUSESR,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HSREST24 )
      CALL FTEKCK(IUSESR,8HSREST24 ,1,IUSESR,0,1)
C
      CALL HPAST(8HWTEST24 ,IWTEST,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HWTEST24 )
      CALL FTEKCK(IWTEST,8HWTEST24 ,0,IWTEST,0,1)
C
      CALL HPAST(8HPP24TIME,ICKTIM,ISTAT)
      IF (ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPP24TIME)
      CALL FTEKCK(ICKTIM,8HPP24TIME,1,ICKTIM,0,1)
C
      CALL HPASTA(8HPP24MAX ,1,ICKMAX, NR,PPMAX,ISTAT)
      IF (ISTAT.EQ.0) GO TO 114
      CALL FPHPWN(ISTAT,8HPP24MAX )
      ICKMAX=0
      GO TO 125
  114 CALL FTEKCK(ICKMAX,8HPP24MAX ,0,ICKMAX,0,1)
      IF (ICKMAX.NE.1) GO TO 125
      IF (PPMAX.GE.0.0) GO TO 118
      PPMAX=0.0
      GO TO 119
  118 IF (PPMAX.LE.60.0) GO TO 125
      PPMAX=60.0
  119 WRITE(IPR,905)
  905 FORMAT(1H0,10X,96H**WARNING** FOR TECHNIQUE PP24MAX THE MAXIMUM PR
     1ECIP ALLOWED IS NOT IN THE RANGE OF 0-60 INCHES.,/16X,
     248HTHE MAX PRECIP IS ADJUSTED TO THE CLOSEST LIMIT.)
      CALL WARN
C.......................................
C     GET MDR CONTROL VARIABLES
  125 CALL HPASTA(8HMDREST24,1,MDRSTA,NR,UPLMT,ISTAT)
      IF(ISTAT.EQ.0) GO TO 116
      CALL FPHPWN(ISTAT,8HMDREST24)
      MDRSTA=0
      GO TO 120
 116  CALL FTEKCK(MDRSTA,8HMDREST24,0,MDRSTA,0,3)
      IF(MDRSTA.NE.2) GO TO 120
      IF(UPLMT.GT.0.0) GO TO 117
      MDRSTA=1
      WRITE(IPR,903)
 903  FORMAT(1H0,10X,93H**WARNING** FOR TECHNIQUE MDREST24(2), THE UPPER
     1 LIMIT WAS LE TO ZERO--CHANGED TO MDREST24(1))
      CALL WARN
      GO TO 120
  117 ICTMDR=UPLMT*100.0+0.5
C
 120  CALL HPAST(8HMDREST6 ,MDRST6,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HMDREST6 )
      CALL FTEKCK(MDRST6,8HMDREST6 ,0,MDRST6,0,1)
C.......................................
C     GET DISPLAY OPTIONS
      CALL HPAST(8HPRTPP24 ,IPRT24,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTPP24 )
      CALL FTEKCK(IPRT24,8HPRTPP24 ,0,IPRT24,0,2)
C
      CALL HPAST(8HPRTPP6  ,IPRT6,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTPP6  )
      CALL FTEKCK(IPRT6,8HPRTPP6  ,0,IPRT6,0,1)
C
      CALL HPAST(8HPRTMDR  ,MDRPRT,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTMDR  )
      CALL FTEKCK(MDRPRT,8HPRTMDR  ,0,MDRPRT,0,2)
C
      CALL HPAST(8HPRTMDR6 ,MDRCOM,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTMDR6 )
      CALL FTEKCK(MDRCOM,8HPRTMDR6 ,0,MDRCOM,0,1)
C
      CALL HPAST(8HPLOTPP24,IPLT24,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPLOTPP24)
      CALL FTEKCK(IPLT24,8HPLOTPP24,0,IPLT24,0,2)
C
      CALL HPAST(8HPLOTDAYS,NPLT24,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPLOTDAYS)
      CALL FTEKCK(NPLT24,8HPLOTDAYS,10,NPLT24,1,10)
C
      CALL HPAST(8HPRTMAP  ,MAPPRT,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTMAP  )
      CALL FTEKCK(MAPPRT,8HPRTMAP  ,0,MAPPRT,0,1)
C
      CALL HPAST(8HPRTPPSR ,IPRSSR,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTPPSR )
      CALL FTEKCK(IPRSSR,8HPRTPPSR ,0,IPRSSR,0,1)
C
      CALL HPAST(8HPRTWGT  ,IPRSRW,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRTWGT  )
      CALL FTEKCK(IPRSRW,8HPRTWGT  ,0,IPRSRW,0,1)
C
      CALL HPAST(8HMETRIC  ,METRIC,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HMETRIC  )
      CALL FTEKCK(METRIC,8HMETRIC  ,0,METRIC,0,1)
C
      CALL HPAST(8HNOUTZ   ,NOUTZ,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HNOUTZ   )
      CALL FTEKCK(NOUTZ,8HNOUTZ   ,0,NOUTZ,-12,12)
C
      CALL HPAST(8HNOUTDS  ,NOUTDS,ISTAT)
      IF(ISTAT.NE.0) CALL FPHPWN(ISTAT,8HNOUTDS  )
      CALL FTEKCK(NOUTDS,8HNOUTDS  ,0,NOUTDS,0,1)
C
      CALL HPAST(8HPRLASTDY,LASTDY,ISTAT)
      IF (ISTAT.NE.0) CALL FPHPWN(ISTAT,8HPRLASTDY)
      CALL FTEKCK(LASTDY,8HPRLASTDY,0,LASTDY,0,1)
C.......................................
C     CHECK TRACE LEVEL
 199  IF(IPTRCE.GE.1) WRITE(IOPDBG,904)
 904  FORMAT(1H0,14H** EXIT XGTOPT)
C.......................................
      RETURN
      END
