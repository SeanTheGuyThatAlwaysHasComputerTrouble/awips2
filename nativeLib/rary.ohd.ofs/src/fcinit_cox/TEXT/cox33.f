C MEMBER COX33
C  (from old member FCCOX33)
C
C  VERSION 1
C
      SUBROUTINE COX33 (POLD,COLD,PONEW,CONEW)
C
C***********************************************************************
C
C  THIS SUBROUTINE TRANSFERS OLD CARRYOVER VALUES TO THE NEW
C  CO ARRAYS WHEN A SEGMENT IS REDEFINED..
C
C***********************************************************************
C  SUBROUTINE INITIALLY WRITTEN BY
C          TIM SWEENEY - OHRFC           NOVEMBER 1984
C***********************************************************************
C  PRINCIPAL VARIABLES...
C
C  THE VARIABLES POLD AND PONEW ARE THE SAME AS THE PO ARRAY IN THE
C  PIN ROUTINE  LIKEWISE, THE VARIABLES COLD AND CONEW ARE THE SAME AS
C  THE CO ARRAY.  FOR A DESCRIPTION OF THESE CONTENTS, SEE THE PIN33
C  USER DOCUMENTATION.
C
C  FOR DEFINITION OF VARIABLES IN COMMON BLOCKS, SEE SECTION IX.3.3C
C  OF THE NWSRFS USER'S MANUAL.
C
C     AI             CURRENT AI VALUE
C     AIADJ          AI ADJUSTMENT FACTOR
C     AICO           STORM AI VALUE
C     API            CURRENT API VALUE
C     ARECF          API RECESSION FACTOR--NO SNOW
C     ASRF           API RECESSION FACTOR--SNOW
C     AT             CURRENT UNCORRECTED SYNTHETIC TEMPERATURE
C     AVGT           AVERAGE TEMPERATURE
C     IDELT          DELTA-T OF TIME SERIES FOR RAINFALL/MELT AND RUNOFF
C     IFDEB          DEBUG OUTPUT SWITCH, 0 = OFF, 1 = ON
C     INCOFL         READ/NO READ CARRYOVER FLAG, 0 = NO READ, 1 = READ
C     IVERS          VERSION NUMBER
C     LAT            LATITUDE OF ZONE
C     LON            LONGITUDE OF ZONE
C     NALZN          ALTERNATE RUNOFF ZONE NUMBER
C     NEWSTM         STORM PERIOD COUNTER
C     NOP            NUMBER OF OPERATION ASSIGNED TO THIS OPERATION
C     NOZON          RUNOFF ZONE NUMBER
C     NUMCO          THE NUMBER OF ELEMENTS IN THE CO, COLD, AND CONEW
C                      ARRAYS.
C     PRECF          PRECIP RECESSION FACTOR FOR API CALCULATIONS
C     RAINCO         STORM RAINFALL VALUE
C     ROCO           STORM RUNOFF VALUE
C     SUBNAM(2)      SUBROUTINE NAME
C     TC             CURRENT CORRECTED SYNTHETIC TEMPERATURE
C     TCADJ          SYNTHETIC TEMPERATURE ADJUSTMENT FACTOR
C     TOT24          24-HOUR RAINFALL/MELT ENDING 12Z
C     WE             CURRENT WATER EQUIVALENT VALUE
C     WERCR          CRITERIA WE FOR API RECESSION FACTOR WITH SNOW
C
C***********************************************************************
C
C
      DIMENSION POLD(1),COLD(1),PONEW(1),CONEW(1),SUBNAM(2)
C
      COMMON/FDBUG/ IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_cox/RCS/cox33.f,v $
     . $',                                                             '
     .$Id: cox33.f,v 1.1 1995/09/17 18:47:19 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA SUBNAM/4hCOX3,4h3   /,NOP/33/
      DATA EMPTY/4h    /
C
C
C  CALL DEBUG CHECK ROUTINE.
C
      CALL FPRBUG (SUBNAM,1,NOP,IFDEB)
C
C  SET NUMBER OF WORDS IN CO ARRAY.
C
      NUMCO=11
C
C  TRANSFER CO VALUES.
C
      DO 1002 I=1,NUMCO
 1002 CONEW(I)=COLD(I)
      IF(IFDEB) 9999,9999,101
C
C  DEBUG OUTPUT STATEMENTS.
C
  101 IVERS=PONEW(1)
      NOZON=PONEW(8)
      NALZN=PONEW(9)
      LAT=PONEW(10)
      LON=PONEW(11)
      AIADJ=PONEW(12)
      IDELT=PONEW(13)
      TCADJ=PONEW(26)
      PRECF=PONEW(27)
      ARECF=PONEW(28)
      ASRF=PONEW(29)
      WERCR=PONEW(30)
      INCOFL=PONEW(31)
      NEWSTM=CONEW(1)
      RAINCO=CONEW(2)
      AICO=CONEW(3)
      ROCO=CONEW(4)
      API=CONEW(5)
      AI=CONEW(6)
      WE=CONEW(7)
      TOT24=CONEW(8)
      AVGT=CONEW(9)
      AT=CONEW(10)
      TC=CONEW(11)
C
      IOUTFL=0
      IF(PONEW(32)-EMPTY) 103,102,103
  102 IF(PONEW(37)-EMPTY) 103,104,103
  103 IOUTFL=1
C
  104 WRITE(IODBUG,11) SUBNAM,IVERS
      WRITE(IODBUG,12) (PONEW(I),I=2,7),NOZON,NALZN,LAT,LON,AIADJ,
     1                 TCADJ,PRECF,ARECF,ASRF,WERCR,IOUTFL,INCOFL,
     2                 (PONEW(I),I=14,16),IDELT,
     3                 (PONEW(I),I=17,19),IDELT,(PONEW(I),I=20,22),
     4                 (PONEW(I),I=23,25),IDELT
      IF(PONEW(32)-EMPTY) 105,106,105
  105 WRITE(IODBUG,13) (PONEW(I),I=32,34)
  106 IF(PONEW(37)-EMPTY) 107,108,107
  107 WRITE(IODBUG,14) (PONEW(I),I=35,37)
  108 WRITE(IODBUG,15) NEWSTM,RAINCO,AICO,ROCO,API,AI,WE,TOT24,
     1                 AVGT,AT,TC
C
C
 9999 RETURN
C
C
   11 FORMAT(/5X,2A4,' DEBUG OUTPUT.',5X,'VERSION:',I4)
   12 FORMAT(/12X,'ZONE NAME:',2X,6A4,5X,'ZONE NUMBER:',I9,
     1       5X,'ALT ZONE NUMBER:',I5/
     2       53X,'LATITUDE:',8X,I4,5X,'LONGITUDE:',6X,I5/
     3       53X,'AI ADJ FACTOR:',F7.1,5X,'TC ADJ FACTOR:',F7.1/
     4       53X,'PRECIP REC FAC:',F6.2,5X,'AP REC FAC:',5X,F5.2/
     5       53X,'AP SNOW REC FAC:',F5.2,5X,'WE REC CRITERIA:',F5.2/
     6       53X,'OUTPUT TS FLAG:',I6,5X,'C/O INPUT FLAG:',I6//
     7       20X,'TIME SERIES USED BY THIS OPERATION...'/
     8       25X,'CONTENTS',15X,'TS I.D.',5X,'TYPE',5X,'TIME INTERVAL'/
     9       25X,20('-'),2X,8('-'),5X,4('-'),5X,13('-')/
     1       25X,'RAINFALL/MELT',9X,2A4,5X,A4,I9,' HOURS'/
     2       25X,'RUNOFF',16X,2A4,5X,A4,I9,' HOURS'/
     3       25X,'WATER EQUIVALENT',6X,2A4,5X,A4,7X,'24 HOURS'/
     4       25X,'TEMPERATURE',11X,2A4,5X,A4,I9,' HOURS')
   13 FORMAT(25X,'CURRENT API', 11X,2A4,5X,A4,7X,'24 HOURS')
   14 FORMAT(25X,'CURRENT AI',12X,2A4,5X,A4,7X,'24 HOURS')
   15 FORMAT(//20X,'CARRYOVER VALUES...'//
     1       25X,'NEWSTM   RAINCO     AICO     ROCO      API       ',
     1       'AI       WE    TOT24     AVGT       AT       TC'/
     2       27X,I4,3X,F6.2,4X,F5.1,3X,F6.2,4X,F5.2,4X,F5.1,2(3X,F6.2),
     3       3(3X,F6.1))
      END
