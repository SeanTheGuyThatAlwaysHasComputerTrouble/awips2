C MEMBER EV3C26
C
      SUBROUTINE EV3C26(STOR,ELEV)
C
C
C THIS UTILITY SUBROUTINE IS USED FOR OPTION 8 AND
C FOR STEP 2 OF OPTIONS 9, 10 AND 11
C     IN THIS SUBROUTINE, OUTFLOW IS REDUCED AT A SPECIFIED RATE
C  PER HOUR (REDUC1). WHEN THE OUTFLOW FALLS BELOW A SPECIFIED VALUE
C (QTARG3), REDUCE OUTFLOW BY A SPECIFIED RATE PER HOUR (REDUC2).
C WHEN THE OUTFLOW DECREASES TO A VALUE THAT IS, AT MOST, A SPECIFIED
C AMOUNT (DIFFQ2)GREATER THAN THE 3-HOUR AVERAGE INFLOW AND 
C THE POOL IS BELOW A SPECIFIED ELEVATION (HTARG3), OPTION 3B IS USED
C THROUGH EVAB26
C
C THIS SUBROUTINE WAS ORIGINALLY PROGRAMMED BY
C     KUANG HSU -- HRL -- NOVEMBER 1995
C
C
C VARIABLES PASSED TO OR FROM THIS SUBROUTINE ARE DEFINED AS FOLLOWS:
C     IOUT -- SURCHARGE EVACUATION OPERATION IS NO LONGER NEEDED
C       (IOUT=1) OR STILL NEEDED (IOUT=0).
C     IOPTEV -- EVACUATION OPTION.  CAN BE 8, 9, 10 AND 11 IN THIS
C       SUBROUTINE.  OPTIONS ARE DEFINED IN EVAA26.
C     HTARG3 -- SPECIFIED TARGET ELEVATION FOR EVACUATION PROCEDURE IN
C       THIS SUBROUTINE.
C     DIFQI2 -- SPECIFIED ADDITION TO INFLOW FOR COMPARISON WITH OUTFLOW
C       DIFQI2 MUST BE SPECIFIED EVEN IF IT IS 0.
C     QTARG3 -- SPECIFIED TARGET OUTFLOW FOR EVACUATION PROCEDURE IN
C       THIS SUBROUTINE.
C     REDUC1 -- SPECIFIED REDUCTION RATE OF OUTFLOW PER TIME STEP #1
C     REDUC2 -- SPECIFIED REDUCTION RATE OF OUTFLOW PER TIME STEP #2
C
C ALL OTHER VARIABLES ARE DEFINED IN THE THE PARENT SUBROUTINE NDUC26.
C  THIS SUBROUTINE (EV3C26) WILL COMPUTE OUTFLOW (QQO2), STORAGE (SS2),
C AND ELEVATION (ELRES2) AT THE END OF THE TIME STEP AND WILL SET AN
C INDICATOR (IOUT) FOR NEED TO CONTINUE OR NOT CONTINUE EVACUATION.
C
      INCLUDE 'common/fdbug'
      INCLUDE 'common/resv26'
      INCLUDE 'common/srcg26'
      INCLUDE 'common/evak26'
C
      DIMENSION STOR(1),ELEV(1)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_res/RCS/ev3c26.f,v $
     . $',                                                             '
     .$Id: ev3c26.f,v 1.1 1996/07/12 14:07:19 dws Exp $
     . $' /
C    ===================================================================
C
C
C WRITE TRACE AND DEBUG IF REQUIRED.
C
      IF(IBUG-1)50,10,20
   10 WRITE(IODBUG,30)
      GO TO 50
   20 WRITE(IODBUG,30)
 30   FORMAT(1H0,10X,17H** EV3C26 ENTERED)
      WRITE(IODBUG,40) IOUT,IOPTEV,HTARG3,DIFQI2,QTARG3,REDUC1,REDUC2,
     & FRPD,SFRPD,QIMSUR,QQIM,QQO1,QQO2,SS1,SS2,ELRES1,ELRES2,
     & RULEL1,RULEL2,IBUG
   40 FORMAT(1H0,'   IOUT,IOPTEV,HTARG3,DIFQI2,QTARG3,REDUC1,REDUC2,',
     & 'FRPD,SFRPD,QIMSUR,QQIM,QQO1,QQO2,SS1,SS2,ELRES1,ELRES2,RULEL1,',
     & 'RULEL2,IBUG'/1X,2I6,9F12.3/1X,8F12.3,I6)
C
C SET IOUT TO 0 FOR CONTINUED USE OF EVACUATION PROCEDURE UNLESS IOUT IS
C LATER CHANGED TO 1.  COMPUTE OUTFLOW (QQO2) AT END OF TIME STEP.
C
   50 IOUT=0
      IF(QQO1.LT.QTARG3) GO TO 60
      QQO2=QQO1-REDUC1
      SS2=SS1+QQIM-(QQO1+QQO2)*0.5*FRPD
      CALL NTER26(SS2,ELRES2,STOR,ELEV,NSE,IFLAG,NTERP,IBUG)
      CALL BETA26(STOR,ELEV)
      GO TO 80
C
C  DIFQI2 = DIFFQI2
 60   HTARGX=HTARG3
      IF(HTARG3.LT.-900.) 
     & HTARGX=RULEL1+(RULEL2-RULEL1)*SFRPD+HTARG3+999.0
      IF(ELRES2.GE.HTARGX) GO TO 70
      QDXX=QIMSUR+DIFQI2
      IF(QQO2.GE.QDXX .AND. QDXX.GT.QTARG2) GO TO 70
      CALL EVAB26(STOR,ELEV)
      GO TO 80
 70   QQO2=QQO1-REDUC2
      SS2=SS1+QQIM-(QQO1+QQO2)*0.5*FRPD
      CALL NTER26(SS2,ELRES2,STOR,ELEV,NSE,IFLAG,NTERP,IBUG)
      CALL BETA26(STOR,ELEV)
C
C WRITE TRACE AND DEBUG IF REQUIRED.
C
 80   IF(IBUG-1)140,120,90
   90 WRITE(IODBUG,100)
  100 FORMAT(1H0,41H FOLLOWING ARE VARIABLES AT END OF EV3C26)
      WRITE(IODBUG,40) IOUT,IOPTEV,HTARG3,DIFQI2,QTARG3,REDUC1,REDUC2,
     & FRPD,SFRPD,QIMSUR,QQIM,QQO1,QQO2,SS1,SS2,ELRES1,ELRES2,
     & RULEL1,RULEL2,IBUG
      WRITE(IODBUG,110)(STOR(I),ELEV(I),I=1,NSE)
  110 FORMAT(1H0,78H ALTERNATING VALUES OF STORAGE AND ELEVATION FOR THE
     $ STORAGE - ELEV. CURVE ARE/(1X,5(F12.3,F10.3,2X)))
  120 WRITE(IODBUG,130)
  130 FORMAT(1H0,10X,17H** LEAVING EV3C26)
  140 RETURN
      END



