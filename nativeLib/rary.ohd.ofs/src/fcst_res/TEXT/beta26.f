C MEMBER BETA26
C
      SUBROUTINE BETA26(STOR,ELEV)
C
C
C THIS UTILITY SUBROUTINE IS USED FOR OPTION 3B
C THIS UTILITY SUBROUTINE IS USED FOR OPTION 7 AND FOR STEP 2 OF OPTIONS
C 3,4,5,6, AND 8.  OPTIONS 9 AND 10 ALSO USE THIS UTILITY SINCE THOSE
C OPTIONS USE OPTION 8.
C     IN THIS UTILITY SUBROUTINE, IF AT ANY ELEVATION ABOVE A SPECIFIED
C VALUE (HPREVQ), THE AVERAGE SURCHARGE INFLOW EXCEEDS THE OUTFLOW VALUE
C THEN DISCHARGE THE PREVIOUS OUTFLOW AND CONTINUE UNTIL INFLOW IS LESS
C THAN OUTFLOW.  IF OUTFLOW REACHES THE SPECIFIED DISCHARGE (QTARG2)
C BEFORE  THE POOL DROPS TO THE SPECIFIED ELEVATION (FALELB), THE SPEC-
C IFIED DISCHARGE (QTARG2) WILL BE CONTINUED UNTIL THE POOL DROPS TO THE
C SPECIFIED ELEVATION.
C
C THIS SUBROUTINE WAS ORIGINALLY PROGRAMMED BY
C     KUANG HSU -- HYDROLOGIC RESEARCH LABORATORY
C     JANUARY, 1996
C
C SUBROUTINE BETA26 IS IN
C
C VARIABLES PASSED TO OR FROM THIS SUBROUTINE ARE DEFINED AS FOLLOWS:
C     IOUT -- SURCHARGE EVACUATION OPERATION IS NO LONGER NEEDED
C       (IOUT=1) OR STILL NEEDED (IOUT=0).
C     HPREVQ -- IF ELEVATION ABOVE HPREVQ AND SURCHARGE INFLOW EXCEEDS
C               OUTFLOW, DISCHARGE THE PREVIOUS OUTFLOW 
C     FALELB -- LOWEST ELEVATION FOR SURCHARGE EVACUATION.  RULE CURVE
C       OR RULE CURVE PLUS AN ADDITION ARE DEFINED BY ADDING ADDITION
C       TO -999.0.  FOR EXAMPLE, RULE CURVE PLUS AN ADDITION OF -1.0
C       WOULD BE DEFINED AS -1000.0.
C     QTARG2 -- SPECIFIED MINIMUM OUTFLOW FOR EVACUATION PROCEDURE IN
C       THIS SUBROUTINE.
C
C ALL OTHER VARIABLES ARE DEFINED IN THE THE PARENT SUBROUTINE NDUC26.
C  THIS SUBROUTINE (EVAB26) WILL COMPUTE OUTFLOW (QQO2), STORAGE (SS2),
C AND ELEVATION (ELRES2) AT THE END OF THE TIME STEP AND WILL SET AN
C INDICATOR (IOUT) FOR NEED TO CONTINUE OR NOT CONTINUE EVACUATION.
C
      INCLUDE 'common/fdbug'
      INCLUDE 'common/resv26'
      INCLUDE 'common/srcg26'
      INCLUDE 'common/evak26'
C
      DIMENSION STOR(1),ELEV(1)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_res/RCS/beta26.f,v $
     . $',                                                             '
     .$Id: beta26.f,v 1.1 1996/07/12 14:06:44 dws Exp $
     . $' /
C    ===================================================================
C
C
C SET IOUT TO 0 FOR CONTINUED USE OF EVACUATION PROCEDURE UNLESS IOUT IS
C LATER CHANGED TO 1.  COMPUTE OUTFLOW (QQO2) AT END OF TIME STEP.
C
   50 IOUT=0
      IX=HPREVQ
      IF(IX.EQ.-9998) GO TO 55
      RULEX=RULEL1+(RULEL2-RULEL1)*SFRPD
      HPREVX = HPREVQ
      IF(HPREVX.LT.-900.0) HPREVX=RULELX+HPREVQ+999.0 
      IF(ELRES2.LE.HPREVX .OR. QIMSUR.LE.QQO2) GO TO 55
      QQO2=QQO1
      SS2=SS1+QQIM-(QQO1+QQO2)*0.5*FRPD
      CALL NTER26(SS2,ELRES2,STOR,ELEV,NSE,IFLAG,NTERP,IBUG)
C
C  FALELB = HEVACEND
 55   FALELX=FALELB
      IF(FALELX.LT.-900.0) HALELX=RULELX+FALELB+999.0 
      IF(ELRES2.LE.FALELX) GO TO 70
C
C  QTARG2 = QTARGET2
      IF(QQO2.GT.QTARG2) GO TO 80
      QQO2=QTARG2
      SS2=SS1+QQIM-(QQO1+QQO2)*0.5*FRPD
      CALL NTER26(SS2,ELRES2,STOR,ELEV,NSE,IFLAG,NTERP,IBUG)
   70 IF(ELRES2.GT.FALELX) GO TO 80
      IOUT=1
C
   80 CONTINUE
      RETURN
      END





