C MODULE SSTATS
C-----------------------------------------------------------------------
C
C  ROUTINE TO PRINT DATA BASE STATUS INFORMATION.
C
      SUBROUTINE SSTATS (LARRAY,ARRAY,NFLD,ISTAT)
C
      CHARACTER*4 DEGMIN,XNWPAG,XPNTWK,XPORDR
      CHARACTER*8 XFLSTRNG2
      CHARACTER*8 STAID
      CHARACTER*8 SEQNUM/' '/
      PARAMETER (MOPTN=20)
      CHARACTER*8 OPTN(MOPTN)
     *   /'LEVEL   ','ALL     ','SASM    ','GOES    ',
     *    '        ','PPDB    ','PPPDB   ','PDB     ',
     *    'NEWPAGE ','DEGMIN  ','PRNTNTWK','PRNTORDR',
     *    'FILECHK ','PPD     ','PPP     ','PRD     ',
     *    'UPRM    ','STATION ','STA     ','        '/
      CHARACTER*12 COMP/'COMPLETE'/
      CHARACTER*12 INCOMP/'INCOMPLETE'/
      CHARACTER*12 STMAP,STMAT
      CHARACTER*20 STRNG/' '/,STRNG2/' '/
C
      DIMENSION ARRAY(LARRAY)
C
      INCLUDE 'uiox'
      INCLUDE 'upagex'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'scommon/sugnlx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/ppinit_misc/RCS/sstats.f,v $
     . $',                                                             '
     .$Id: sstats.f,v 1.4 2001/06/13 13:51:45 dws Exp $
     . $' /
C    ===================================================================
C
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,*) 'ENTER SSTATS'
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('STAT')
C
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,*) 'NFLD=',NFLD
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      ISTAT=0
C
      LSTRNG=LEN(STRNG)/4
      LSTRNG2=LEN(STRNG2)/4
C
      IALL=0
      NUMOPT=0
      IPRINT=1
      ILPFND=0
      IRPFND=0
      NUMERR=0
      NUMWRN=0
      NPCFLD=NFLD
      IENDIN=0
      ISTRT=1
C
C  SET DEFAULT OPTIONS
      LEVEL=0
      XNWPAG='YES'
      NEWPAG=0
      DEGMIN='NO'
      IPNTWK=1
      IPORDR=1
      IFLCHK=0
C
C  PRINT CARD
      CALL SUPCRD
C
C  PRINT HEADING
      WRITE (LP,380)
      CALL SULINE (LP,2)
C
C  CHECK WHICH DATA BASES ALLOCATED
      IDUPRM=1
      IDPPD=1
      IDPPP=1
      IDPRD=1
      IDSASM=1
      IDGOES=1
      INDMSG=-2
      CALL SUDALC (0,IDUPRM,0,IDPPD,IDPPP,IDPRD,0,IDSASM,IDGOES,0,
     *   INDMSG,IERR)
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  CHECK FIELDS FOR STATUS OPTIONS
C
10    CALL UFIELD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,
     *   LSTRNG,STRNG,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
      IF (NFLD.EQ.-1) THEN
         IENDIN=1
         GO TO 350
         ENDIF
      IF (LDEBUG.GT.0) THEN
         CALL UPRFLD (NFLD,ISTRT,LENGTH,ITYPE,NREP,INTEGR,REAL,
     *      LSTRNG,STRNG,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,IERR)
         ENDIF
      IF (IERR.EQ.1) THEN
         IF (LDEBUG.GT.0) THEN
            WRITE (IOSDBG,430) NFLD
            CALL SULINE (IOSDBG,1)
            ENDIF
         GO TO 10
         ENDIF
C
C  CHECK FOR COMMAND
      IF (LATSGN.GT.0) THEN
         IENDIN=1
         GO TO 350
         ENDIF
C
C  CHECK FOR PAIRED PARENTHESES
      CALL SUPFND (ILPFND,IRPFND,NPIFLD,NPCFLD)
C
C  CHECK FOR PARENTHESES IN FIELD
      IF (LLPAR.GT.0) CALL UFPACK (LSTRNG2,STRNG2,ISTRT,1,LLPAR-1,IERR)
      IF (LLPAR.EQ.0) CALL UFPACK (LSTRNG2,STRNG2,ISTRT,1,LENGTH,IERR)
C
      IF (NFLD.EQ.1) CALL SUPCRD
C
C  CHECK FOR OPTION
      DO 20 IOPTN=1,MOPTN
         NWORDS=2
         CALL SUCOMP (NWORDS,STRNG2,OPTN(IOPTN),IMATCH)
         IF (IMATCH.EQ.1) GO TO 30
20       CONTINUE
C
C  INVALID OPTION
      WRITE (LP,410) STRNG2
      CALL SUERRS (LP,2,NUMERR)
      IF (STRNG2.EQ.' ') THEN
         IENDIN=1
         GO TO 360
         ENDIF
      GO TO 10
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
30    GO TO (50,80,180,180,180,180,180,180,
     *       90,100,120,140,160,180,180,180,
     *       180,310,310,40),IOPTN
40       WRITE (LP,420) IOPTN
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
C
C  LEVEL OPTION
50    IF (LLPAR.EQ.0) THEN
         INTEGR=0
         WRITE (LP,480) OPTN(IOPTN),INTEGR
         CALL SUWRNS (LP,2,NUMWRN)
         ENDIF
      IF (LRPAR.GT.0) IRPFND=1
      IF (LRPAR.EQ.0) THEN
         WRITE (LP,400) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
         ENDIF
      CALL UFINFX (INTEGR,ISTRT,LLPAR+1,LRPAR-1,IERR)
      MINVAL=0
      MAXVAL=3
      IF (INTEGR.GE.MINVAL.AND.INTEGR.LE.MAXVAL) GO TO 70
         WRITE (LP,490) INTEGR,MINVAL,MAXVAL
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
70    LEVEL=INTEGR
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,470) OPTN(IOPTN),LEVEL
         CALL SULINE (IOSDBG,1)
         ENDIF
      IPRINT=1
      GO TO 10
C
C  ALL OPTION
80    IALL=1
      GO TO 10
C
C  NEWPAGE OPTION
90    NEWPAG=-1
      CALL SUNEWP (NFLD,ISTRT,STRNG2,LSTRNG2,LLPAR,LRPAR,LENGTH,IRPFND,
     *   OPTN(IOPTN),NUMERR,NUMWRN,NEWPAG,IERR)
      XNWPAG=STRNG2
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,460) OPTN(IOPTN),XNWPAG
         CALL SULINE (IOSDBG,1)
         ENDIF
      IPRINT=1
      GO TO 10
C
C  DEGMIN OPTION
100   IF (LLPAR.EQ.0) THEN
         STRNG2='YES'
         WRITE (LP,440) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUWRNS (LP,2,NUMWRN)
         GO TO 110
         ENDIF
      IF (LRPAR.GT.0) IRPFND=1
      IF (LRPAR.EQ.0) THEN
         WRITE (LP,400) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
         ENDIF
      CALL UFPACK (LSTRNG2,STRNG2,ISTRT,LLPAR+1,LRPAR-1,IERR)
      IF (STRNG2.EQ.'YES'.OR.
     *    STRNG2.EQ.'NO') GO TO 110
         WRITE (LP,450) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
110   DEGMIN=STRNG2
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,460) OPTN(IOPTN),DEGMIN
         CALL SULINE (IOSDBG,1)
         ENDIF
      GO TO 10
C
C  PRNTNTWK OPTION
120   IF (LLPAR.EQ.0) THEN
         STRNG2='YES'
         WRITE (LP,440) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUWRNS (LP,2,NUMWRN)
         GO TO 130
         ENDIF
      IF (LRPAR.GT.0) IRPFND=1
      IF (LRPAR.EQ.0) THEN
         WRITE (LP,400) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
         ENDIF
      CALL UFPACK (LSTRNG2,STRNG2,ISTRT,LLPAR+1,LRPAR-1,IERR)
      IF (STRNG2.EQ.'YES'.OR.
     *    STRNG2.EQ.'NO') GO TO 130
         WRITE (LP,450) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
130   IF (STRNG2.EQ.'YES') IPNTWK=1
      IF (STRNG2.EQ.'NO') IPNTWK=0
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,470) OPTN(IOPTN),IPNTWK
         CALL SULINE (IOSDBG,1)
         ENDIF
      GO TO 10
C
C  PRNTORDR OPTION
140   IF (LLPAR.EQ.0) THEN
         STRNG2='YES'
         WRITE (LP,440) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUWRNS (LP,2,NUMWRN)
         GO TO 150
         ENDIF
      IF (LRPAR.GT.0) IRPFND=1
      IF (LRPAR.EQ.0) THEN
         WRITE (LP,400) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
         ENDIF
      CALL UFPACK (LSTRNG2,STRNG2,ISTRT,LLPAR+1,LRPAR-1,IERR)
      IF (STRNG2.EQ.'YES'.OR.
     *    STRNG2.EQ.'NO') GO TO 150
         WRITE (LP,450) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
150   IF (STRNG2.EQ.'YES') IPORDR=1
      IF (STRNG2.EQ.'NO') IPORDR=0
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,470) OPTN(IOPTN),IPORDR
         CALL SULINE (IOSDBG,1)
         ENDIF
      GO TO 10
C
C  FILECHK OPTION
160   IF (LLPAR.EQ.0) THEN
         STRNG2='YES'
         WRITE (LP,440) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUWRNS (LP,2,NUMWRN)
         GO TO 170
         ENDIF
      IF (LRPAR.GT.0) IRPFND=1
      IF (LRPAR.EQ.0) THEN
         WRITE (LP,400) NFLD
         CALL SULINE (LP,2)
         LRPAR=LENGTH+1
         ENDIF
      CALL UFPACK (LSTRNG2,STRNG2,ISTRT,LLPAR+1,LRPAR-1,IERR)
      IF (STRNG2.EQ.'YES'.OR.
     *    STRNG2.EQ.'NO'.OR.
     *    STRNG2.EQ.'RESET') GO TO 170
         WRITE (LP,450) OPTN(IOPTN),STRNG2(1:LENSTR(STRNG2))
         CALL SUERRS (LP,2,NUMERR)
         GO TO 10
170   IF (STRNG2.EQ.'YES') IFLCHK=1
      IF (STRNG2.EQ.'NO') IFLCHK=0
      IF (STRNG2.EQ.'RESET') IFLCHK=-1
      IF (LDEBUG.GT.0) THEN
         WRITE (IOSDBG,470) OPTN(IOPTN),IFLCHK
         CALL SULINE (IOSDBG,1)
         ENDIF
      GO TO 10
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
180   NUMOPT=NUMOPT+1
C
C  PRINT OPTIONS IN EFFECT
      IF (IPRINT.EQ.0) GO TO 230
         XFLSTRNG2=' '
         IF (IFLCHK.EQ.0) XFLSTRNG2='NO'
         IF (IFLCHK.EQ.1) XFLSTRNG2='YES'
         IF (IFLCHK.EQ.-1) XFLSTRNG2='RESET'
         XPNTWK='YES'
         IF (IPNTWK.EQ.0) XPNTWK='NO'
         XPORDR='YES'
         IF (IPORDR.EQ.0) XPORDR='NO'
         WRITE (LP,520) DEGMIN,XFLSTRNG2,LEVEL,XNWPAG,XPNTWK,XPORDR
         CALL SULINE (LP,2)
         IPRINT=0
C
      IF (IPNTWK.EQ.0.AND.IPORDR.EQ.0) GO TO 230
C
C  READ UGNL PARAMETERS
      IPRERR=0
      INCLUDE 'scommon/callsrugnl'
      IF (IERR.EQ.0) GO TO 190
         WRITE (LP,530)
         CALL SULINE (LP,2)
         GO TO 200
C
C  PRINT MAP AND MAT COMPLETE INDICATORS
190   CALL UREPET ('?',STMAP,LEN(STMAP))
      IF (ICUGNL(1).EQ.0) CALL SUBSTR (COMP,1,12,STMAP,1)
      IF (ICUGNL(1).EQ.1) CALL SUBSTR (INCOMP,1,12,STMAP,1)
      IF (ICUGNL(1).EQ.2) CALL SUBSTR (INCOMP,1,12,STMAP,1)
      CALL UREPET ('?',STMAT,LEN(STMAT))
      IF (ICUGNL(2).EQ.0) CALL SUBSTR (COMP,1,12,STMAT,1)
      IF (ICUGNL(2).EQ.1) CALL SUBSTR (INCOMP,1,12,STMAT,1)
      WRITE (LP,540) STMAP,STMAT
      CALL SULINE (LP,2)
C
200   IF (IPNTWK.EQ.0) GO TO 210
C
C  PRINT STATION NETWORK PARAMETERS
      IFLD=0
      CALL SMNTWK (LARRAY,ARRAY,LEVEL,IFLD,IERR)
C
210   IF (IPORDR.EQ.0) GO TO 230
C
C  PRINT COMPUTATIONAL ORDER PARAMETERS
      INCLUDE 'scommon/callsrordr'
      IF (IERR.EQ.0) GO TO 220
         IF (IERR.EQ.2) THEN
            WRITE (LP,550)
            CALL SULINE (LP,2)
            ENDIF
         IF (IERR.NE.2) THEN
            WRITE (LP,560)
            CALL SUWRNS (LP,2,NUMWRN)
            ENDIF
         GO TO 230
220   IPRNT=1
      INCLUDE 'scommon/callspordr'
C
230   IF (IALL.EQ.-1) GO TO 250
C
      GO TO (240,240,260,270,240,280,290,300,
     *       240,240,240,240,240,280,290,300,
     *       250,240,240,240),IOPTN
240      WRITE (LP,570) IOPTN
         CALL SUERRS (LP,2,NUMERR)
         IF (IENDIN.EQ.1) GO TO 360
         GO TO 10
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  USER PARAMETER FILE
C
250   IF (IDUPRM.EQ.0) GO TO 260
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=3
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      CALL SSUPRM (IERR)
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      IF (IABS(IALL).EQ.1) GO TO 260
      GO TO 340
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  SASM CONTROL FILE
C
260   IF (IDSASM.EQ.0) GO TO 270
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=3
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      STAID=' '
      CALL SSSASM (PUSRID,LARRAY,ARRAY,LEVEL,DEGMIN,STAID,IERR)
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      IF (IABS(IALL).EQ.1) GO TO 270
      GO TO 340
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  GOES CONTROL FILE
C
270   IF (IDGOES.EQ.0) GO TO 280
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=4
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      STAID=' '
      CALL SSGOES (PUSRID,LARRAY,ARRAY,LEVEL,STAID,IERR)
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      IF (IABS(IALL).EQ.1) GO TO 280
      GO TO 340
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  PREPROCESSOR DATA BASE
C
280   IF (IDPPD.EQ.0) GO TO 290
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=6
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      CALL SSPPD (LARRAY,ARRAY,LEVEL,IFLCHK,IERR)
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      IF (IABS(IALL).EQ.1) GO TO 290
      GO TO 340
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  PREPROCESSOR PARAMETRIC DATA BASE
C
290   IF (IDPPP.EQ.0) GO TO 300
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=7
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      IF (LATSGN.EQ.0) THEN
         NFLD2=NFLD
         ELSE
            NFLD2=-1
         ENDIF
      CALL SSPPP (LARRAY,ARRAY,LEVEL,NFLD2,IFLCHK,IERR)
      IF (LATSGN.EQ.0) NFLD=NFLD2
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      IF (IABS(IALL).EQ.1) GO TO 300
C
      GO TO 320
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  PROCESSED DATA BASE
C
300   IF (IDPRD.EQ.0) GO TO 330
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=8
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATUS
      IF (LATSGN.EQ.0) THEN
         NFLD2=NFLD
         ELSE
            NFLD2=-1
         ENDIF
      CALL SSPRD (LARRAY,ARRAY,LEVEL,NFLD2,IFLCHK,IERR)
      IF (LATSGN.EQ.0) NFLD=NFLD2
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      GO TO 320
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  STATION STATUS
C
310   NUMOPT=NUMOPT+1
C
      IF (NEWPAG.EQ.1) CALL SUPAGE
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  WRITE TO PROGRAM LOG
      IF (IALL.EQ.-1) IOPTN=8
      NPAGE=0
      ISTART=1
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
C  PRINT STATION STATUS
      CALL SSSTA (LARRAY,ARRAY,NFLD,IERR)
C
C  WRITE TO PROGRAM LOG
      ISTART=0
      CALL SUWLOG ('OPTN',OPTN(IOPTN),SEQNUM,NPAGE,ISTART,IERR)
C
      GO TO 320
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
C  SET INDICATOR TO REREAD CURRENT FIELD
320   ISTRT=-1
C
330   IF (NEWPAG.EQ.0) THEN
         WRITE (LP,500)
         CALL SULINE (LP,2)
         ENDIF
C
      NPCFLD=NFLD
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
340   IF (NFLD.EQ.-1.OR.IENDIN.EQ.1) GO TO 360
      IF (NUMOPT.EQ.0.AND.IALL.EQ.1) GO TO 360
      IALL=0
      IF (IOPTN.EQ.0.OR.IOPTN.GT.MOPTN) GO TO 10
      GO TO 10
C
C  CHECK NUMBER OF KEYWORDS FOUND
350   IF (NUMOPT.EQ.0) THEN
C     NO STATUS OPTIONS FOUND
         WRITE (LP,510)
         CALL SULINE (LP,2)
         IALL=-1
         GO TO 180
         ENDIF
C
C  CHECK NUMBER OF ERRORS
360   IF (NUMERR.GT.0) THEN
         WRITE (LP,580) NUMERR
         CALL SULINE (LP,2)
         ENDIF
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,*) 'EXIT SSTATS'
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
380   FORMAT ('0*--> NWSRFS FORECAST SYSTEM DATA BASE STATUS')
400   FORMAT ('0*** NOTE - RIGHT PARENTHESIS ASSUMED IN FIELD ',I2,
     *   '.')
410   FORMAT ('0*** ERROR - INVALID STATUS OPTION : ',A)
420   FORMAT ('0*** ERROR - PROCESSING STATUS OPTION NUMBER ',I2,'.')
430   FORMAT (' NULL FIELD FOUND IN FIELD ',I2)
440   FORMAT ('0*** WARNING - NO LEFT PARENTHESIS FOUND. ',A,
     *   ' OPTION SET TO ',A,'.')
450   FORMAT ('0*** ERROR - INVALID ',A,' OPTION : ',A)
460   FORMAT (' ',A,' OPTION SET TO ',A)
470   FORMAT (' ',A,' OPTION SET TO ',I3)
480   FORMAT ('0*** WARNING - NO LEFT PARENTHESIS FOUND. ',A,
     *   ' OPTION SET TO ',I2,'.')
490   FORMAT ('0*** ERROR - LEVEL VALUE (',I3,') MUST BE GREATER ',
     *   'THAN ',I1,' AND LESS THAN OR EQUAL TO ',I1,'.')
500   FORMAT ('0',132('#'))
510   FORMAT ('0*** NOTE - NO DATA BASE KEYWORD (UPRM, SASM, GOES,',
     *   ' PPD, PPP OR PRD) WAS FOUND. ''ALL'' IS ASSUMED.')
520   FORMAT ('0STATUS OPTIONS IN EFFECT :  ',
     *   'DEGMIN=',A,3X,
     *   'FILECHK=',A,3X,
     *   'LEVEL=',I1,3X,
     *   'NEWPAGE=',A,3X,
     *   'PRNTNTWK=',A,3X,
     *   'PRNTORDR=',A,3X,
     *   ' ')
530   FORMAT ('0*** NOTE - UGNL PARAMETERS ARE NOT DEFINED.')
540   FORMAT ('0MAP COMPLETE INDICATOR = ',A,5X,
     *   'MAT COMPLETE INDICATOR = ',A)
550   FORMAT ('0*** NOTE - ORDR PARAMETER NOT FOUND.')
560   FORMAT ('0*** WARNING - ORDR PARAMETERS NOT SUCCESSFULLY READ.')
570   FORMAT ('0*** ERROR - PROCESSING OPTION NUMBER ',I2)
580   FORMAT ('0*** NOTE - ',I3,' ERRORS ENCOUNTERED BY STATUS ',
     *   'COMMAND.')
C
      END
