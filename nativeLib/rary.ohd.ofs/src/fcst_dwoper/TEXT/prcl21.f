C MEMBER PRCL21
C  (from old member FCPRCL21)
C
      SUBROUTINE PRCL21(NB,NRT1,NT,X,STT,LOSTT,NJUN,GZ,STTNAM)
C
C           THIS SUBROUTINE CONVERTS OBSERVED STAGES TO WATER SURFACE
C           ELEVATIONS REFERENCED TO MEAN SEA LEVEL.
C
C           THIS SUBROUTINE WAS WRITTEN ORIGINALLY BY:
C           DR. DANNY FREAD   HRL   APRIL 1978
C
C           THIS SUBROUTINE WAS MODIFIED TO MEET VER. NO. 5 STANDARDS
C           OF THE NWSRFS BY:
C           JANICE LEWIS      HRL   NOVEMBER,1982     VERSION NO. 1
C
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
      COMMON/M121/N,NU,NS1,JN,JJ,KIT,G,DT,TT,TIMF,F1,GZN,NYQD
C
      DIMENSION NB(1),NRT1(1),NT(1),X(1),STT(1),NJUN(1),STTNAM(3,1)
      DIMENSION GZ(1),LOSTT(1),SNAME(2)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcst_dwoper/RCS/prcl21.f,v $
     . $',                                                             '
     .$Id: prcl21.f,v 1.1 1995/09/17 18:56:13 dws Exp $
     . $' /
C    ===================================================================
C
C
      DATA SNAME/4HPRCL,4H21  /
      DATA DUMM/4HDUMM/
C
      CALL FPRBUG(SNAME,1,21,IBUG)
C
C          CHECK TO SEE IF GAGING STATIONS ARE NEEDED
C
      LS1=LCAT21(1,1,NRT1)-1
      LK1=LCAT21(1,1,NRT1)-1
      NK1=LCAT21(1,1,NB)-1
C
      IF(JN.EQ.1) GO TO 1300
C
      DO 1295 J=2,JN
      LKJ=LCAT21(1,J,NRT1)-1
      NRT=NRT1(J)
      LSTT=LOSTT(NRT+LKJ)-1
      LSM=LCAT21(NRT,J,NRT1)
C
C          IS THERE A GAGING STATION AT THE DOWNSTREAM END OF TRIB?
C
      IF(STTNAM(1,LSM).NE.DUMM) GO TO 1260
      IJ=NJUN(J)
      N1=NRT1(1)
      DO 1250 K=1,N1
      IF(NT(K+LK1).GE.IJ) GO TO 1255
 1250 CONTINUE
C
 1255 KK=K-1
      LOK=LOSTT(K+LK1)
      LOKK=LOSTT(KK+LK1)
      IU=NT(KK+LK1)
      ID=NT(K+LK1)
      XU=X(IU+NK1)
      XD=X(ID+NK1)
      XJ=0.5*(X(IJ+NK1)+X(IJ+1+NK1))
      FAC=(XJ-XU)/(XD-XU)
C
      DO 1257 L=1,NU
 1257 STT(LSTT+L)=STT(LOKK+L)+GZ(KK+LK1)+FAC*(STT(LOK+L)+GZ(K+LK1)-
     1 STT(LOKK+L)-GZ(KK+LK1))
C
      WRITE(IODBUG,8000) J
 8000 FORMAT(1H0,30X,56HEXTRA GAGING STATION AT THE DOWNSTREAM END OF RI
     1VER NO. ,I3)
      WRITE(IODBUG,8010) (STT(LSTT+L),L=1,NU)
 8010 FORMAT(1H ,10X,10F10.2)
C
      GO TO 1295
 1260 CONTINUE
C
C
C       IS THERE A GAGING STATION AT THE CONFLUENCE?
C
      IJ=NJUN(J)
      NRT=NRT1(1)
      IF(STTNAM(1,LS1+IJ).NE.DUMM) GO TO 1295
      LSTT=LOSTT(LK1+IJ)-1
      N1=NRT1(J)
      LTT=LOSTT(LKJ+N1)
C
      DO 1270 L=1,NU
 1270 STT(LSTT+L)=STT(LTT+L)
C
      WRITE(IODBUG,8030) J
 8030 FORMAT(1H0,30X,52HEXTRA GAGING STATION AT THE CONFLUENCE OF RIVER
     1NO. ,I3)
      WRITE(IODBUG,8010) (STT(LSTT+L),L=1,NU)
C
 1295 CONTINUE
 1300 CONTINUE
C
      IF(ITRACE.EQ.1) WRITE(IODBUG,9000) SNAME
 9000 FORMAT(1H0,2H**,1X,2A4,8H EXITED.)
      RETURN
      END
