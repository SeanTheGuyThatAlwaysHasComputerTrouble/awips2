C MEMBER FLCMPL
C  (from old member FCFLCMPL)
C
      SUBROUTINE FLCMPL(IDT,LCM)
C   THIS SUBROUTINE FINDS THE LARGEST COMMON MULTIPLE
C   OF TWO TIMES, AND CHECKS THAT IT IS A VALID TIME INTERVAL.
C     IDT - NEW TIME INTERVAL
C     LCM - LARGEST COMMON MULTIPLE
C
C   THIS SUBROUTINE WAS INITIALLY PROGRAMMED BY
C   GERALD N. DAY - HRL  MAY 1980
C
      DIMENSION ITIME(8)
      COMMON/FDBUG/IODBUG,ITRACE,IDBALL,NDEBUG,IDEBUG(20)
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/fcinit_util/RCS/flcmpl.f,v $
     . $',                                                             '
     .$Id: flcmpl.f,v 1.1 1995/09/17 18:54:40 dws Exp $
     . $' /
C    ===================================================================
C
      DATA ITIME/1,2,3,4,6,8,12,24/
      IF(ITRACE.GE.1) WRITE(IODBUG,900)
C   PLACE THE SMALLER NUMBER IN IDTA AND THE LARGER NUMBER
C   IN IDTB.
      IF(LCM.LT.IDT) GO TO 5
      IDTA=IDT
      IDTB=LCM
      GO TO 8
    5 IDTA=LCM
      IDTB=IDT
C
C   CHECK IF IDTA IS THE LARGEST COMMON MULTIPLE.
C
    8 IF(IDTB.EQ.(IDTA*(IDTB/IDTA))) GO TO 100
      IMPL=2
C
C   CHECK IF IMPL IS A MULTIPLE OF IDTA.
   10 IF(IDTA.NE.(IMPL*(IDTA/IMPL))) GO TO 50
C
C   CALCULATE A TRIAL LARGEST COMMON MULTIPLE.
C
      IDTTRY=IDTA/IMPL
C
C   CHECK IF THE TRIAL VALUE IS A VALID TIME INTERVAL.
C
      DO 20 I=1,8
      IF(IDTTRY.EQ.ITIME(I)) GO TO 30
   20 CONTINUE
      GO TO 50
C
C   CHECK IF IDTTRY IS THE LARGEST COMMON MULTIPLE.
C
   30 IF(IDTB.EQ.(IDTTRY*(IDTB/IDTTRY))) GO TO 90
C
C   INCREMENT THE DIVISOR.
C
   50 IMPL=IMPL+1
      GO TO 10
   90 LCM=IDTTRY
      GO TO 200
  100 LCM=IDTA
  200 IF(ITRACE.GE.1) WRITE(IODBUG,910)
      RETURN
  900 FORMAT(1H0,17H** FLCMPL ENTERED)
  910 FORMAT(1H0,16H** FLCMPL EXITED)
      END
