C MEMBER OPRINT
C  (from old member OPRINT)
C
      SUBROUTINE OPRINT(P,MP,C,MC,POLD,COLD,ILOCOA,MILOC,OA,MOA,
     *NPARM,T,MT,A,MA,NUGPRT)
C.......................................
C     THIS SUBROUTINE PRINTS ALL THE OPTIMIZED PARAMETER VALUES AND ANY
C     INITIAL CARRYOVER VALUES THAT MAY HAVE CHANGED AS A RESULT OF
C     OPTIMIZATION.
C.......................................
C     SUBROUTINE INITIALLY WRITTEN BY
C            LARRY BRAZIL - HRL   MAY 1981   VERSION 1
C.......................................
      DIMENSION P(MP),C(MC),POLD(MP),COLD(MC),OPID(2),ILOCOA(MILOC)
      DIMENSION OA(MOA),OPNAME(2),OTHNAM(2),T(MT),A(MA)
C
      INTEGER T
C
      INCLUDE 'common/ionum'
      INCLUDE 'common/sysbug'
      INCLUDE 'common/fdbug'
      INCLUDE 'ocommon/opschm'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/calb/src/opt3_shared/RCS/oprint.f,v $
     . $',                                                             '
     .$Id: oprint.f,v 1.3 2002/02/11 14:00:11 michaelo Exp $
     . $' /
C    ===================================================================
C
C
      DATA ETL/4HETLO/,ETH/4HETHI/
C
      IF(ITRACE.GE.1) WRITE(IODBUG,1000)
 1000 FORMAT(1H0,17H** OPRINT ENTERED)
C
C     PRINT PARAMETER INFORMATION.
C
      WRITE(IPR,900) NNBEST
  900 FORMAT(1H1,45HTHE FOLLOWING PARAMETERS HAVE BEEN OPTIMIZED:/6X,34H
     *(OPTIMIZED VALUES OBTAINED ON RUN ,I5,1H))
C
      WRITE(IPR,902)
  902 FORMAT(89X,40HOTHER OPERATIONS AFFECTED BY THIS CHANGE,//37X,
     *20HINITIAL    OPTIMIZED,47X,7HINITIAL,10X,9HOPTIMIZED,/4X,
     *9HOPERATION,4X,4HNAME,4X,9HPARAMETER,4X,5HVALUE,7X,5HVALUE,34X,
     *4HNAME,12X,5HVALUE,13X,5HVALUE)
C
      WRITE(IPR,904)
  904 FORMAT(4X,9(1H-),4X,4(1H-),4X,9(1H-),3X,7(1H-),4X,9(1H-),32X,
     *4(1H-),11X,7(1H-),10X,9(1H-))
C
  100 DO 300 IJ=1,NPARM
      IET=0
C     DETERMINE OPERATION ID
      NUMOP=OA(ILOCOA(IJ)+1)
      CALL FOPCDX(OPID,NUMOP)
  110 CONTINUE
      ICUR=ILOCOA(IJ)
      ICURR=OA(ICUR+4)
cfan      OPNAME(1)=P(OA(ICUR)-5)
cfan      OPNAME(2)=P(OA(ICUR)-4)
cfan
      IIII1=OA(ICUR)-5
      IIII2=OA(ICUR)-4
      OPNAME(1)=P(IIII1)
      OPNAME(2)=P(IIII2)
cfan
      INUM=OA(ICUR+9)
      NOTHER=OA(ICUR+8)
C
C     SET INITIAL PARAMETER VALUE.
      PINIT=POLD(ICURR)
      IF(NUMOP.EQ.2) PINIT=1.0
      IF(NUMOP.EQ.1.OR.NUMOP.EQ.36) GO TO 117
      GO TO 118
  117 IF((OA(ICUR+2).NE.ETL.AND.OA(ICUR+2).NE.ETH)) GO TO 118
      IET=1
      PINIT=1.0
  118 CONTINUE
      WRITE(IPR,910) IJ,OPID,OPNAME,OA(ICUR+2),OA(ICUR+3),PINIT,A(IJ)
  910 FORMAT(1H0,I2,2X,2A4,2X,2A4,3X,2A4,2X,F9.3,3X,F9.3)
C
C     PRINT UNIT GRAPH VALUES.
C
      IF(NUMOP.NE.2) GO TO 120
      NUGPRT=NUGPRT+1
      LOCP=1
      CALL FSERCH(2,OPNAM,LOCP,P,MP)
C
      LMETR=P(LOCP+22)
      IF(NUGPRT.EQ.1) CALL UGPRNT(INUM,POLD(ICURR),P(ICURR),MP,LMETR)
C
C     PRINT ET CURVE VALUES.
C
  120 IF(IET.EQ.1) CALL ETPRNT(POLD(ICURR),P(ICURR),MP)
C
C     CHECK TO SEE IF OTHER OPERATIONS ARE AFFECTED.
C
      IF(NOTHER.EQ.0) GO TO 300
      DO 200 N=1,NOTHER
cfan      OTHNAM(1)=P(OA(ICUR+13+(N-1)*4)-5)
cfan      OTHNAM(2)=P(OA(ICUR+13+(N-1)*4)-4)
cfan
      IIII3=OA(ICUR+13+(N-1)*4)-5
      IIII4=OA(ICUR+13+(N-1)*4)-4
      OTHNAM(1)=P(IIII3)
      OTHNAM(2)=P(IIII4)
cfan
      INLOC=OA(ICUR+14+(N-1)*4)
      INUMM=OA(ICUR+15+(N-1)*4)
      PINITT=POLD(INLOC)
      IF(NUMOP.EQ.2) PINITT=1.0
      IF(IET.EQ.1) PINITT=1.0
      POPT=P(INLOC)
      IF(NUMOP.EQ.2.OR.IET.EQ.1) POPT=A(IJ)
C
      WRITE(IPR,920) OTHNAM,PINITT,POPT
  920 FORMAT(87X,2A4,7X,F8.3,10X,F8.3)
C
C     PRINT UNIT GRAPH VALUES.
C
      IF(NUGPRT.EQ.1) CALL UGPRNT(INUMM,POLD(INLOC),P(INLOC),MP,LMETR)
C
C     PRINT ET CURVE VALUES.
C
      IF(IET.EQ.1) CALL ETPRNT(POLD(INLOC),P(INLOC),MP)
C
  200 CONTINUE
  300 CONTINUE
C
C     PRINT INITIAL CARRYOVER VALUES THAT HAVE CHANGED.
C
      IFLAG=0
      NEXTT=1
  310 CONTINUE
      IT=NEXTT
      ITT=T(IT)
      IF(ITT.EQ.-1) GO TO 799
      NEXTT=T(IT+1)
      IC=T(IT+3)
      IF (ITT.EQ.1) GO TO 315
      IF (ITT.EQ.2) GO TO 315
      IF (ITT.EQ.19) GO TO 315
      IF (ITT.EQ.24) GO TO 315
      IF (ITT.EQ.36) GO TO 315
      GO TO 310
  315 NEXTC=C(IC-4)
      NUMC=NEXTC-IC
C
      DO 320 I=1,NUMC
      IF(C(IC-1+I).NE.COLD(IC-1+I)) GO TO 340
  320 CONTINUE
      GO TO 310
  340 CONTINUE
      IF(IFLAG.EQ.0) WRITE(IPR,940)
  940 FORMAT(1H1,74HINITIAL CARRYOVER VALUES HAVE BEEN CHANGED FOR THE F
     *OLLOWING OPERATION(S):)
C
      IFLAG=1
      IP=T(IT+2)
      NUMOP=P(IP-7)
      CALL FOPCDX(OPID,NUMOP)
      OPNAME(1)=P(IP-5)
      OPNAME(2)=P(IP-4)
      WRITE(IPR,941)
  941 FORMAT(1H0)
      WRITE(IPR,942) OPID,OPNAME
  942 FORMAT(1H0,21HOLD CARRYOVER FOR ID(,2A4,8H)  NAME(,2A4,1H))
      IF(NUMOP.EQ.1) CALL PRC1(POLD(IP),COLD(IC))
      IF(NUMOP.EQ.2) CALL PRC2(POLD(IP),COLD(IC))
      IF(NUMOP.EQ.19) CALL PRC19(POLD(IP),COLD(IC))
      IF(NUMOP.EQ.24) CALL PRC24(POLD(IP),COLD(IC))
      IF(NUMOP.EQ.36) CALL PRC36(POLD(IP),COLD(IC))
C
      WRITE(IPR,944)
  944 FORMAT(1H0,13HNEW CARRYOVER)
      IF(NUMOP.EQ.1) CALL PRC1(P(IP),C(IC))
      IF(NUMOP.EQ.2) CALL PRC2(P(IP),C(IC))
      IF(NUMOP.EQ.19) CALL PRC19(P(IP),C(IC))
      IF(NUMOP.EQ.24) CALL PRC24(P(IP),C(IC))
      IF(NUMOP.EQ.36) CALL PRC36(P(IP),C(IC))
C
      GO TO 310
C
  799 CONTINUE
C
      IF(ITRACE.GE.1) WRITE(IODBUG,1002)
 1002 FORMAT(1H0,14H** EXIT OPRINT)
C
      RETURN
      END
