C MEMBER LREAD
C
C***********************************************************************
C
      SUBROUTINE LREAD(STAID,TIMEOB,SLAT,SLON,NDUMST,JJ2,J,M1,OBT,
     * ISTRT,NFLD,ISTAT,IERR)
      DIMENSION UCHAR(2)
      DIMENSION STAID(7,M1),TIMEOB(M1,1),SLAT(3000),SLON(3000)
      DIMENSION OBT(1)
      DIMENSION NDUMST(1),DUMSTA(2),DUMMRD(2)
      DIMENSION UCHAR7(7)
      REAL LABEL
      INCLUDE 'common/ionum'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/calb/src/pproc_shared/RCS/lread.f,v $
     . $',                                                             '
     .$Id: lread.f,v 1.2 1998/04/07 19:31:11 page Exp $
     . $' /
C    ===================================================================
C
      DATA FLABEL/4H@F  /
      DATA DUMSTA/4HDUMM,4HY   /
C
      LABEL=FLABEL
      NCHAR=2
10    CALL UFIELD(NFLD,ISTRT,LENGTH,ITYPEU,NREP,INTEGR,UREAL,
     * NCHAR,UCHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      CALL AFTERU(LATSGN,ITYPEU,UCHAR,LABEL,3,ISTAT,LENGTH,IERR)
      IF (ISTAT.EQ.7) GO TO 10
      NCHAR=7
      CALL UFIELD(NFLD,ISTRT,LENGTH,ITYPEU,NREP,INTEGR,UREAL,
     * NCHAR,UCHAR7,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      CALL AFTERU(LATSGN,ITYPEU,UCHAR7(1),LABEL,2,ISTAT,LENGTH,IERR)
      IF (ISTAT.EQ.6) ISTRT=-1
      IF (ISTAT.EQ.6) GO TO 50
      DO 20 I=1,7
      STAID(I,J)=UCHAR7(I)
20    CONTINUE
      CALL MTSTLT(SLAT(J),NFLD,ISTRT,IERR)
      CALL MTSTLN(SLON(J),NFLD,ISTRT,IERR)
      NCHAR=1
C
      CALL UFIELD(NFLD,ISTRT,LENGTH,ITYPEU,NREP,INTEGR,OBT(J),
     * NCHAR,UCHAR,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      CALL AFTERU(LATSGN,ITYPEU,UCHAR,LABEL,1,ISTAT,LENGTH,IERR)
      IF(JJ2.GE.1) TIMEOB(JJ2,1)=OBT(J)
      IF(OBT(J).LT.0.0.OR.OBT(J).GT.24.0) GO TO 30
      IF(ISTAT.EQ.6.OR.LENGTH.EQ.0) GO TO 30
      GO TO 40
C
30    CONTINUE
      IERR=1
      WRITE(IPR,60)
40    CONTINUE
      IF (ISTAT.EQ.6) ISTRT=-1
      IF (ISTAT.EQ.6) GO TO 50
C
      NDUMST(J)=0
      NCHAR=2
      CALL UFIELD(NFLD,ISTRT,LENGTH,ITYPEU,NREP,INTEGR,UREAL,
     * NCHAR,DUMMRD,LLPAR,LRPAR,LASK,LATSGN,LAMPS,LEQUAL,ISTAT)
      CALL AFTERU(LATSGN,ITYPEU,UCHAR,LABEL,2,ISTAT,   LENGTH,IERR)
      IF (ISTAT.EQ.6) ISTRT=-1
      IF((DUMMRD(1).EQ.DUMSTA(1)).AND.(DUMMRD(2).EQ.DUMSTA(2)))
     *    NDUMST(J)=1
C
50    CONTINUE
      RETURN
60    FORMAT(/,3X,'*** INPUT OBSERVATION TIME ERROR ***')
      END
