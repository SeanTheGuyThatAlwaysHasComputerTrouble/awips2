C MODULE SPUGNL
C-----------------------------------------------------------------------
C
C  ROUTINE TO PRINT USER GENERAL PARAMETERS.
C
      SUBROUTINE SPUGNL (UNITS,IVUGNL,UGNLID,ISEASN,MDRSUB,ULLMTS,
     *   ELLMTS,NBLEND,ICUGNL,DPOWER,DPCNMN,STMNWT,SORTBY,NHPSUB,
     *   UNUSED,ISTAT)

C
      CHARACTER*4 UNITS,UCODE
      CHARACTER*12 STMAP,STMAT
C
      REAL XREAL(2)
C
      DIMENSION UGNLID(2),ISEASN(2),MDRSUB(4),ULLMTS(4),ELLMTS(2)
      DIMENSION NBLEND(2),ICUGNL(2),DPOWER(3),NHPSUB(4)
      DIMENSION UNUSED(1)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'hclcommon/hdflts'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/shared_s/RCS/spugnl.f,v $
     . $',                                                             '
     .$Id: spugnl.f,v 1.3 1998/04/07 11:48:20 page Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,40)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('UGNL')
C
      ISTAT=0
C
      IUNDEF=-997
C
C  CHECK NUMBER OF LINES LEFT ON PAGE
      IF (ISLEFT(5).GT.0) CALL SUPAGE
C
C  PRINT HEADING
      WRITE (LP,50)
      CALL SULINE (LP,2)
      WRITE (LP,60)
      CALL SULINE (LP,2)
      WRITE (LP,70)
      CALL SULINE (LP,2)
C
C  PRINT PARAMETER ARRAY VERSION NUMBER
      IF (LDEBUG.GT.0) THEN
         WRITE (LP,80) IVUGNL
         CALL SULINE (LP,2)
         ENDIF
C
C  PRINT USER NAME
      WRITE (LP,90) UGNLID
      CALL SULINE (LP,2)
C
C  CHECK IF USER NAME IN PARAMETER ARRAY IS SAME AS USER NAME IN
C  USERPARM FILE
      CALL SUDOPN (1,'UPRM',IERR)
      IF (IERR.GT.0) GO TO 30
      CALL SUBSTR (HNAMRF,1,8,XREAL,1)
      IF (UGNLID(1).EQ.XREAL(1).AND.UGNLID(2).EQ.XREAL(2)) THEN
         ELSE
            WRITE (LP,100) UGNLID,HNAMRF
            CALL SULINE (LP,2)
         ENDIF
C
C  PRINT LATITUDE AND LONGITUDE LIMITS
      WRITE (LP,110) ULLMTS
      CALL SULINE (LP,3)
C
C  PRINT MAXIMUM AND MINIMUM ELEVATION LIMITS
      IF (UNITS.NE.'ENGL') THEN
         UCODE='M'
         VAL1=ELLMTS(1)
         VAL2=ELLMTS(2)
         ELSE
            UCODE='FT'
            CALL UDUCNV ('M   ','FT  ',1,1,ELLMTS(1),VAL1,IERR)
            CALL UDUCNV ('M   ','FT  ',1,1,ELLMTS(2),VAL2,IERR)
         ENDIF
      WRITE (LP,120) VAL1,UCODE,VAL2,UCODE
      CALL SULINE (LP,2)
C
C  PRINT MDR GRID SUBSET
      IF (MDRSUB(1).EQ.IUNDEF) THEN
         WRITE (LP,130)
         CALL SULINE (LP,2)
         ELSE
            WRITE (LP,140) MDRSUB(1),MDRSUB(3),MDRSUB(2),MDRSUB(4)
            CALL SULINE (LP,3)
         ENDIF
C
C  PRINT DEFAULT POWER IN 1/D**POWER FOR MAP, MAT AND MAPE
      WRITE (LP,150) DPOWER
      CALL SULINE (LP,2)
C
C  PRINT BEGINNING MONTH OF SUMMER AND WINTER
      WRITE (LP,160) ISEASN
      CALL SULINE (LP,2)
C
C  PRINT MAT AND MAPE BLEND PERIODS
      WRITE (LP,170) NBLEND
      CALL SULINE (LP,2)
C
C  PRINT MINIMUM DAILY PCPN AT LESS THAN 24 HOUR STATIONS FOR ESTIMATING
C  TIME DISTRIBUTION
      UCODE='IN'
      VAL=DPCNMN
      IF (UNITS.NE.'ENGL') THEN
         UCODE='MM'
         CALL UDUCNV ('IN  ','MM  ',1,1,DPCNMN,VAL,IERR)
         ENDIF
      WRITE (LP,180) VAL,UCODE
      CALL SULINE (LP,2)
C
C  PRINT MINUMUM WEIGHT OF STATIONS TO BE KEPT FOR STATION WEIGHTING
      WRITE (LP,190) STMNWT
      CALL SULINE (LP,2)
C
C  PRINT HOW STATION INFORMATION IS TO BE ORDERED
      WRITE (LP,200) SORTBY
      CALL SULINE (LP,2)
C
C  PRINT MAP AND MAT COMPLETE INDICATORS
      STMAP='?'
      STMAT='?'
      IF (ICUGNL(1).EQ.0) STMAP='COMPLETE'
      IF (ICUGNL(1).EQ.1) STMAP='INCOMPLETE'
      IF (ICUGNL(1).EQ.2) STMAP='INCOMPLETE'
      IF (ICUGNL(2).EQ.0) STMAT='COMPLETE'
      IF (ICUGNL(2).EQ.1) STMAT='INCOMPLETE'
      WRITE (LP,210) STMAP,STMAT
      CALL SULINE (LP,2)
C
      IF (IVUGNL.LT.2) GO TO 10
C
C  PRINT HRAP GRID SUBSET
      IF (NHPSUB(1).EQ.IUNDEF) THEN
         WRITE (LP,220)
         CALL SULINE (LP,2)
         ELSE
            WRITE (LP,230) NHPSUB(1),NHPSUB(3),NHPSUB(2),NHPSUB(4)
            CALL SULINE (LP,3)
         ENDIF
C
10    WRITE (LP,50)
      CALL SULINE (LP,2)
C
30    IF (ISTRCE.GT.0) THEN
         WRITE (IOSDBG,250)
         CALL SULINE (IOSDBG,1)
         ENDIF
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
40    FORMAT (' *** ENTER SPUGNL')
50    FORMAT ('0',132('-'))
60    FORMAT ('0*--> UGNL PARAMETERS ',
     *   '(USER GENERAL)')
70    FORMAT (' ')
80    FORMAT ('0PARAMETER ARRAY VERSION NUMBER = ',I2)
90    FORMAT ('0USER NAME = ',2A4)
100   FORMAT ('0NOTE : USER NAME IN PARAMETRIC DATA BASE (',2A4,
     *   ') IS DIFFERENT FROM USER NAME IN USERPARM FILE (',2A4,').')
110   FORMAT ('0'
     *       'LATITUDE/LONGITUDE LIMITS :  ',
     *       'NORTHERN LATITUDE=',F7.2,5X,
     *       'SOUTHERN LATITUDE=',F7.2 /
     *   T31,'EASTERN LONGITUDE=',F7.2,5X,
     *       'WESTERN LONGITUDE=',F7.2)
120   FORMAT ('0',
     *   'MAXIMUM ELEVATION LIMIT = ',F8.1,2X,A4,5X,
     *   'MINIMUM ELEVATION LIMIT = ',F8.1,2X,A4)
130   FORMAT ('0MDR SUBSET :  NOT DEFINED')
140   FORMAT ('0MDR SUBSET :  ',
     *       'WESTERN COLUMN    = ',I3,5X,'SOUTHERN ROW   = ',I3 /
     *   T16,'NUMBER OF COLUMNS = ',I3,5X,'NUMBER OF ROWS = ',I3)
150   FORMAT ('0D**POWER DEFAULTS :  ',
     *   'MAP=',F5.2,3X,
     *   'MAT=',F5.2,3X,
     *   'MAPE=',F5.2)
160   FORMAT ('0',
     *   'BEGINNING MONTH OF SUMMER = ',I2,5X,
     *   'BEGINNING MONTH OF WINTER = ',I2)
170   FORMAT ('0',
     *   'MAT  BLEND PERIOD = ',I2,2X,'DAYS',5X,
     *   'MAPE BLEND PERIOD = ',I2,2X,'DAYS')
180   FORMAT ('0MINIMUM DAILY PCPN AT LESS THAN 24 HOUR STATIONS (FOR ',
     *   'ESTIMATING TIME DISTRIBUTION) = ',F7.2,2X,A4)
190   FORMAT ('0MINIMUM WEIGHT OF STATIONS TO BE KEPT FOR STATION ',
     *   'WEIGHTING = ',F5.2)
200   FORMAT ('0NETWORK ALPHABETICAL ORDER LISTS WILL BE SORTED BY : ',
     *   A4)
210   FORMAT ('0',
     *   'MAP COMPLETE INDICATOR = ',A,5X,
     *   'MAT COMPLETE INDICATOR = ',A)
220   FORMAT ('0HRAP SUBSET :  NOT DEFINED')
230   FORMAT ('0HRAP SUBSET :  ',
     *       'WESTERN COLUMN    = ',I4,5X,'SOUTHERN ROW   = ',I4 /
     *   T17,'NUMBER OF COLUMNS = ',I4,5X,'NUMBER OF ROWS = ',I4)
250   FORMAT (' *** EXIT SPUGNL')
C
      END
