C MEMBER SRMPFO
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 01/11/94.13:03:39 BY $WC20SV
C
C @PROCESS LVL(77)
C
C DESC READ FORECAST GROUP MAP COMPUTATIONAL ORDER
C
      SUBROUTINE SRMPFO (XNAME,IPTR,LARRAY,ARRAY,IVMPFO,FGID,UNUSED,
     *   MRMPID,RMPID,NRMPID,MMAPSR,MAPSR,NMAPSR,IPRERR,IPTRNX,ISTAT)
C
      DIMENSION ARRAY(LARRAY)
      DIMENSION XNAME(2),UNUSED(2),FGID(2)
      DIMENSION RMPID(2,1),MAPSR(1)
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/shared_s/RCS/srmpfo.f,v $
     . $',                                                             '
     .$Id: srmpfo.f,v 1.1 1995/09/17 19:21:04 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,90)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  SET DEBUG LEVEL
      LDEBUG=ISBUG('MPFO')
C
      IF (LDEBUG.GT.0) WRITE (IOSDBG,100) XNAME,IPTR,LARRAY,MRMPID
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,1)
C
      ISTAT=0
C
C  READ PARAMETER ARRAY
      CALL SUDOPN (1,'PPP ',IERR)
      CALL RPPREC (XNAME,'MPFO',IPTR,LARRAY,ARRAY,NFILL,IPTRNX,IERR)
      IF (IERR.EQ.0) GO TO 10
         ISTAT=IERR
         IF (IPRERR.EQ.0) GO TO 80
            CALL SRPPST (XNAME,'MPFO',IPTR,LARRAY,NFILL,IPTRNX,IERR)
            IF (LDEBUG.GT.0) WRITE (IOSDBG,110) XNAME
            IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,2)
            GO TO 80
C
10    IF (LDEBUG.GT.0) WRITE (IOSDBG,180) XNAME,IPTR,IPTRNX
      IF (LDEBUG.GT.0) CALL SULINE (IOSDBG,2)
C
C  SET PARAMETER ARRAY VERSION NUMBER
      IVMPFO=ARRAY(1)
C
C  SET FORECAST GROUP IDENTIFIER
      FGID(1)=ARRAY(2)
      FGID(2)=ARRAY(3)
C
C  CHECK IDENTIFIERS
      IF (XNAME(1).EQ.FGID(1).AND.XNAME(2).EQ.FGID(2)) GO TO 20
         WRITE (LP,120) XNAME,FGID
         CALL SUERRS (LP,2,-1)
         WRITE (LP,130) IPTR
         CALL SULINE (LP,1)
         ISTAT=2
         GO TO 80
C
C  POSITIONS 4 AND 5 ARE UNUSED
20    UNUSED(1)=ARRAY(4)
      UNUSED(2)=ARRAY(5)
C
C  SET NUMBER OF MAP AREAS IN FORECAST GROUP
      NRMPID=ARRAY(6)
C
      NPOS=6
C
      IF (NRMPID.EQ.0) GO TO 70
C
C  CHECK FOR SUFFIFIENT SPACE FOR MAP IDENTIFIERS
      IF (NRMPID.LE.MRMPID) GO TO 30
         WRITE (LP,140) NRMPID,FGID
         CALL SUERRS (LP,2,-1)
         WRITE (LP,145) MRMPID
         CALL SULINE (LP,1)
         ISTAT=3
         GO TO 80
C
C  SET MAP AREA IDENTIFIERS
30    DO 40 I=1,NRMPID
         NPOS=NPOS+1
         RMPID(1,I)=ARRAY(NPOS)
         NPOS=NPOS+1
         RMPID(2,I)=ARRAY(NPOS)
40       CONTINUE
C
      NMAPSR=NRMPID
C
C  CHECK FOR SUFFICIENT SPACE FOR MAP AREA STATION POINTERS
      IF (NMAPSR.LE.MMAPSR) GO TO 50
         WRITE (LP,150) NMAPSR,FGID,MMAPSR
         CALL SUERRS (LP,2,-1)
         WRITE (LP,155)
         CALL SULINE (LP,3)
         ISTAT=3
         GO TO 80
C
C  SET RECORD NUMBER OF MAP STATION PARAMETES FOR EACH MAP AREA
50    DO 60 I=1,NRMPID
         NPOS=NPOS+1
         MAPSR(I)=ARRAY(NPOS)
60       CONTINUE
C
70    IF (LDEBUG.EQ.0) GO TO 80
         WRITE (IOSDBG,190) NPOS,NFILL,IPTRNX,IVMPFO,FGID,NRMPID
         CALL SULINE (IOSDBG,1)
         CALL SUPDMP ('MPFO','REAL',0,NPOS,ARRAY,ARRAY)
C
80    IF (ISTRCE.GT.0) WRITE (IOSDBG,200)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
90    FORMAT (' *** ENTER SRMPFO')
100   FORMAT (' XNAME=',2A4,3X,'IPTR=',I5,3X,'LARRAY=',I5,3X,
     *   'MRMPID=',I5)
110   FORMAT ('0*** NOTE - CARRYOVER GROUP COMPUTATIONAL ORDER ',
     *   'PARAMETERS NOT SUCCESSFULLY READ FOR ',2A4)
120   FORMAT ('0*** ERROR - IN SRMPFO - FORECAST GROUP NAME PASSED (',
     *   2A4,') DOES NOT MATCH NAME IN PARAMETER RECORD (',2A4,').')
130   FORMAT (15X,'MPFO PARAMETER RECORD POINTER NUMBER=',I5)
140   FORMAT ('0*** ERROR - IN SRMPFO - ',I5,' MAP AREAS ',
     *   'IDENTIFIERS IN FORECAST GROUP ',2A4)
145   FORMAT (T15,'MAXIMUM NUMBER ALLOWED IN MAP ID WORK SPACE IS ',
     *   I5,'.')
150   FORMAT ('0*** ERROR - IN SRMPFO - ',I5,' MAP AREAS ',
     *   'IDENTIFIERS IN FORECAST GROUP ',2A4,'.')
155   FORMAT (T15,'MAXIMUM ALLOWED IN MAP STATION RECORD WORK SPACE ',
     *   'IS ',I5,'.')
180   FORMAT ('0*** NOTE - FORECAST GROUP COMPUTATIONAL ORDER ',
     *   'PARAMETERS SUCCESSFULLY READ FOR ',2A4,'. IPTR=',I5,3X,
     *   'IPTRNX=',I5)
190   FORMAT (' NPOS=',I5,3X,'NFILL=',I5,3X,'IPTRNX=',I5,3X,
     *     'IVMPFO=',I3,3X,'FGID=',2A4,3X,'NRMPID=',I5)
200   FORMAT (' *** EXIT SRMPFO')
C
      END
