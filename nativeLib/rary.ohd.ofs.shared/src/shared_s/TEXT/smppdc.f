C MEMBER SMPPDC
C-----------------------------------------------------------------------
C
C                             LAST UPDATE: 06/23/94.15:00:43 BY $WC20SV
C
C @PROCESS LVL(77)
C
      SUBROUTINE SMPPDC (ISTAT)
C
C  THIS ROUTINE PRINTS THE PREPROCESSOR DATA BASE CONTROL AND
C  DATA TYPE DIRECTORY INFORMATION
C
      INCLUDE 'uio'
      INCLUDE 'scommon/sudbgx'
      INCLUDE 'pdbcommon/pdddfc'
      INCLUDE 'pdbcommon/pddtdr'
      INCLUDE 'pdbcommon/pdrrsc'
      INCLUDE 'pdbcommon/pdsifc'
      INCLUDE 'pdbcommon/pdunts'
C
C    ================================= RCS keyword statements ==========
      CHARACTER*68     RCSKW1,RCSKW2
      DATA             RCSKW1,RCSKW2 /                                 '
     .$Source: /fs/hseb/ob72/rfc/ofs/src/shared_s/RCS/smppdc.f,v $
     . $',                                                             '
     .$Id: smppdc.f,v 1.1 1995/09/17 19:20:31 dws Exp $
     . $' /
C    ===================================================================
C
C
C
      ISTAT=0
C
      IF (ISTRCE.GT.0) WRITE (IOSDBG,110)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
C  OPEN PREPROCESSOR DATA BASE
      CALL SUDOPN (1,'PPD ',IERR)
      IF (IERR.GT.0) GO TO 100
C
      IF (ISLEFT(10).GT.0) CALL SUPAGE
C
C  PRINT INDEX FILE CONTROL RECORDS
      IF (ISLEFT(10).GT.0) CALL SUPAGE
      WRITE (LP,130)
      CALL SULINE (LP,2)
      WRITE (LP,120)
      CALL SULINE (LP,1)
      WRITE (LP,140) NWDCTL
      CALL SULINE (LP,1)
      WRITE (LP,150) LRCPDD
      CALL SULINE (LP,1)
      WRITE (LP,160) LRCPDR
      CALL SULINE (LP,1)
      WRITE (LP,170) LRCPDI
      CALL SULINE (LP,1)
      WRITE (LP,180) MXDTYP
      CALL SULINE (LP,1)
      WRITE (LP,190) NMDTYP
      CALL SULINE (LP,1)
      WRITE (LP,200) IPTTYP
      CALL SULINE (LP,1)
      WRITE (LP,210) NHASHR
      CALL SULINE (LP,1)
      WRITE (LP,220) IH8CHR
      CALL SULINE (LP,1)
      WRITE (LP,230) IHINRC
      CALL SULINE (LP,1)
      WRITE (LP,240) INFREC
      CALL SULINE (LP,1)
      WRITE (LP,250) MXSIFR
      CALL SULINE (LP,1)
      WRITE (LP,260) LSTSIF
      CALL SULINE (LP,1)
      WRITE (LP,270) MXDDOD
      CALL SULINE (LP,1)
      WRITE (LP,280) MAXDDF
      CALL SULINE (LP,1)
      WRITE (LP,290) NUMDDF
      CALL SULINE (LP,1)
C
      IF (ISLEFT(10).GT.0) CALL SUPAGE
      WRITE (LP,300)
      CALL SULINE (LP,5)
C
C  PRINT DAILY DATA CONTROL RECORDS
      DO 10 I=1,NUMDDF
         WRITE (LP,310) KPDDDF(I),(IPDDFC(J,I),J=1,2)
         CALL SULINE (LP,1)
         IF (ISNWPG(LP).EQ.1) WRITE (LP,300)
         IF (ISNWPG(LP).EQ.1) CALL SULINE (LP,5)
10       CONTINUE
C
C  PRINT DAILY DATA TYPE RECORDS REPORT HEADER
      IF (ISLEFT(10).GT.0) CALL SUPAGE
      WRITE (LP,320)
      CALL SULINE (LP,2)
      WRITE (LP,330)
      CALL SULINE (LP,2)
      WRITE (LP,340)
      CALL SULINE (LP,1)
C
C  PRINT DAILY DATA TYPE RECORDS
      MCOUNT=5
      NCOUNT=0
      DO 50 I=1,NMDTYP
         CALL UMEMOV (IDDTDR(8,I),IEDATE,1)
         CALL UMEMOV (IDDTDR(11,I),ILDATE,1)
         INOTE=1
         IF (IDDTDR(4,I).EQ.-4) INOTE=2
         IF (IDDTDR(4,I).EQ.-6) INOTE=3
         IF (IDDTDR(4,I).EQ.-2) INOTE=4
         IF (IDDTDR(4,I).EQ.-3) INOTE=4
         IF (IDDTDR(4,I).EQ.-7) INOTE=5
         IF (NCOUNT.LT.MCOUNT) GO TO 30
            IF (ISLEFT(2).EQ.0) GO TO 20
               CALL SUPAGE
               NCOUNT=0
               GO TO 30
20          WRITE (LP,120)
            CALL SULINE (LP,1)
            NCOUNT=0
30       IF (ISNWPG(LP).EQ.0) GO TO 40
            WRITE (LP,330)
            CALL SULINE (LP,3)
            WRITE (LP,340)
            CALL SULINE (LP,1)
            NCOUNT=0
40       WRITE (LP,350) I,(IDDTDR(J,I),J=2,5),INOTE,
     *      (IDDTDR(J,I),J=6,7),
     *      IEDATE,IDDTDR(10,I),
     *      ILDATE,IDDTDR(13,I)
         CALL SULINE (LP,1)
         NCOUNT=NCOUNT+1
50       CONTINUE
      WRITE (LP,340)
      CALL SULINE (LP,1)
      WRITE (LP,360)
      CALL SULINE (LP,1)
C
      IF (ISLEFT(10).GT.0) CALL SUPAGE
      WRITE (LP,370)
      CALL SULINE (LP,3)
      WRITE (LP,380)
      CALL SULINE (LP,1)
      MCOUNT=5
      NCOUNT=0
      DO 90 I=1,NMDTYP
         IF (NCOUNT.LT.MCOUNT) GO TO 70
            IF (ISLEFT(2).EQ.0) GO TO 60
               CALL SUPAGE
               NCOUNT=0
               GO TO 70
60          WRITE (LP,120)
            CALL SULINE (LP,1)
            NCOUNT=0
70       IF (ISNWPG(LP).EQ.0) GO TO 80
            WRITE (LP,370)
            CALL SULINE (LP,3)
            WRITE (LP,380)
            CALL SULINE (LP,1)
            NCOUNT=0
80       WRITE (LP,390) I,(IDDTDR(J,I),J=2,3),(IDDTDR(J,I),J=14,21)
         CALL SULINE (LP,1)
         NCOUNT=NCOUNT+1
90       CONTINUE
      WRITE (LP,380)
      CALL SULINE (LP,1)
      WRITE (LP,400)
      CALL SULINE (LP,1)
C
C  PRINT NOTES
      WRITE (LP,410)
      CALL SULINE (LP,2)
      WRITE (LP,120)
      CALL SULINE (LP,1)
      WRITE (LP,420)
      CALL SULINE (LP,1)
      WRITE (LP,430)
      CALL SULINE (LP,1)
      WRITE (LP,440)
      CALL SULINE (LP,1)
      WRITE (LP,450)
      CALL SULINE (LP,1)
      WRITE (LP,460)
      CALL SULINE (LP,1)
C
C  WRITE RRS FILE CONTROL RECORD
      IF (ISLEFT(10).GT.0) CALL SUPAGE
      WRITE (LP,470)
      CALL SULINE (LP,2)
      WRITE (LP,120)
      CALL SULINE (LP,1)
      WRITE (LP,480) MXRRSF
      CALL SULINE (LP,1)
      WRITE (LP,490) LXRRSR
      CALL SULINE (LP,1)
      WRITE (LP,500) IFREE1
      CALL SULINE (LP,1)
      WRITE (LP,510) IFREEN
      CALL SULINE (LP,1)
      WRITE (LP,520) IFREEL
      CALL SULINE (LP,1)
      WRITE (LP,530) LUFREE
      CALL SULINE (LP,1)
      WRITE (LP,540) MXFRER
      CALL SULINE (LP,1)
      WRITE (LP,550) MAXRSZ
      CALL SULINE (LP,1)
      WRITE (LP,560) NPDSTA
      CALL SULINE (LP,1)
      WRITE (LP,570) INUSEF
      CALL SULINE (LP,1)
      WRITE (LP,580) IPUSER
      CALL SULINE (LP,1)
C
100   IF (ISTRCE.GT.0) WRITE (IOSDBG,590)
      IF (ISTRCE.GT.0) CALL SULINE (IOSDBG,1)
C
      RETURN
C
C- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
C
110   FORMAT (' *** ENTER SMPPDC')
120   FORMAT (' ')
130   FORMAT ('0- PREPROCESSOR DATA BASE INDEX FILE CONTROL ',
     *   'RECORDS -')
140   FORMAT (3X,'NUMBER OF WORDS IN CONTROL RECORD = ',I2)
150   FORMAT (3X,'LOGICAL RECORD LENGTH OF DAILY DATA FILES = ',I3)
160   FORMAT (3X,'LOGICAL RECORD LENGTH OF RRS DATA FILE = ',I3)
170   FORMAT (3X,'LOGICAL RECORD LENGTH OF INDEX FILE = ',I3)
180   FORMAT (3X,'MAXIMUM NUMBER OF DAILY DATA TYPES = ',I3)
190   FORMAT (3X,'ACTUAL  NUMBER OF DAILY DATA TYPES = ',I3)
200   FORMAT (3X,'RECORD NUMBER OF FIRST DATA TYPE DIRECTORY RECORD = ',
     *   I5)
210   FORMAT (3X,'NUMBER OF I*2 WORDS IN HASH RECORDS = ',I5)
220   FORMAT (3X,'RECORD NUMBER OF FIRST CHARACTER HASH RECORD = ',
     *   I5)
230   FORMAT (3X,'RECORD NUMBER OF FIRST INTEGER   HASH RECORD = ',
     *   I5)
240   FORMAT (3X,'RECORD NUMBER OF FIRST STATION INFORMATION RECORD = ',
     *   I5)
250   FORMAT (3X,'MAXIMUM RECORDS IN FILE = ',I5)
260   FORMAT (3X,'LAST USED RECORD IN FILE = ',I5)
270   FORMAT (3X,'MAXIMUM DAYS BETWEEN LAST DAY OF OBSERVED ',
     *   'DATA AND FIRST DAY OF FUTURE DATA = ',I2)
280   FORMAT (3X,'MAXIMUM NUMBER OF DAILY DATA FILES = ',I3)
290   FORMAT (3X,'ACTUAL  NUMBER OF DAILY DATA FILES = ',I3)
300   FORMAT ('0- PREPROCESSOR DATA BASE DAILY DATA FILE CONTROL ',
     *      'RECORDS -' /
     *   '0',3X,'FILE',3X,'MAX # RECORDS',3X,'LAST RECORD',
     *       ' USED' /
     *   ' ',3X,4('-'),3X,13('-'),3X,16('-'))
310   FORMAT (' ',5X,I2,7X,I6,12X,I6)
320   FORMAT ('0- PREPROCESSOR DATA BASE DAILY DATA TYPE DIRECTORY ',
     *   'RECORDS -')
330   FORMAT ('0',3X,'DATA TYPE',3X,'FILE',3X,'(SEE NOTES)  ',
     *   3X,'# OF VALUES',3X,'MAXDAYS',3X,'EARLIEST JDATE',
     *   3X,'REC # OF EDATA',3X,'LATEST JDATE',3X,'REC # OF LDATA')
340   FORMAT (' ',3X,9('-'),3X,4('-'),3X,13('-'),3X,11('-'),3X,
     *   7('-'),3X,14('-'),3X,14('-'),3X,12('-'),3X,14('-'))
350   FORMAT (1X,I2,3X,2A2,7X,I2,4X,
     *   I2,2X,'(NOTE ',I1,')',8X,
     *   I2,6X,I6,7X,I8,9X,I6,
     *   11X,I8,10X,I6)
360   FORMAT (' WORD',1X,' 2-3',7X,' 4',9X,' 5',13X,' 6',
     *   6X,5(' '),'7',7X,5(' '),'8-9',9X,4(' '),'10',
     *   11X,3(' '),'11-12',10X,4(' '),'13')
370   FORMAT ('0',68X,'LST USED',5X,'LST USED' /
     *   ' ',3X,'DATA TYPE',3X,
     *       'REC # OF PNTREC',3X,'# FRST DATAREC',3X,'MAXSTA',3X,
     *       'NUMSTA',3X,'WRD PNTREC',3X,
     *       'WRD DATAREC',3X,'# STATS STA-TYPE',3X,'# REC 1DAY')
380   FORMAT (' ',3X,9('-'),3X,15('-'),3X,14('-'),3X,6('-'),3X,
     *   6('-'),3X,10('-'),3X,11('-'),3X,16('-'),3X,10('-'))
390   FORMAT (1X,I2,3X,2A2,10X,I6,14X,I6,5X,I6,3X,I6,6X,I6,8X,I6,
     *   8X,I6,12X,I6)
400   FORMAT (' WORD',1X,' 2-3',10X,4(' '),'14',
     *   14X,4(' '),'15',5X,4(' '),'16',3X,4(' '),'17',
     *   6X,4(' '),'18',8X,4(' '),'19',8X,4(' '),'20',
     *   12X,4(' '),'21')
410   FORMAT ('0NOTE: ''WORD'' IS THE WORD POSITION OF THE ',
     *   'VARIABLE IN ARRAY IDDTDR IN COMMON BLOCK PDDTDR.')
420   FORMAT (' NOTE 1: VALUE IS NUMBER OF POINTERS FOR DATA TYPE.')
430   FORMAT (' NOTE 2: VALUE IS INDICATOR FOR WRITE DATA TYPES ',
     *   'IN READ DATA TYPE TM24.')
440   FORMAT (' NOTE 3: VALUE IS INDICATOR FOR WRITE DATA TYPES ',
     *   'IN READ DATA TYPE TF24.')
450   FORMAT (' NOTE 4: VALUE IS DATA TIME INTERVAL FOR WRITE ONLY ',
     *   'DATA TYPE.')
460   FORMAT (' NOTE 5: VALUE IS INDICATOR FOR WRITE DATA TYPES ',
     *   'IN READ DATA TYPE EA24.')
470   FORMAT ('0- PREPROCESSOR DATA BASE RRS FILE CONTROL RECORD -')
480   FORMAT (3X,'MAXIMUM RECORDS IN FILE FOR PRIMARY DATA = ',I5)
490   FORMAT (3X,'NEXT AVAILABLE RECORDS FOR PRIMARY DATA = ',I5)
500   FORMAT (3X,'FIRST RECORDS OF FREEPOOL DATA = ',I5)
510   FORMAT (3X,'NEXT AVAILABLE FREEPOOL DATA RECORDS = ',I5)
520   FORMAT (3X,'NUMBER OF WORDS IN A FREEPOOL DATA RECORD = ',I3)
530   FORMAT (3X,'NUMBER OF DAILY DATA FILE IN WHICH FREEPOOL RECORDS ',
     *   'STORED = ',I2)
540   FORMAT (3X,'MAXIMUM NUMBER OF FREEPOOL RECORDS = ',I5)
550   FORMAT (3X,'LENGTH OF LONGEST OBSERVATION PERIOD = ',I3)
560   FORMAT (3X,'NUMBER OF DAILY AND RRS STATION DEFINED = ',I4)
570   FORMAT (3X,'FILE IN-USE INDICATOR = ',I2)
580   FORMAT (3X,'USER NAME = ',2A4)
590   FORMAT (' *** EXIT SMPPDC')
C
      END
